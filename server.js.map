{"version":3,"sources":["webpack:///webpack/bootstrap 714c41ba9df2becb7f3b","webpack:///external \"babel-runtime/helpers/classCallCheck\"","webpack:///external \"picolog\"","webpack:///external \"babel-runtime/core-js/object/get-prototype-of\"","webpack:///external \"babel-runtime/helpers/inherits\"","webpack:///external \"babel-runtime/helpers/possibleConstructorReturn\"","webpack:///external \"babel-runtime/helpers/createClass\"","webpack:///external \"babel-runtime/helpers/extends\"","webpack:///./src/components/Entity/Entity.jsx","webpack:///external \"react\"","webpack:///external \"ws.suid\"","webpack:///external \"react-mdl\"","webpack:///./src/components/Mdl/mdl-extras.jsx","webpack:///external \"redux-apis\"","webpack:///external \"babel-runtime/core-js/object/define-properties\"","webpack:///external \"babel-runtime/core-js/promise\"","webpack:///external \"babel-runtime/helpers/typeof\"","webpack:///external \"classnames\"","webpack:///external \"redux-fetch-api\"","webpack:///./src/components/App/api.jsx","webpack:///./src/components/Auth/Role.jsx","webpack:///external \"babel-runtime/helpers/objectWithoutProperties\"","webpack:///./src/store.jsx","webpack:///external \"react-redux\"","webpack:///external \"babel-runtime/core-js/object/keys\"","webpack:///external \"fbjs/lib/shallowEqual\"","webpack:///external \"react-router\"","webpack:///external \"redux-load-api\"","webpack:///./src/components/Auth/api.jsx","webpack:///./src/components/Entity/FilterPanel.jsx","webpack:///./src/components/Mdl/api.jsx","webpack:///./src/components/Publication/Publication.jsx","webpack:///./src/components/Publication/api.jsx","webpack:///./src/components/Scroller/Scroller.jsx","webpack:///./src/components/App/App.jsx","webpack:///./src/components/Auth/Account.jsx","webpack:///./src/components/Auth/Group.jsx","webpack:///./src/components/Auth/PasswordCredential.jsx","webpack:///./src/components/Brands/Brand.jsx","webpack:///./src/components/Products/Product.jsx","webpack:///./src/components/Products/Rating.jsx","webpack:///./src/components/Products/StockItem.jsx","webpack:///./src/components/Stores/Store.jsx","webpack:///./src/markup.jsx","webpack:///external \"babel-runtime/core-js/json/stringify\"","webpack:///external \"babel-runtime/helpers/defineProperty\"","webpack:///external \"babel-runtime/helpers/toConsumableArray\"","webpack:///external \"react-dom\"","webpack:///external \"redux-async-api\"","webpack:///./config.js","webpack:///./src/components/Auth/AuthDialog.jsx","webpack:///./src/components/Auth/Credential.jsx","webpack:///./src/components/Auth/SessionPanel.jsx","webpack:///./src/components/Brands/BrandBrowser.jsx","webpack:///./src/components/Brands/BrandCard.jsx","webpack:///./src/components/Brands/api.jsx","webpack:///./src/components/Entity/FilterFields.jsx","webpack:///./src/components/Entity/api.jsx","webpack:///./src/components/Home/Home.jsx","webpack:///./src/components/Products/ProductBrowser.jsx","webpack:///./src/components/Products/ProductCard.jsx","webpack:///./src/components/Products/api.jsx","webpack:///./src/components/Stores/StoreBrowser.jsx","webpack:///./src/components/Stores/StoreCard.jsx","webpack:///./src/components/Stores/api.jsx","webpack:///./src/routes.jsx","webpack:///./src/scripts.jsx","webpack:///./src/server.jsx","webpack:///./package.json","webpack:///external \"babel-polyfill\"","webpack:///external \"babel-runtime/core-js/object/create\"","webpack:///external \"babel-runtime/core-js/object/values\"","webpack:///external \"babel-runtime/helpers/get\"","webpack:///external \"chalk\"","webpack:///external \"compression\"","webpack:///external \"cookie-parser\"","webpack:///external \"express\"","webpack:///external \"http\"","webpack:///external \"http-proxy\"","webpack:///external \"node-fetch\"","webpack:///external \"path\"","webpack:///external \"react-dom/server\"","webpack:///external \"redux\"","webpack:///external \"redux-logger\"","webpack:///external \"redux-thunk\"","webpack:///external \"serialize-javascript\""],"names":[],"mappings":"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BAAF,CAAvB,CAAT,CAD6C;GAAV,CAA1C;;;;;;;;;;;;;AAjBe,E;;;;;;ACxLhB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAE;AACF;AACA;AACA;AACA;AACA,GAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAE;AACF;AACA;AACA;AACA,GAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAE;AACF;AACA;AACA;AACA;AACA,GAAE;AACF;AACA;AACA;AACA,G;;;;;;ACpHA,4C;;;;;;ACAA,iE;;;;;;ACAA,iE;;;;;;ACAA,uD;;;;;;ACAA,mC;;;;;;ACAA,yC;;;;;;ACAA,2C;;;;;;ACAA,qC;;;;;;ACAA,kC;;;;;;ACAA,wC;;;;;;ACAA,wC;;;;;;ACAA,kC;;;;;;ACAA,8C;;;;;;ACAA,mC;;;;;;ACAA,0C;;;;;;ACAA,yC;;;;;;ACAA,kD","file":"server.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap 714c41ba9df2becb7f3b\n **/","module.exports = require(\"babel-runtime/helpers/classCallCheck\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"babel-runtime/helpers/classCallCheck\"\n ** module id = 1\n ** module chunks = 0\n **/","module.exports = require(\"picolog\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"picolog\"\n ** module id = 2\n ** module chunks = 0\n **/","module.exports = require(\"babel-runtime/core-js/object/get-prototype-of\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"babel-runtime/core-js/object/get-prototype-of\"\n ** module id = 3\n ** module chunks = 0\n **/","module.exports = require(\"babel-runtime/helpers/inherits\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"babel-runtime/helpers/inherits\"\n ** module id = 4\n ** module chunks = 0\n **/","module.exports = require(\"babel-runtime/helpers/possibleConstructorReturn\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"babel-runtime/helpers/possibleConstructorReturn\"\n ** module id = 5\n ** module chunks = 0\n **/","module.exports = require(\"babel-runtime/helpers/createClass\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"babel-runtime/helpers/createClass\"\n ** module id = 6\n ** module chunks = 0\n **/","module.exports = require(\"babel-runtime/helpers/extends\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"babel-runtime/helpers/extends\"\n ** module id = 7\n ** module chunks = 0\n **/","import log from 'picolog';\r\nimport Suid from 'ws.suid';\r\n\r\nexport function Entity(target) {\r\n\treturn register(target.name, target);\r\n}\r\nexport default Entity;\r\n\r\nexport function\tfromJSON(json) {\r\n\tif (typeof json == 'string') {\r\n\t\tconst result = JSON.parse(json, revive);\r\n\t\tlog.trace('fromJSON => ', result);\r\n\t\treturn result;\r\n\t}\r\n\tlog.debug('fromJSON', json, this);\r\n\tif (this) {\r\n\t\tconst result = Object.create(this.prototype);\r\n\t\tconst keys = Object.keys(json);\r\n\t\tlog.trace('fromJSON: keys=', keys);\r\n\t\tfor (let i=0,key; key=keys[i]; i++) {\r\n\t\t\tresult[key] = json[key];\r\n\t\t}\r\n\t\tlog.trace('fromJSON => ', result);\r\n\t\treturn result;\r\n\t}\r\n\treturn fromJSON(JSON.stringify(json));\r\n}\r\n\r\nexport function toJSON(entity) {\r\n\t// if toJSON is called with an entity object as argument, it returns the JSON for that entity\r\n\tif (typeof entity == 'object') return JSON.stringify(entity);\r\n\t// otherwise, it creates a result object with an extra `type` field and `toJSON` method\r\n\tconst result = { ...this, type:this.constructor.name };\r\n\tObject.defineProperty(result, 'toJSON', {value:toJSON});\r\n\treturn result;\r\n}\r\n\r\nexport function toError(response) {\r\n\treturn (response ? response.text() : Promise.resolve('unknown error')).then(text => {\r\n\t\tconst error = Error(text);\r\n\t\terror.message = text;\r\n\t\terror.status = response && response.status || 500;\r\n\t\terror.statusText = response && response.statusText || text;\r\n\t\terror.toJSON = toJSON;\r\n\t\tthrow error;\r\n\t})\r\n}\r\n\r\nexport function equals(one, other) {\r\n\tif (arguments.length === 1) {return equals(this, one);}\r\n\treturn (\r\n\t\t// comparison of entity with itself\r\n\t\t(one === other) ||\r\n\t\t// comparison of entity with some id\r\n\t\t(one && one.id === other) ||\r\n\t\t(one && hasEquals(one.id) && one.id.equals(other)) ||\r\n\t\t(other && other.id === one) ||\r\n\t\t(other && hasEquals(other.id) && other.id.equals(one)) ||\r\n\t\t// comparison of two entities of same type\r\n\t\t(one && other && one.constructor === other.constructor &&\r\n\t\t\t(\r\n\t\t\t\t(one.id === other.id) ||\r\n\t\t\t\t(hasEquals(one.id) && one.id.equals(other.id)) ||\r\n\t\t\t\t(hasEquals(other.id) && other.id.equals(one.id))\r\n\t\t\t)\r\n\t\t)\r\n\t)\r\n}\r\n\r\nexport function indexOf(list, entity) {\r\n\tfor (let i=0; i<list.length; i++) {\r\n\t\tif (equals(list[i], entity)) {return i;}\r\n\t}\r\n\treturn -1;\r\n}\r\n\r\n/**\r\n * Creates a new object that has all of the properties of `entity`, including it's id.\r\n * A clone is a different instance of *the same* entity. Any sub-entities will also be\r\n * cloned, unless you set `shallow` to `true`.\r\n */\r\nexport function clone(entity, shallow=false) {\r\n\tif (! entity) {entity = this;}\r\n\tconst result = Object.create(entity.constructor.prototype);\r\n\tconst keys = Object.keys(entity);\r\n\tfor (let i=0,key; key=keys[i]; i++) {\r\n\t\tconst val = entity[key];\r\n\t\tresult[key] = val && val.clone && !shallow ? val.clone() : val;\r\n\t}\r\n\treturn result;\r\n}\r\n\r\n/**\r\n * Creates a new object that has all of the properties of `entity`, except for it's id.\r\n * A copy is a new instance of *a new* entity. The copy will not have any id set, allowing\r\n * (requiring) you to set it yourself. By default, sub-entities will not be copied, unless\r\n * you set `recurse` to `true`.\r\n */\r\nexport function copy(entity, recurse=false) {\r\n\tif (! entity) {entity = this;}\r\n\tconst result = Object.create(entity.constructor.prototype);\r\n\tconst keys = Object.keys(entity).filter(val => val !== 'id');\r\n\tfor (let i=0,key; key=keys[i]; i++) {\r\n\t\tconst val = entity[key];\r\n\t\tresult[key] = val && val.copy && recurse ? val.copy() : val;\r\n\t}\r\n\treturn result;\r\n}\r\n\r\nexport function revive(key, value) {\r\n\tlog.trace('revive', key, value);\r\n\tconst t = value && typeof value == 'object' && typeof value.type == 'string' && value.type;\r\n\tconst type = t && registry[t];\r\n\tconst result = type ? type.fromJSON(value) : Suid.revive((k) => idKey(k))(key, value);\r\n\tlog.trace('revive => ', result);\r\n\treturn result;\r\n}\r\n\r\nexport function register(name, type) {\r\n\tfunction enhance(entity, obj) {\r\n\t\tObject.defineProperty(entity, 'id', {enumerable:true,\r\n\t\t\tget:function(){return this.__id;},\r\n\t\t\tset:function(id) {Object.defineProperty(this, '__id', {value:id});},\r\n\t\t});\r\n\t\tObject.defineProperty(entity, 'version', {enumerable:true,\r\n\t\t\tget:function(){return this.__version;},\r\n\t\t\tset:function(version) {Object.defineProperty(this, '__version', {value:version});},\r\n\t\t});\r\n\t\tconst keys = obj && Object.keys(obj) || [];\r\n\t\tfor (let i=0,key; key=keys[i]; i++) {entity[key] = obj[key];}\r\n\t\tif (keys.indexOf('version') === -1) {entity.version = null;}\r\n\t}\r\n\tlet wrapped;\r\n\teval(`\r\n\t\twrapped = function ${name}(obj){\r\n\t\t\tenhance(this, obj);\r\n\t\t\ttype.apply(this, arguments);\r\n\t\t};\r\n\t`);\r\n\twrapped.prototype = Object.create(type.prototype);\r\n\twrapped.toString = type.toString.bind(wrapped);\r\n\tregistry[name] = wrapped;\r\n\tif (! wrapped.prototype.toJSON) {Object.defineProperty(wrapped.prototype, 'toJSON', {value:toJSON});}\r\n\tif (! wrapped.prototype.equals) {Object.defineProperty(wrapped.prototype, 'equals', {value:equals});}\r\n\tif (! wrapped.prototype.clone) {Object.defineProperty(wrapped.prototype, 'clone', {value:clone});}\r\n\tif (! wrapped.fromJSON) {Object.defineProperty(wrapped, 'fromJSON', {value:fromJSON});}\r\n\treturn wrapped;\r\n}\r\n\r\nconst registry = {};\r\n\r\nfunction idKey(key) {\r\n\treturn key === 'id' || key.substring && key.substring(key.length - 2) === 'Id';\r\n}\r\n\r\nfunction hasEquals(obj) {\r\n\treturn obj && typeof obj.equals == 'function';\r\n}\n\n\n/** WEBPACK FOOTER **\n ** ./src/components/Entity/Entity.jsx\n **/","module.exports = require(\"react\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"react\"\n ** module id = 9\n ** module chunks = 0\n **/","module.exports = require(\"ws.suid\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"ws.suid\"\n ** module id = 10\n ** module chunks = 0\n **/","module.exports = require(\"react-mdl\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"react-mdl\"\n ** module id = 11\n ** module chunks = 0\n **/","import log from 'picolog';\r\nimport React, { Component, PropTypes, Children } from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport { Drawer as MdlDrawer, Textfield as MdlTextfield, FABButton, Icon, Card, Spinner } from 'react-mdl';\r\nlog.assert(MdlDrawer, 'MdlDrawer is not defined');\r\nlog.assert(MdlTextfield, 'MdlTextfield is not defined');\r\nconst { bool, number, string, object, func, array, node, shape, oneOfType, arrayOf } = PropTypes;\r\nimport classNames from 'classnames';\r\n\r\nexport function component(displayName, defaultClass, conditionals={}, elem='div', propTypes={}, defaultProps={}, createElement=React.createElement) {\r\n\tfunction render(props) {\r\n\t\tlog.debug('render', props);\r\n\t\tconst { className, defaultClass, children, ...others } = props;\r\n\t\tconst extraClasses = Object.keys(conditionals).map(x => ({[others[x + 'Class']]: others[x]}));\r\n\t\treturn createElement(elem, {className:classNames(className, defaultClass, extraClasses), ...others}, children);\r\n\t}\r\n\trender.displayName = displayName;\r\n\trender.propTypes = {\r\n\t\tdefaultClass: string,\r\n\t\tclassName: string,\r\n\t\tchildren: node,\r\n\t\t...propTypes\r\n\t}\r\n\trender.defaultProps = {\r\n\t\tdefaultClass,\r\n\t\t...defaultProps\r\n\t}\r\n\tfor (let key in conditionals) {\r\n\t\trender.propTypes[key + 'Class'] = string;\r\n\t\trender.propTypes[key] = oneOfType([bool, string, object, number, node]);\r\n\t\trender.defaultProps[key + 'Class'] = conditionals[key];\r\n\t}\r\n\treturn render;\r\n}\r\n\r\nexport const Badge = component('Badge', 'mdl-badge', {overlap:'mld-badge--overlap'}, 'span', {text:string}, {text:''},\r\n\t(elem, props, children) => {\r\n\t\tconst { text, overlap, ...others } = props;\r\n\t\treturn (\r\n\t\t\t<span {...others}>\r\n\t\t\t\t{children}\r\n\t\t\t\t<b>{text}</b>\r\n\t\t\t</span>\r\n\t\t)\r\n\t}\r\n);\r\n\r\nexport const LayoutTitle = component('LayoutTitle', 'mdl-layout__title')\r\nexport const LayoutObfuscator = component('LayoutObfuscator', 'mdl-layout__obfuscator', {open:'is-visible'}, 'div', {onCancel: func.isRequired}, {},\r\n\t(elem, props, children) => {\r\n\t\tconst { onCancel, ...others } = props;\r\n\t\tconst cancel = event => {event.preventDefault(); onCancel();}\r\n\t\treturn (\r\n\t\t\t<div onClick={cancel} onTouchEnd={cancel} {...others} />\r\n\t\t)\r\n\t}\r\n)\r\n\r\nexport const Sprite = component('Sprite', 'material-icons-sprite', {}, 'i', {name: string.isRequired}, {},\r\n\t(elem, props, children) => {\r\n\t\tconst { name, className, ...others } = props;\r\n\t\tconst classes = classNames(className, name);\r\n\t\treturn (\r\n\t\t\t<i className={classes} {...others} />\r\n\t\t)\r\n\t}\r\n)\r\n\r\nexport const Switch = component('Switch', 'mdl-switch', {ripple:'mdl-js-ripple-efect'}, 'label',\r\n\t{\r\n\t\tname: string.isRequired,\r\n\t\ticon: string,\r\n\t\tsprite: string,\r\n\t\ton: bool,\r\n\t},\r\n\t{\r\n\t\ton: false\r\n\t},\r\n\t(elem, props, children) => {\r\n\t\tconst { name, icon, sprite, on, className, ...others } = props;\r\n\t\tconst classes = classNames(className, 'is-upgraded', {'is-checked':on, 'icon':!!icon, 'sprite':!!sprite});\r\n\t\treturn (\r\n\t\t\t<label className={classes} htmlFor={name} {...others}>\r\n\t\t\t\t<input type=\"checkbox\" id={name} className=\"mdl-switch__input\" defaultChecked={on} />\r\n\t\t\t\t<span className=\"mdl-switch__label\">\r\n\t\t\t\t\t{icon ? <Icon name={icon} /> : ''}\r\n\t\t\t\t\t{sprite ? <Sprite name={sprite} /> : ''}\r\n\t\t\t\t\t{children}\r\n\t\t\t\t</span>\r\n\t\t\t\t<div className=\"mdl-switch__track\"></div>\r\n\t\t\t\t<div className=\"mdl-switch__thumb\">\r\n\t\t\t\t\t<span className=\"mdl-switch__focus-helper\"></span>\r\n\t\t\t\t</div>\r\n\t\t\t</label>\r\n\t\t)\r\n\t}\r\n)\r\n\r\n/**\r\n * Controlled version of the MDL TextField component that adds a property `value`.\r\n */\r\nexport class Textfield extends Component {\r\n\tstatic propTypes = {...MdlTextfield.propTypes}\r\n\tstatic defaultProps = {...MdlTextfield.defaultProps, label:''}\r\n\r\n\tconstructor(...props) {\r\n\t\tsuper(...props);\r\n\t\tthis.onChange = this.onChange.bind(this);\r\n\t\tObject.defineProperty(this, 'value', {get:()=>this.props.value});\r\n\t}\r\n\r\n\tonChange(evt, ...params) {\r\n\t\tlog.debug('onChange', evt, evt.target.value);\r\n\t\tconst { onChange } = this.props;\r\n\t\treturn onChange && onChange(evt.target.value, evt, ...params);\r\n\t}\r\n\r\n\trender() {\r\n\t\tlog.debug('render', this.props);\r\n\t\tconst { onChange, children, ...props } = this.props;\r\n\t\treturn <MdlTextfield onChange={this.onChange} {...props} />\r\n\t}\r\n}\r\n\r\n/**\r\n * Stateful version of the MDL TextField component that adds a property `value`.\r\n *\r\n * This component is stateful; it uses `this.state` to keep track of the underlying\r\n * input's value. It basically does the work for you that is mentioned here:\r\n * https://facebook.github.io/react/docs/forms.html#controlled-components\r\n */\r\nexport class StatefulTextfield extends Component {\r\n\tstatic propTypes = {...MdlTextfield.propTypes}\r\n\tstatic defaultProps = {...MdlTextfield.defaultProps}\r\n\r\n\tconstructor(...props) {\r\n\t\tsuper(...props);\r\n\t\tthis.onChange = this.onChange.bind(this);\r\n\t\tthis.state = {value:this.props.value};\r\n\t\tObject.defineProperty(this, 'value', {get:()=>this.state.value});\r\n\t}\r\n\r\n\tonChange(evt, ...params) {\r\n\t\tlog.debug('onChange', evt, evt.target.value);\r\n\t\tthis.setState({value:evt.target.value});\r\n\t\tconst { onChange } = this.props;\r\n\t\treturn onChange && onChange(evt, ...params);\r\n\t}\r\n\r\n\trender() {\r\n\t\tconst { value } = this.state;\r\n\t\tlog.debug('render', value);\r\n\t\tconst { children, onChange, ...props } = this.props;\r\n\t\treturn <MdlTextfield value={value} onChange={this.onChange} {...props} />\r\n\t}\r\n}\r\n\r\n/** The front face of a flippable Card */\r\nexport const FrontFace = component('FrontFace', 'mdl-card__face mdl-card__front');\r\n/** The back face of a flippable Card */\r\nexport const BackFace = component('BackFace', 'mdl-card__face mdl-card__back');\r\n\r\nexport const FlipCard = component('FlipCard', 'mdl-card is-flippable', {flipped: 'is-flipped'});\r\n\r\n/**\r\n * A base class to create a MDL Card that is flippable.\r\n *\r\n * This class is stateful; it manages the flip state in `this.state`.\r\n * If you extend from it, you need to implement `render()` and use\r\n * the methods `isFlipped()` and `flip()` to inspect/update the\r\n * flip state in response to e.g. clicks etc.\r\n */\r\nexport class StatefulFlipCard extends Component {\r\n\tstatic propTypes = {\r\n\t\tflipped: bool,\r\n\t\tclassName: string,\r\n\t\tfrontLoadDelay: number,\r\n\t\tbackLoadDelay: number,\r\n\t}\r\n\tstatic defaultProps = {\r\n\t\tflipped: false,\r\n\t\tfrontLoadDelay: 0,\r\n\t\tbackLoadDelay: 0,\r\n\t}\r\n\tconstructor(...props) {\r\n\t\tsuper(...props);\r\n\t\tthis.state = {\r\n\t\t\tflipped: this.props.flipped,\r\n\t\t\tbackLoaded:!this.props.backLoadDelay,\r\n\t\t\tfrontLoaded:!this.props.frontLoadDelay,\r\n\t\t};\r\n\t\tthis.flip = this.flip.bind(this);\r\n\t}\r\n\r\n\tisFlipped() {\r\n\t\treturn this.state.flipped;\r\n\t}\r\n\r\n\tflip(event) {\r\n\t\tif (event && event.defaultPrevented) {return;}\r\n\t\tconst { flipped, frontLoaded, backLoaded } = this.state;\r\n\t\tthis.setState({...this.state, flipped: !flipped, backLoaded: backLoaded || !flipped, frontLoaded: frontLoaded || flipped});\r\n\t}\r\n\r\n\tcomponentDidMount() {\r\n\t\tconst { frontLoadDelay, backLoadDelay } = this.props;\r\n\t\tif (frontLoadDelay) {\r\n\t\t\tthis.frontLoad = setTimeout(() => {this.setState({...this.state, frontLoaded:true});}, frontLoadDelay);\r\n\t\t}\r\n\t\tif (backLoadDelay) {\r\n\t\t\tthis.backLoad = setTimeout(() => {this.setState({...this.state, backLoaded:true});}, backLoadDelay);\r\n\t\t}\r\n\t}\r\n\r\n\tcomponentWillUnmount() {\r\n\t\tclearTimeout(this.frontLoad);\r\n\t\tclearTimeout(this.backLoad);\r\n\t}\r\n\r\n\trender() {\r\n\t\tconst { className, flipped, frontLoadDelay, backLoadDelay, children, ...others } = this.props;\r\n\t\tlet frontProps, frontChilds, backProps, backChilds;\r\n\t\tfor (let i=0, elem; elem=children[i]; i++) {\r\n\t\t\tif (elem.type === FrontFace) {\r\n\t\t\t\tconst { children, ...others } = elem.props;\r\n\t\t\t\tfrontProps = others;\r\n\t\t\t\tfrontChilds = children;\r\n\t\t\t}\r\n\t\t\telse if (elem.type === BackFace) {\r\n\t\t\t\tconst { children, ...others } = elem.props;\r\n\t\t\t\tbackProps = others;\r\n\t\t\t\tbackChilds = children;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn (\r\n\t\t\t<FlipCard className={className} flipped={this.isFlipped()} onClick={this.flip} {...others} >\r\n\t\t\t\t<FrontFace {...frontProps}>\r\n\t\t\t\t\t{this.state.frontLoaded ? frontChilds : ''}\r\n\t\t\t\t</FrontFace>\r\n\t\t\t\t<BackFace {...backProps}>\r\n\t\t\t\t\t{this.state.backLoaded ? backChilds : ''}\r\n\t\t\t\t</BackFace>\r\n\t\t\t</FlipCard>\r\n\t\t)\r\n\t}\r\n}\r\n\r\nexport const SimpleDialog = component('SimpleDialog', 'mdl-dialog', {visible:'is-visible'}, 'div', {}, {},\r\n\t(elem, props, children) => {\r\n\t\tconst { visible, ...others } = props;\r\n\t\treturn (\r\n\t\t\t<div className={props.className} {...others}>\r\n\t\t\t\t{visible ? children : undefined}\r\n\t\t\t</div>\r\n\t\t)\r\n\t}\r\n)\r\nexport const Modal = component('Modal', 'mdl-modal', {}, 'div', {open:bool.isRequired, onCancel: func.isRequired}, {},\r\n\t(elem, props, children) => {\r\n\t\tconst { open, onCancel, ...others } = props;\r\n\t\treturn (\r\n\t\t\t<div {...others}>\r\n\t\t\t\t{children}\r\n\t\t\t\t<LayoutObfuscator open={open} onCancel={onCancel} />\r\n\t\t\t</div>\r\n\t\t)\r\n\t}\r\n)\r\n\r\nexport const Dialog = component('Dialog', '', {}, 'div',\r\n\t{\r\n\t\topen: bool,\r\n\t\tmodal: bool,\r\n\t\tonCancel: func,\r\n\t},\r\n\t{\r\n\t\topen: false,\r\n\t\tmodal: false\r\n\t},\r\n\t(elem, props, children) => {\r\n\t\tconst { open, modal, onCancel, ...others } = props;\r\n\t\treturn (modal\r\n\t\t?\r\n\t\t\t<Modal open={open} onCancel={onCancel}>\r\n\t\t\t\t<SimpleDialog visible={open} {...others}>\r\n\t\t\t\t\t{children}\r\n\t\t\t\t</SimpleDialog>\r\n\t\t\t</Modal>\r\n\t\t:\r\n\t\t\t<SimpleDialog visible={open} {...others}>\r\n\t\t\t\t{children}\r\n\t\t\t</SimpleDialog>\r\n\t\t)\r\n\t}\r\n)\r\n\r\nexport const Drawer = component('Drawer', '', {right:'mdl-layout__drawer-right', open:'is-visible'}, 'div',\r\n\t{\r\n\t\tmodal: bool,\r\n\t\tautoClose: bool,\r\n\t\tonCancel: func,\r\n\t},\r\n\t{\r\n\t\tmodal: false,\r\n\t\tautoClose: false,\r\n\t},\r\n\t(elem, props, children) => {\r\n\t\tlog.debug('render', props);\r\n\t\tconst { open, modal, autoClose, onCancel, onClick, ...others } = props;\r\n\t\treturn (modal\r\n\t\t?\r\n\t\t\t<Modal open={open} onCancel={onCancel}>\r\n\t\t\t\t<MdlDrawer visible={open} onClick={(e) => onClick ? onClick(e) : (autoClose ? onCancel(e) : undefined)} {...others}>\r\n\t\t\t\t\t{children}\r\n\t\t\t\t</MdlDrawer>\r\n\t\t\t</Modal>\r\n\t\t:\r\n\t\t\t<MdlDrawer {...others}>\r\n\t\t\t\t{children}\r\n\t\t\t</MdlDrawer>\r\n\t\t)\r\n\t}\r\n)\r\n\r\n\r\nexport class Lightbox extends Component {\r\n\tstatic displayName = 'Lightbox';\r\n\r\n\tstatic propTypes = {\r\n\t\topen: bool,\r\n\t\timages: arrayOf(shape({\r\n\t\t\tsrc: string.isRequired,\r\n\t\t\tsrcset: array,\r\n\t\t\tcaption: string,\r\n\t\t})),\r\n\t\tindex: number,\r\n\t\tonCancel: func,\r\n\t\tonNext: func,\r\n\t\tonPrev: func,\r\n\t\tonNav: func,\r\n\r\n\t\tnoKeyboardInput: bool,\r\n\t\tnoBackdropCancel: bool,\r\n\t\tnoNextOnClick: bool,\r\n\t\tnoCloseButton: bool,\r\n\t\tnoImageCount: bool,\r\n\t\tnoPositionIndicators: bool,\r\n\t\tnoPreload: bool,\r\n\t\tnoSpinner: bool,\r\n\t\tnoRotate: bool,\r\n\t\twidth: number,\r\n\t}\r\n\r\n\tstatic defaultProps = {\r\n\t\topen: false,\r\n\t\timages: [],\r\n\t\tindex: 0,\r\n\r\n\t\tnoKeyboardInput: false,\r\n\t\tnoBackdropCancel: false,\r\n\t\tnoNextOnClick: false,\r\n\t\tnoCloseButton: false,\r\n\t\tnoImageCount: false,\r\n\t\tnoPositionIndicators: false,\r\n\t\tnoPreload: false,\r\n\t\tnoSpinner: false,\r\n\t\tnoRotate: false,\r\n\t\twidth: 900,\r\n\t}\r\n\r\n\tconstructor() {\r\n\t\tsuper();\r\n\t\tthis.state = {loaded:[]}\r\n\t\tthis.cancel = this.cancel.bind(this);\r\n\t\tthis.next = this.next.bind(this);\r\n\t\tthis.prev = this.prev.bind(this);\r\n\t\tthis.nav = this.nav.bind(this);\r\n\t\tthis.imageClicked = this.imageClicked.bind(this);\r\n\t\tthis.keyPressed = this.keyPressed.bind(this);\r\n\t}\r\n\r\n\tcomponentDidMount() {\r\n\t\tconst { noKeyboardInput } = this.props;\r\n\t\tif (!noKeyboardInput && typeof window == 'object') {window.addEventListener('keydown', this.keyPressed);}\r\n\t}\r\n\r\n\tcomponentWillUnmount() {\r\n\t\tconst { noKeyboardInput } = this.props;\r\n\t\tif (!noKeyboardInput && typeof window == 'object') {window.removeEventListener('keydown', this.keyPressed);}\r\n\t}\r\n\r\n\tcancel(event) {\r\n\t\tlog.log('cancel', event);\r\n\t\tconst { noBackdropCancel, onCancel } = this.props;\r\n\t\tif (noBackdropCancel) return;\r\n\t\tthis.setState({loaded:[]});\r\n\t\tif (onCancel) {onCancel(event);}\r\n\t\tif (event) {event.preventDefault(); event.stopPropagation();}\r\n\t}\r\n\r\n\tnext(event) {\r\n\t\tlog.log('next', event);\r\n\t\tconst { images, index, onNext, onNav, noRotate } = this.props;\r\n\t\tif (index === images.length - 1) {\r\n\t\t\tif (noRotate) {return;}\r\n\t\t\tif (onNav) {onNav(0, event);}\r\n\t\t} else {\r\n\t\t\tif (onNext) {onNext(event);}\r\n\t\t}\r\n\t\tif (event) {event.preventDefault(); event.stopPropagation();}\r\n\t}\r\n\r\n\tprev(event) {\r\n\t\tlog.log('prev', event);\r\n\t\tconst { images, index, onPrev, onNav, noRotate } = this.props;\r\n\t\tif (index === 0) {\r\n\t\t\tif (noRotate) {return;}\r\n\t\t\tif (onNav) {onNav(images.length - 1, event);}\r\n\t\t} else {\r\n\t\t\tif (onPrev) {onPrev(event);}\r\n\t\t}\r\n\t\tif (event) {event.preventDefault(); event.stopPropagation();}\r\n\t}\r\n\r\n\tnav(idx, event) {\r\n\t\tlog.log('nav', event);\r\n\t\tconst { onNav } = this.props;\r\n\t\tif (onNav) {onNav(idx, event);}\r\n\t\tif (event) {event.preventDefault(); event.stopPropagation();}\r\n\t}\r\n\r\n\timageClicked(event) {\r\n\t\tlog.log('imageClicked', event);\r\n\t\tif (this.props.noNextOnClick) return;\r\n\t\tthis.next(event);\r\n\t}\r\n\r\n\r\n\timageLoaded(event, index) {\r\n\t\tlog.log('imageLoaded', event, index);\r\n\t\tconst loaded = this.state.loaded.concat();\r\n\t\tloaded[index] = true;\r\n\t\tthis.setState({loaded});\r\n\t}\r\n\r\n\tkeyPressed(event) {\r\n\t\tif (event.keyCode === 37) {\r\n\t\t\tthis.prev(event);\r\n\t\t} else if (event.keyCode === 39) {\r\n\t\t\tthis.next(event);\r\n\t\t} else if (event.keyCode === 27) {\r\n\t\t\tthis.cancel(event);\r\n\t\t}\r\n\t}\r\n\r\n\trender() {\r\n\t\tconst { open, index, images, noCloseButton, noImageCount, noPositionIndicators, noPreload, noSpinner, noRotate } = this.props;\r\n\t\tconst noImages = !images || !images.length;\r\n\t\tconst caption = !noImages && images[index].caption;\r\n\t\tconst style = { cursor: this.props.noNextOnClick ? 'auto' : 'pointer', opacity: this.state.loaded[index] ? 1 : 0};\r\n\t\tconst alt = !noImages && images[index].alt;\r\n\t\tconst imgStyle = !this.state.loaded[index] ? {position:'absolute', width:0, height:0} : {};\r\n\t\tconst positionIndicators = noPositionIndicators ? undefined : (\r\n\t\t\t<div className=\"mdl-lightbox__position-indicators\">\r\n\t\t\t\t{images.map((img, i) => (\r\n\t\t\t\t\t<a key={i} href=\"#\" className={'mdl-lightbox__position-indicator' + (i === index ? ' is-active' : '')}\r\n\t\t\t\t\t\tonClick={(evt) => this.nav(i, evt)} onTouchEnd={(evt) => this.nav(i, evt)}><b></b></a>\r\n\t\t\t\t))}\r\n\t\t\t</div>\r\n\t\t)\r\n\t\tconst imageCount = noImageCount ? undefined : <div className=\"mdl-lightbox__image-count\">{index + 1} / {images.length}</div>;\r\n\t\tconst figcaption = !caption ? undefined : <figcaption className=\"mdl-lightbox__caption\">{caption}</figcaption>;\r\n\t\tconst noFooter = !caption && !positionIndicators && !imageCount;\r\n\t\treturn (\r\n\t\t\t<Modal open={open} onCancel={this.cancel}>\r\n\t\t\t\t<div className={'mdl-lightbox' + (open ? ' is-visible' : '')}>\r\n\t\t\t\t\t<div className=\"mdl-lightbox__content\">\r\n\r\n\t\t\t\t\t\t{noCloseButton ? undefined :\r\n\t\t\t\t\t\t\t<FABButton className=\"mdl-lightbox__close-button\" onClick={this.cancel} onTouchEnd={this.cancel}>\r\n\t\t\t\t\t\t\t\t<Icon name=\"close\" />\r\n\t\t\t\t\t\t\t</FABButton>\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t{noImages ? undefined :\r\n\t\t\t\t\t\t\t<figure>\r\n\t\t\t\t\t\t\t\t{!this.state.loaded[index] ?\r\n\t\t\t\t\t\t\t\t\t<Spinner />\r\n\t\t\t\t\t\t\t\t:''}\r\n\t\t\t\t\t\t\t\t{!this.state.loaded[index] && alt ?\r\n\t\t\t\t\t\t\t\t\t<img src={alt.src} style={alt.style} />\r\n\t\t\t\t\t\t\t\t:''}\r\n\t\t\t\t\t\t\t\t<img\r\n\t\t\t\t\t\t\t\t\tonClick={this.imageClicked}\r\n\t\t\t\t\t\t\t\t\tonLoad={e => this.imageLoaded(e, index)}\r\n\t\t\t\t\t\t\t\t\tonTouchEnd={this.imageClicked}\r\n\t\t\t\t\t\t\t\t\tsrc={images[index].src}\r\n\t\t\t\t\t\t\t\t\tstyle={{...style, ...imgStyle}}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t{noFooter ? undefined :\r\n\t\t\t\t\t\t\t\t\t<div className=\"mdl-lightbox__footer\">\r\n\t\t\t\t\t\t\t\t\t\t{positionIndicators}\r\n\t\t\t\t\t\t\t\t\t\t{imageCount}\r\n\t\t\t\t\t\t\t\t\t\t{figcaption}\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t</figure>\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t{noPreload || !this.state.loaded[index] ? undefined :\r\n\t\t\t\t\t\t\t<div className=\"mdl-lightbox__preload\" style={{width:0, height:0, overflow:'hidden', opacity:0}}>\r\n\t\t\t\t\t\t\t\t{images.map(({src}, i) => (i === index ? undefined :\r\n\t\t\t\t\t\t\t\t\t<img key={i} src={src} onLoad={e => this.imageLoaded(e, i)} />\r\n\t\t\t\t\t\t\t\t))}\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t<FABButton className=\"mdl-lightbox__prev-button\" disabled={noRotate && (index === 0)} onClick={this.prev} onTouchEnd={this.prev}>\r\n\t\t\t\t\t\t<Icon name=\"navigate_before\" />\r\n\t\t\t\t\t</FABButton>\r\n\r\n\t\t\t\t\t<FABButton className=\"mdl-lightbox__next-button\" disabled={noRotate && (index === images.length - 1)} onClick={this.next} onTouchEnd={this.next}>\r\n\t\t\t\t\t\t<Icon name=\"navigate_next\" />\r\n\t\t\t\t\t</FABButton>\r\n\r\n\t\t\t\t</div>\r\n\t\t\t</Modal>\r\n\t\t);\r\n\t}\r\n};\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/components/Mdl/mdl-extras.jsx\n **/","module.exports = require(\"redux-apis\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"redux-apis\"\n ** module id = 13\n ** module chunks = 0\n **/","module.exports = require(\"babel-runtime/core-js/object/define-properties\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"babel-runtime/core-js/object/define-properties\"\n ** module id = 14\n ** module chunks = 0\n **/","module.exports = require(\"babel-runtime/core-js/promise\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"babel-runtime/core-js/promise\"\n ** module id = 15\n ** module chunks = 0\n **/","module.exports = require(\"babel-runtime/helpers/typeof\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"babel-runtime/helpers/typeof\"\n ** module id = 16\n ** module chunks = 0\n **/","module.exports = require(\"classnames\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"classnames\"\n ** module id = 17\n ** module chunks = 0\n **/","module.exports = require(\"redux-fetch-api\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"redux-fetch-api\"\n ** module id = 18\n ** module chunks = 0\n **/","import log from 'picolog';\r\nimport Api, { link } from 'redux-apis';\r\nimport { remote, endpoint, fetcher } from 'redux-fetch-api';\r\nimport Suid from 'ws.suid';\r\n\r\nimport { Role } from '../Auth/Role';\r\nimport { Group } from '../Auth/Group';\r\nimport { Account } from '../Auth/Account';\r\nimport { AuthApi } from '../Auth/api';\r\nimport { Brand } from '../Brands/Brand';\r\nimport { BrandsApi } from '../Brands/api';\r\nimport { Product } from '../Products/Product';\r\nimport { Rating } from '../Products/Rating';\r\nimport { StockItem } from '../Products/StockItem';\r\nimport { ProductsApi } from '../Products/api';\r\nimport { Store } from '../Stores/Store';\r\nimport { StoresApi } from '../Stores/api';\r\nimport { DrawerApi, LightboxApi } from '../Mdl/api';\r\n\r\nconst API_URL = apiUrl();\r\nlog.info('Using BridalApp API Server url: ', API_URL);\r\nlet idx, lastSlash = 0;\r\nwhile ((idx = API_URL.indexOf('/', lastSlash + 1)) !== -1) {lastSlash = idx;}\r\nconst SUID_URL = API_URL.substring(0, lastSlash) + '/suid/suid.json';\r\nlog.info('Using Suid Server url: ', SUID_URL);\r\nSuid.config({server: SUID_URL});\r\n\r\n// override the default fetcher with one that does a cross-origin (CORS) request and has a timeout\r\n@fetcher(authenticatedCrossOriginFetchWithTimeout)\r\n@remote(API_URL)\r\nexport class AppApi extends Api {\r\n\tstatic INITIAL_STATE = {\r\n\t\tmanagedStores: [],\r\n\t\tmanagedStoreIndex: 0,\r\n\t\tmanagedBrands: [],\r\n\t\tmanagedBrandIndex: 0,\r\n\t}\r\n\r\n\tstatic SET_MANAGED_STORES = 'SET_MANAGED_STORES';\r\n\tstatic SET_MANAGED_STORE_INDEX = 'SET_MANAGED_STORE_INDEX';\r\n\tstatic SET_MANAGED_BRANDS = 'SET_MANAGED_BRANDS';\r\n\tstatic SET_MANAGED_BRAND_INDEX = 'SET_MANAGED_BRAND_INDEX';\r\n\r\n\tconstructor(state = AppApi.INITIAL_STATE) {\r\n\t\tsuper(state);\r\n\r\n\t\tObject.defineProperties(this, {\r\n\t\t\tAccount: \t{enumerable:true, value:Account},\r\n\t\t\tBrand: \t\t{enumerable:true, value:Brand},\r\n\t\t\tGroup: \t\t{enumerable:true, value:Group},\r\n\t\t\tProduct: \t{enumerable:true, value:Product},\r\n\t\t\tRating: \t{enumerable:true, value:Rating},\r\n\t\t\tRole: \t\t{enumerable:true, value:Role},\r\n\t\t\tStockItem: \t{enumerable:true, value:StockItem},\r\n\t\t\tStore: \t\t{enumerable:true, value:Store},\r\n\t\t});\r\n\r\n\t\tthis.auth = remote('/auth')(\r\n\t\t\tlink(this, new AuthApi())\r\n\t\t);\r\n\r\n\t\tthis.brands = remote('/brands')(\r\n\t\t\tlink(this, new BrandsApi())\r\n\t\t);\r\n\r\n\t\tthis.products = remote('/products')(\r\n\t\t\tlink(this, new ProductsApi())\r\n\t\t);\r\n\r\n\t\tthis.stores = remote('/stores')(\r\n\t\t\tlink(this, new StoresApi())\r\n\t\t);\r\n\r\n\t\tthis.leftDrawer = link(this, new DrawerApi());\r\n\t\tthis.rightDrawer = link(this, new DrawerApi());\r\n\t\tthis.lightbox = link(this, new LightboxApi());\r\n\t}\r\n\r\n\tauthenticated() {\r\n\t\tlog.debug('authenticated');\r\n\t\treturn this.auth.authenticated();\r\n\t}\r\n\r\n\tgetSession() {\r\n\t\treturn this.auth.session;\r\n\t}\r\n}\r\n\r\n// A version of fetch that sets cors headers and intercepts 401 Unauthorized responses.\r\n// J2EE servers will, after a succesful login, send a 302 redirect with the original url.\r\n// This function capitalizes on that to do transparent interception\r\nfunction authenticatedCrossOriginFetchWithTimeout(url, opts) {\r\n\tlog.log('authenticatedCrossOriginFetchWithTimeout', url);\r\n\topts = {credentials:'include', mode:'cors', ...opts};\r\n\r\n\tif (typeof global == 'object' && global.session) {\r\n\t\topts.headers = opts.headers || {};\r\n\t\topts.headers['Cookie'] = 'JSESSIONID=' + global.session;\r\n\t}\r\n\tconst result = new Promise((resolve, reject)=>{\r\n\t\tconst timeout = setTimeout(() => {reject(Error(`timed out after 30s.`))}, 30000);\r\n\t\tlog.debug('authenticatedCrossOriginFetchWithTimeout: fetching...');\r\n\t\tfetch(url, opts)\r\n\t\t\t.then(response => {\r\n\t\t\t\tclearTimeout(timeout);\r\n\t\t\t\tlog.debug('authenticatedCrossOriginFetchWithTimeout: got response ', response);\r\n\t\t\t\tif (response.status && response.status === 401) {\r\n\t\t\t\t\t// auth needed\r\n\t\t\t\t\tlog.debug('authenticatedCrossOriginFetchWithTimeout: auth needed');\r\n\t\t\t\t\tif (typeof window == 'object') {\r\n\t\t\t\t\t\tlog.debug('authenticatedCrossOriginFetchWithTimeout: client, allow login');\r\n\t\t\t\t\t\t// client, allow user to login\r\n\t\t\t\t\t\treturn response.json()\r\n\t\t\t\t\t\t\t.then(json => {\r\n\t\t\t\t\t\t\t\tlog.debug('authenticatedCrossOriginFetchWithTimeout: calling auth.challenge...');\r\n\t\t\t\t\t\t\t\treturn this.auth.challenge(json.challenge, resolve, reject)\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t.catch(reject);\r\n\t\t\t\t\t}\r\n\t\t\t\t\t// server, reject with error\r\n\t\t\t\t\treturn response.text().then(text => {\r\n\t\t\t\t\t\tconst error = Error(text);\r\n\t\t\t\t\t\terror.status = response.status;\r\n\t\t\t\t\t\terror.statusText = response.statusText;\r\n\t\t\t\t\t\treject(error);\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t\tresolve(response);\r\n\t\t\t})\r\n\t\t\t.catch(reject);\r\n\t});\r\n\treturn result;\r\n}\r\n\r\nfunction apiUrl() {\r\n\tif (typeof window == 'object') {\r\n\t\treturn window.__bridalapp_api_server || 'http://api.bridalapp.net/api';\r\n\t}\r\n\tconst protocol = process.env.BRIDALAPP_API_SERVER_PROTOCOL || 'http://';\r\n\tconst host = process.env.BRIDALAPP_API_SERVER_HOST || 'localhost';\r\n\tconst port = process.env.BRIDALAPP_API_SERVER_PORT || '8080';\r\n\tconst path = process.env.BRIDALAPP_API_SERVER_PATH || '/api';\r\n\treturn protocol + host + (port == '80' ? '' : ':' + port) + path;\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/components/App/api.jsx\n **/","import Entity, { fromJSON } from '../Entity/Entity';\r\nimport Suid from 'ws.suid';\r\n\r\n@Entity\r\nexport class Role {}\r\n\r\nRole.GUEST = new Role({id:1, name:'Guest'});\r\nRole.USER = new Role({id:2, name:'User'});\r\nRole.STORE_USER = new Role({id:3, name:'Store-User'});\r\nRole.STORE_MANAGER = new Role({id:4, name:'Store-Manager'});\r\nRole.BRAND_USER = new Role({id:5, name:'Brand-User'});\r\nRole.BRAND_MANAGER = new Role({id:6, name:'Brand-Manager'});\r\nRole.BRAUTSCHLOSS_USER = new Role({id:7, name:'Brautschloss-User'});\r\nRole.BRAUTSCHLOSS_MANAGER = new Role({id:8, name:'Brautschloss-Manager'});\r\nRole.ADMINISTRATOR = new Role({id:9, name:'Administrator'});\r\n\r\nRole.BRAUTSCHLOSS_ROLES = [Role.BRAUTSCHLOSS_MANAGER, Role.BRAUTSCHLOSS_USER];\r\nRole.STORE_ROLES = [Role.STORE_MANAGER, Role.STORE_USER];\r\nRole.BRAND_ROLES = [Role.BRAND_MANAGER, Role.BRAND_USER];\r\n\r\nexport default Role;\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/components/Auth/Role.jsx\n **/","module.exports = require(\"babel-runtime/helpers/objectWithoutProperties\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"babel-runtime/helpers/objectWithoutProperties\"\n ** module id = 21\n ** module chunks = 0\n **/","import log from 'picolog';\r\nimport { createStore, applyMiddleware, combineReducers, compose } from 'redux';\r\nimport thunk from 'redux-thunk';\r\nimport createLogger from 'redux-logger';\r\nimport { link, namedLink } from 'redux-apis';\r\n\r\nimport { fromJSON } from './components/Entity/Entity';\r\n\r\nfunction createReducer(app) {\r\n\tconst rootReducer = combineReducers({\r\n\t\t/*\r\n\t\tbrowser: createResponsiveStateReducer({\r\n\t\t\t// Breakpoints for responsive layout. Chosen to group similar devices.\r\n\t\t\t// Note that these are *CSS pixels* we are talking about, not *physical pixels*.\r\n\t\t\t// Read more here: http://www.quirksmode.org/blog/archives/2010/04/a_pixel_is_not.html\r\n\t\t\t// E.G. the iPhone 4 screen has a resolution of 640x960 physical pixels, but only 320x480\r\n\t\t\t// CSS pixels; manufacturers choose a `devicePixelRatio` suitable for their device, because\r\n\t\t\t// if we render text at the normal size on these device's high DPI screens, it would become\r\n\t\t\t// illegibly small. As such, these numbers are unlikely to radically change, even if\r\n\t\t\t// physical resolutions keep improving, because they are more related to the dimensions of\r\n\t\t\t// the screen in centimeters than to the resolution in pixels.\r\n\t\t\t// SEE: http://www.mydevice.io/devices/\r\n\t\t\t\t\t\t// < 320: unsupported\r\n\t\t\txxs: 320,\t// < 360: small phones, portrait (e.g. iPhone 4)\r\n\t\t\txs: 360,\t// < 480: large phones/phablets, portrait (e.g. Samsung Galaxy S5, iPhone 6 Plus)\r\n\t\t\tsm: 480,\t// < 720: small tablets, portrait\r\n\t\t\tmd: 720,\t// < 1025: large tablets, portrait\r\n\t\t\tlg: 1025,\t// < 1600: small monitor, landscape (cutoff at 1025 i.s.o 1024 to exclude tablets with 1024x1440 resolution)\r\n\t\t\txl: 1600,\t// < 2560: HD monitor\r\n\t\t\txxl: 2560,\t// Projection screens, VR devices?\r\n\t\t}),\r\n\t\t*/\r\n\t\tapp: app.reducer,\r\n\t});\r\n\r\n\treturn function(state, action) {\r\n\t\tconst currentState = action.type === '@@bridalapp/RESET' ? undefined : state;\r\n\t\treturn rootReducer(currentState, action);\r\n\t}\r\n}\r\n\r\nconst storeEnhancer = typeof window == 'object'\r\n\t\t? compose(applyMiddleware(thunk, createLogger({logger: log})))\r\n\t\t: compose(applyMiddleware(thunk));\r\n\r\nlet AppApi = require('./components/App/api').AppApi;\r\nlet app = new AppApi();\r\n\r\nexport const store = createStore(\r\n\tcreateReducer(app),\r\n\ttypeof window == 'object' && window.bridalapp_initial_state && fromJSON(window.bridalapp_initial_state) || undefined,\r\n\tstoreEnhancer\r\n);\r\nstore.app = link(store, app);\r\nexport default store;\r\n\r\nif (typeof window == 'object') {window.bridalapp = app;}\r\nelse if (typeof global == 'object') {global.bridalapp = app;}\r\n\r\nif (module.hot) {\r\n\tmodule.hot.accept('./components/App/api', () => {\r\n\t\tconst msg = 'Hot-reloading \\'./components/App/api\\'',\r\n\t\t\targs = typeof window=='object'? [`%c${msg}`,'color:green'] : [msg];\r\n\r\n\t\tAppApi = require('./components/App/api').AppApi;\r\n\t\tapp = new AppApi();\r\n\t\tstore.replaceReducer(createReducer(app));\r\n\t\tstore.app = link(store, app);\r\n\t\tif (typeof window == 'object') {window.bridalapp = app;}\r\n\t\telse if (typeof global == 'object') {global.bridalapp = app;}\r\n\t});\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/store.jsx\n **/","module.exports = require(\"react-redux\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"react-redux\"\n ** module id = 23\n ** module chunks = 0\n **/","module.exports = require(\"babel-runtime/core-js/object/keys\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"babel-runtime/core-js/object/keys\"\n ** module id = 24\n ** module chunks = 0\n **/","module.exports = require(\"fbjs/lib/shallowEqual\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"fbjs/lib/shallowEqual\"\n ** module id = 25\n ** module chunks = 0\n **/","module.exports = require(\"react-router\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"react-router\"\n ** module id = 26\n ** module chunks = 0\n **/","module.exports = require(\"redux-load-api\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"redux-load-api\"\n ** module id = 27\n ** module chunks = 0\n **/","import log from 'picolog';\r\nimport Api, { link } from 'redux-apis';\r\nimport Async from 'redux-async-api';\r\nimport { remote } from 'redux-fetch-api';\r\n\r\nimport { TextfieldApi } from '../Mdl/api';\r\nimport { fromJSON, toJSON, indexOf } from '../Entity/Entity';\r\n\r\nimport Suid from 'ws.suid';\r\nimport PasswordCredential from './PasswordCredential';\r\nimport Account from './Account';\r\nimport Role from './Role';\r\n\r\nexport class LoginDialogApi extends Api {\r\n\tconstructor(...args) {\r\n\t\tsuper(...args);\r\n\t\tthis.username = link(this, new TextfieldApi());\r\n\t\tthis.username.type = 'text';\r\n//\t\tthis.username.pattern = '\\s*\\S.{1,}\\S\\s*';\r\n\t\tthis.password = link(this, new TextfieldApi());\r\n\t\tthis.password.type = 'password';\r\n//\t\tthis.password.pattern = '\\s*\\S.{5,}\\S\\s*';\r\n\t}\r\n\r\n}\r\n\r\nexport class RegisterDialogApi extends Api {\r\n\tconstructor(...args) {\r\n\t\tsuper(...args);\r\n\t\tthis.username = link(this, new TextfieldApi());\r\n\t\tthis.username.type = 'text';\r\n//\t\tthis.username.pattern = '\\s*\\S.{1,}\\S\\s*';\r\n\t\tthis.password = link(this, new TextfieldApi());\r\n\t\tthis.password.type = 'password';\r\n//\t\tthis.password.pattern = '\\s*\\S.{5,}\\S\\s*';\r\n\t\tthis.confirm = link(this, new TextfieldApi());\r\n\t\tthis.confirm.type = 'password';\r\n//\t\tthis.confirm.pattern = '\\s*\\S.{5,}\\S\\s*';\r\n\t}\r\n}\r\n\r\nconst NULL_SESSION = {sessionId:null, user:null};\r\n\r\n@remote\r\nexport class AuthApi extends Async {\r\n\tstatic CHALLENGE = 'AUTH_CHALLENGE';\r\n\tstatic LOGGED_IN = 'LOGGED_IN';\r\n\tstatic LOGGED_OUT = 'LOGGED_OUT';\r\n\tstatic CANCEL = 'CANCEL_AUTH';\r\n\r\n\tstatic INITIAL_STATE = {\r\n\t\t...Async.INITIAL_STATE,\r\n\t\tsession: NULL_SESSION,\r\n\t\tchallenge: null,\r\n\t};\r\n\r\n\tconstructor(state = AuthApi.INITIAL_STATE) {\r\n\t\tsuper(state);\r\n\r\n\t\tthis.setHandler(AuthApi.CHALLENGE, (state, {payload}) => ({...state, challenge:payload}));\r\n\t\tthis.setHandler(AuthApi.LOGGED_IN,\t(state, {payload}) => ({...state, session:payload, challenge:null}));\r\n\t\tthis.setHandler(AuthApi.LOGGED_OUT, (state, {payload}) => ({...state, session:payload, challenge:null}));\r\n\t\tthis.setHandler(AuthApi.CANCEL, (state, action) => ({...state, challenge:null}));\r\n\r\n\t\tObject.defineProperties(this, {\r\n\t\t\tloggedIn: {enumerable:true, get: () => !!(this.session && this.session.user)},\r\n\t\t\tchallenged: {enumerable:true, get: () => !!(this.challenge() && this.challenge().url && !this.challenge().accepted)},\r\n\t\t\tsession: {enumerable:true, get: () => this.getState().session},\r\n\t\t});\r\n\r\n\t\tthis.onProvoke = () => this.provoke();\r\n\t\tthis.onCancel = () => this.cancel();\r\n\t\tthis.onLogin = () => this.login();\r\n\t\tthis.onLogout = () => this.logout();\r\n\t\tthis.onRegister = () => this.register();\r\n\r\n\t\tthis.loginDialog = link(this, new LoginDialogApi())\r\n\t\tthis.registerDialog = link(this, new RegisterDialogApi())\r\n\t}\r\n\r\n\tloadSession() {\r\n\t\tlog.debug('loadSession');\r\n\t\tthis.setBusy();\r\n\t\treturn fetchSessionInfo(this)\r\n\t\t\t.then(session => {\r\n\t\t\t\tlog.log('loadSession => ', session);\r\n\t\t\t\tthis.setDone();\r\n\t\t\t\treturn session;\r\n\t\t\t});\r\n\t}\r\n\r\n\tlogin(username, password) {\r\n\t\tif (username === undefined) {return this.login(this.loginDialog.username.value, this.loginDialog.password.value);}\r\n\r\n\t\tfunction remoteLogin(auth, challenge) {\r\n\t\t\tlog.debug('remoteLogin', auth, challenge);\r\n\t\t\treturn auth.fetch(challenge.url, {\r\n\t\t\t\tmethod: challenge.method,\r\n\t\t\t\theaders: {\r\n\t\t\t\t\t'Content-Type': challenge.contentType,\r\n\t\t\t\t},\r\n\t\t\t\tbody: encode(challenge, username, password),\r\n\t\t\t})\r\n\t\t\t.then(response => {\r\n\t\t\t\tlog.debug('remoteLogin => ', response);\r\n\t\t\t\treturn fetchSessionInfo(auth)\r\n\t\t\t\t\t.then(session => {\r\n\t\t\t\t\t\tauth.setDone();\r\n\t\t\t\t\t\tchallenge.resolve(response);\r\n\t\t\t\t\t\treturn session;\r\n\t\t\t\t\t});\r\n\t\t\t})\r\n\t\t\t.catch(error => {\r\n\t\t\t\tauth.setError(error);\r\n\t\t\t\tchallenge.reject(error);\r\n\t\t\t})\r\n\t\t}\r\n\r\n\t\tif (this.loggedIn) {\r\n\t\t\tlog.log('Already logged in as `' + this.session.user.name + '`: ', this.session.user);\r\n\t\t\treturn\r\n\t\t}\r\n\r\n\t\tthis.setBusy();\r\n\t\treturn this.dispatch(() => {\r\n\t\t\treturn new Promise((resolve,reject)=>{\r\n\t\t\t\tif (! this.challenge()) {\r\n\t\t\t\t\tlog.debug('Provoking login challenge');\r\n\t\t\t\t\treturn this.provoke()\r\n\t\t\t\t\t\t.then(challenge => {\r\n\t\t\t\t\t\t\tlog.debug('Server issued a login challenge');\r\n\t\t\t\t\t\t\treturn remoteLogin(this, challenge).then(resolve).catch(reject);\r\n\t\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t\treturn remoteLogin(this, this.challenge()).then(resolve).catch(reject);\r\n\t\t\t}).then((results) => {log.debug('Login', username); return results;});\r\n\t\t\tlog.debug('Posting credentials to ', challenge.url);\r\n\t\t});\r\n\t}\r\n\r\n\tlogout() {\r\n\t\tlog.debug('logout', this.session.user);\r\n\t\treturn this.dispatch(() => {\r\n\t\t\tthis.setBusy();\r\n\t\t\tthis.cancel();\r\n\t\t\treturn this.fetch('/logout').catch().then(() => {\r\n\t\t\t\tthis.setDone();\r\n\t\t\t\tthis.dispatch(this.createAction(AuthApi.LOGGED_OUT)(NULL_SESSION));\r\n\t\t\t})\r\n\t\t});\r\n\t}\r\n\r\n\tregister(username, password, confirm) {\r\n\t\tif (username === undefined) {return this.register(this.registerDialog.username.value, this.registerDialog.password.value, this.registerDialog.confirm.value);}\r\n\r\n\t\tlog.log('register', username, password, confirm);\r\n\t\tthis.setBusy();\r\n\t\treturn this.dispatch(() => {\r\n\t\t\treturn new Promise((resolve,reject)=>{\r\n\t\t\t\tconst account = new Account(\r\n\t\t\t\t\tSuid.next(),\r\n\t\t\t\t\tusername,\r\n\t\t\t\t\t[new PasswordCredential(Suid.next(), password)]\r\n\t\t\t\t);\r\n\r\n\t\t\t\tlog.log('register: creating account', account);\r\n\t\t\t\treturn this.fetch('/accounts', {\r\n\t\t\t\t\tmethod: 'POST',\r\n\t\t\t\t\theaders: {\r\n\t\t\t\t\t\t'Content-Type': 'application/json',\r\n\t\t\t\t\t},\r\n\t\t\t\t\tbody: toJSON(account),\r\n\t\t\t\t})\r\n\t\t\t\t.then(response => response.text())\r\n\t\t\t\t.then(text => fromJSON(text))\r\n\t\t\t\t.then(account => {\r\n\t\t\t\t\tlog.log('register: created account', account);\r\n\t\t\t\t\tthis.login(username, password).then(result => {\r\n\t\t\t\t\t\tthis.setDone();\r\n\t\t\t\t\t\tresolve(result);\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.catch(error => {\r\n\t\t\t\t\t\tlog.error(error);\r\n\t\t\t\t\t\tthis.setError(error);\r\n\t\t\t\t\t})\r\n\t\t\t\t})\r\n\t\t\t\t.catch(error => {\r\n\t\t\t\t\tlog.error(error);\r\n\t\t\t\t\tthis.setError(error);\r\n\t\t\t\t})\r\n\t\t\t})\r\n\t\t\t.catch(error => {\r\n\t\t\t\tlog.error(error);\r\n\t\t\t\tthis.setError(error);\r\n\t\t\t})\r\n\t\t})\r\n\t}\r\n\r\n\tcancel() {\r\n\t\tlog.log('cancel');\r\n\t\treturn this.dispatch(() => {\r\n\t\t\tconst c = this.challenge();\r\n\t\t\tif (c) {\r\n\t\t\t\tconst error = Error('Login/registration cancelled');\r\n\t\t\t\tthis.setError(error);\r\n\t\t\t\tthis.dispatch(this.createAction(AuthApi.CANCEL)());\r\n\t\t\t\tif (c.reject) {c.reject(error);}\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tauthenticated() {\r\n\t\tlog.log('authenticated');\r\n\t\tconst auth = this;\r\n\t\treturn new Promise((resolve, reject) => {\r\n\t\t\tif (auth.loggedIn) {resolve(auth.session);}\r\n\t\t\telse auth.provoke(resolve, reject);\r\n\t\t});\r\n\t}\r\n\r\n\tprovoke(resolve, reject) {\r\n\t\tlog.log('provoke',resolve, reject);\r\n\t\t// provoke a login challenge, async\r\n\t\t// provoke a challenge by fetching url\r\n\t\treturn new Promise((accept, deny) => {\r\n\t\t\t// set up intermediate challenge to make accept and deny survive the round-trip\r\n\t\t\tthis.challenge({}, accept, deny);\r\n\t\t\t// this fetch will result in 401 and be intercepted, after which\r\n\t\t\t// challenge will be called again with the actual server challenge\r\n\t\t\tlog.debug('provoke: calling /challenge...');\r\n\t\t\tthis.fetch('/challenge')\r\n\t\t\t\t.then(response => {\r\n\t\t\t\t\tlog.debug('provoke: got response ', response);\r\n\t\t\t\t\tif (response && response.status == 200) {\r\n\t\t\t\t\t\treturn response.text();\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn response.text().then(text => {\r\n\t\t\t\t\t\tconst error = new Error(text);\r\n\t\t\t\t\t\terror.status = response.status;\r\n\t\t\t\t\t\terror.statusText = response.statusText;\r\n\t\t\t\t\t\tthrow error;\r\n\t\t\t\t\t});\r\n\t\t\t\t})\r\n\t\t\t\t.then(text => fromJSON(text))\r\n\t\t\t\t.then(session => processSession(this, session))\r\n\t\t\t\t.then(session => {\r\n\t\t\t\t\tlog.log('provoke: got session ', session);\r\n\t\t\t\t\tif (resolve) {\r\n\t\t\t\t\t\tlog.debug('provoke: calling resolve ', resolve);\r\n\t\t\t\t\t\tresolve(session);\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn session;\r\n\t\t\t\t})\r\n\t\t\t\t.catch(error => {\r\n\t\t\t\t\tlog.info('Provoking login challenge failed.', error);\r\n\t\t\t\t\tif (reject) {\r\n\t\t\t\t\t\tlog.debug('provoke: calling reject ', reject);\r\n\t\t\t\t\t\treject(error);\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t});\r\n\t}\r\n\r\n\tchallenge(challenge, resolve, reject) {\r\n\t\t// paramless invocation is sync\r\n\t\tif (!challenge) {return this.getState().challenge}\r\n\t\t// only accept challenges on the client side\r\n\t\tif (typeof window != 'object') {reject(new Error('Unauthorized'));}\r\n\r\n\t\tlog.info('challenge', challenge, resolve, reject);\r\n\r\n\t\t// reject any old login challenge\r\n\t\tconst c = this.getState().challenge;\r\n\t\tif (c && c.url) {\r\n\t\t\tlog.info('challenge: rejecting previous challenge...');\r\n\t\t\tc.reject(new Error(\"Login challenge cancelled\"));\r\n\t\t}\r\n\r\n\t\t// dispatch the challenge\r\n\t\tchallenge.resolve = resolve;\r\n\t\tchallenge.reject = reject;\r\n\t\tlog.info('dispatching challenge', challenge);\r\n\t\tthis.dispatch(this.createAction(AuthApi.CHALLENGE)(challenge));\r\n\r\n\t\t// If there is an old challenge which was a provocation, and new challenge is login challenge\r\n\t\tif (c && !c.url && c.resolve && challenge.url) {\r\n\t\t\t// if new challenge is login challenge (does have url), provocation is now resolved\r\n\t\t\tlog.info('challenge: resolving provocation...', c.resolve);\r\n\t\t\tc.resolve(challenge);\r\n\t\t}\r\n\t}\r\n\r\n\tis(role) {\r\n\t\tlog.debug('is', role);\r\n\t\tconst roles = this.session.user && this.session.user.roles || [];\r\n\t\treturn indexOf(roles, role) !== -1;\r\n\t}\r\n\r\n\tisAny(roles) {\r\n\t\tlog.debug('isAny');\r\n\t\tfor (let i=0, role; role=roles[i]; i++) {\r\n\t\t\tif (this.is(role)) {\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn false;\r\n\t}\r\n\r\n\tisAll(roles) {\r\n\t\tlog.debug('isAll');\r\n\t\tfor (let i=0, role; role=roles[i]; i++) {\r\n\t\t\tif (!this.is(role)) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn true;\r\n\t}\r\n}\r\nexport default AuthApi;\r\n\r\nexport function authenticated(target) {\r\n\tfunction enhance(target) {\r\n\t\tlog.debug('authenticated', target);\r\n\t\tObject.defineProperties(target.prototype, {\r\n\t\t\tauthenticated: {value:function() {\r\n\t\t\t\tlet p = this;\r\n\t\t\t\twhile (p = p.__parent) {\r\n\t\t\t\t\tif (p.authenticated) {\r\n\t\t\t\t\t\treturn p.authenticated();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\treturn Promise.reject(new Error('No authentication method'));\r\n\t\t\t}},\r\n\r\n\t\t\tgetSession: {value:function() {\r\n\t\t\t\tlet p = this;\r\n\t\t\t\twhile (p = p.__parent) {\r\n\t\t\t\t\tif (p.getSession) {\r\n\t\t\t\t\t\treturn p.getSession();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\treturn null;\r\n\t\t\t}},\r\n\r\n\t\t\tauth: {get: function() {\r\n\t\t\t\tlet p = this;\r\n\t\t\t\twhile (p = p.__parent) {\r\n\t\t\t\t\tif (p.auth) {\r\n\t\t\t\t\t\treturn p.auth;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}}\r\n\t\t});\r\n\t\tlog.trace('authenticated => ', target);\r\n\t\treturn target;\r\n\t}\r\n\treturn target ? enhance(target) : enhance;\r\n}\r\n\r\nfunction fetchSessionInfo(auth) {\r\n\tlog.debug('fetchSessionInfo');\r\n\treturn auth.fetch('/session')\r\n\t\t.then(response => {\r\n\t\t\tlog.debug('fetchSessionInfo => response.status=', response.status);\r\n\t\t\treturn response.status == 200 && response.text();\r\n\t\t})\r\n\t\t.then(text => {\r\n\t\t\tlog.log('fetchSessionInfo => text=', text);\r\n\t\t\treturn fromJSON(text);\r\n\t\t})\r\n\t\t.then(session => processSession(auth, session))\r\n}\r\n\r\nfunction processSession(auth, session) {\r\n\tlog.log('processSession', session);\r\n\tconst { user, sessionId } = session;\r\n\tlog.debug('processSession => sessionId=', sessionId);\r\n\tlog.debug('processSession => user=', user);\r\n\tif (typeof document == 'object') {\r\n\t\tconst maxAge = sessionId ? 10 * 24 * 60 * 60 : 0;\r\n\t\tdocument.cookie = `BASESSION=${sessionId}; Max-Age=${maxAge}; path=/`;\r\n\t\tlog.debug('processSession => cookie ' + (maxAge ? 'set' : 'cleared'));\r\n\t}\r\n\tif (user && !auth.loggedIn) {\r\n\t\tlog.debug('fetchSessionInfo => Dispatching LOGGED_IN action', session);\r\n\t\tauth.dispatch(auth.createAction(AuthApi.LOGGED_IN)(session));\r\n\t}\r\n\telse if (!user && auth.loggedIn) {\r\n\t\tlog.debug('fetchSessionInfo => Dispatching LOGGED_OUT action');\r\n\t\tauth.dispatch(auth.createAction(AuthApi.LOGGED_OUT)(session));\r\n\t}\r\n\treturn session;\r\n}\r\n\r\n\r\nfunction encode(challenge, username, password) {\r\n\tif (challenge.contentType === 'application/x-www-form-urlencoded') {\r\n\t\treturn urlEncode(challenge, username, password);\r\n\t}\r\n\telse {\r\n\t\terror = Error(`Unable to encode the given credentials. Unsupported content type '${challenge.contentType}'.`);\r\n\t}\r\n}\r\n\r\nfunction urlEncode(challenge, username, password) {\r\n\tconst uf = encodeURIComponent(challenge.usernameField);\r\n\tconst u = encodeURIComponent(username);\r\n\tconst pf = encodeURIComponent(challenge.passwordField);\r\n\tconst p = encodeURIComponent(password);\r\n\treturn `${uf}=${u}&${pf}=${p}`;\r\n}\n\n\n/** WEBPACK FOOTER **\n ** ./src/components/Auth/api.jsx\n **/","import log from 'picolog';\r\nimport React, { Component, PropTypes } from 'react';\r\nconst { bool, string, array, object, func, shape, any } = PropTypes;\r\nimport { Card, CardTitle, CardText, CardActions, Button } from 'react-mdl';\r\nimport classNames from 'classnames';\r\n\r\nimport { Modal, Textfield } from '../Mdl/mdl-extras';\r\nimport { fromJSON, toJSON, indexOf } from '../Entity/Entity';\r\nimport FilterFields from './FilterFields';\r\n\r\nexport class FilterPanel extends Component {\r\n\tstatic propTypes = {\r\n\t\topen: bool.isRequired,\r\n\t\tvalues: object.isRequired,\r\n\t\tfields: shape({\r\n\t\t\tq: shape({\r\n\t\t\t\tvalue: string,\r\n\t\t\t\tonChange: func,\r\n\t\t\t}).isRequired,\r\n\t\t}).isRequired,\r\n\t\tonApplyFields: func.isRequired,\r\n\t\tonSearch: func.isRequired,\r\n\t\tonCancel: func.isRequired,\r\n\t\tlocation: shape({\r\n\t\t\tpathname: string.isRequired,\r\n\t\t}).isRequired,\r\n\t}\r\n\r\n\tstatic contextTypes = {\r\n\t\trouter: object.isRequired,\r\n\t}\r\n\r\n\tconstructor(...args) {\r\n\t\tsuper(...args);\r\n\t}\r\n\r\n\tcomponentDidMount() {\r\n\t\tlog.debug('componentDidMount()');\r\n\t}\r\n\r\n\tsearchClicked(event) {\r\n\t\tconst { location, values, onApplyFields, onSearch, onCancel } = this.props;\r\n\t\tconst { router } = this.context;\r\n\t\tif (event) {event.preventDefault();}\r\n\t\tconst newValues = onApplyFields();\r\n\t\tonCancel();\r\n\t\tconst { pathname } = location;\r\n\t\tconst { category, ...query } = newValues;\r\n\t\trouter.push({pathname, query});\r\n\t}\r\n\r\n\trenderFilterFields() {\r\n\t\treturn <FilterFields {...this.props} />\r\n\t}\r\n\r\n\trender() {\r\n\t\tconst { open, fields, onCancel, className, children } = this.props;\r\n\t\tconst classes = classNames('FilterPanel', className, {'is-open': open});\r\n\t\tconst filterFields = this.renderFilterFields();\r\n\t\treturn (\r\n\t\t\t<Modal open={open} onCancel={onCancel}>\r\n\t\t\t\t<Card className={classes}>\r\n\t\t\t\t\t{open ? filterFields :undefined}\r\n\t\t\t\t\t<CardActions>\r\n\t\t\t\t\t\t<div className=\"FilterActions\">\r\n\t\t\t\t\t\t\t<Button colored raised onClick={this.searchClicked.bind(this)}>Search</Button>\r\n\t\t\t\t\t\t\t<Button onClick={onCancel}>Cancel</Button>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</CardActions>\r\n\t\t\t\t</Card>\r\n\t\t\t</Modal>\r\n\t\t)\r\n\t}\r\n}\r\nexport default FilterPanel;\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/components/Entity/FilterPanel.jsx\n **/","import log from 'picolog';\r\nimport Api from 'redux-apis';\r\n\r\nexport class TextfieldApi extends Api {\r\n\tstatic INITIAL_STATE = { value: '' };\r\n\r\n\tstatic SET_VALUE = 'SET_VALUE';\r\n\r\n\tconstructor(state = TextfieldApi.INITIAL_STATE) {\r\n\t\tsuper(state);\r\n\r\n\t\tthis.setHandler(TextfieldApi.SET_VALUE, (state, {payload}) => ({...state, value:payload}));\r\n\r\n\t\tObject.defineProperties(this, {\r\n\t\t\tvalue: {enumerable:true, get: () => this.getState().value},\r\n\t\t})\r\n\r\n\t\tthis.onChange = this.setValue.bind(this);\r\n\t}\r\n\r\n\tsetValue(value) {\r\n\t\treturn this.dispatch(this.createAction(TextfieldApi.SET_VALUE)(value === undefined ? '' : value));\r\n\t}\r\n}\r\n\r\nexport class DrawerApi extends Api {\r\n\tstatic INITIAL_STATE = { open: false };\r\n\r\n\tstatic OPEN = 'OPEN';\r\n\tstatic CLOSE = 'CLOSE';\r\n\r\n\tconstructor(state = DrawerApi.INITIAL_STATE) {\r\n\t\tsuper(state);\r\n\t\tthis.setHandler(DrawerApi.OPEN, (state, action) => ({...state, open:true}));\r\n\t\tthis.setHandler(DrawerApi.CLOSE, (state, action) => ({...state, open:false}));\r\n\t\tObject.defineProperties(this, {\r\n\t\t\topen: {enumerable:true, get:() => this.getState().open},\r\n\t\t})\r\n\t\tthis.onCancel = this.closeDrawer.bind(this);\r\n\t\tthis.onActivate = this.openDrawer.bind(this);\r\n\t}\r\n\r\n\topenDrawer() {\r\n\t\tlog.debug('openDrawer');\r\n\t\treturn this.dispatch(this.createAction(DrawerApi.OPEN)());\r\n\t}\r\n\r\n\tcloseDrawer() {\r\n\t\tlog.debug('closeDrawer');\r\n\t\treturn this.dispatch(this.createAction(DrawerApi.CLOSE)());\r\n\t}\r\n}\r\n\r\nexport class LightboxApi extends Api {\r\n\tstatic INITIAL_STATE = {open:false, images:[], index:0};\r\n\r\n\tstatic OPEN = 'OPEN';\r\n\tstatic NEXT = 'NEXT';\r\n\tstatic PREV = 'PREV';\r\n\tstatic NAV = 'NAV';\r\n\tstatic CANCEL = 'CANCEL';\r\n\r\n\tconstructor(state = LightboxApi.INITIAL_STATE) {\r\n\t\tsuper(state);\r\n\t\tthis.setHandler(LightboxApi.OPEN, (state, { payload:{images, index } }) => ({ ...state, open:true, images, index }));\r\n\t\tthis.setHandler(LightboxApi.NEXT, ({ images, index, ...state }) => ({ ...state, images, index: index < images.length - 1 ? index + 1 : index }));\r\n\t\tthis.setHandler(LightboxApi.PREV, ({ index, ...state }) => ({ ...state, index: index > 0 ? index - 1 : index }));\r\n\t\tthis.setHandler(LightboxApi.NAV, ({ index, ...state }, {payload}) => ({ ...state, index:payload }));\r\n\t\tthis.setHandler(LightboxApi.CANCEL, (state, action) => ({ ...state, open:false, images:[], index:0 }));\r\n\t\tObject.defineProperties(this, {\r\n\t\t\topen: {enumerable:true, get:() => this.getState() && this.getState().open},\r\n\t\t\tindex: {enumerable:true, get:() => this.getState() && this.getState().index},\r\n\t\t\timages: {enumerable:true, get:() => this.getState() && this.getState().images},\r\n\t\t\tonOpenLightbox: {enumerable:true, value:this.openLightbox.bind(this)},\r\n\t\t\tonCancel: {enumerable:true, value:this.cancel.bind(this)},\r\n\t\t\tonNext: {enumerable:true, value:this.next.bind(this)},\r\n\t\t\tonPrev: {enumerable:true, value:this.prev.bind(this)},\r\n\t\t\tonNav: {enumerable:true, value:this.nav.bind(this)}\r\n\t\t})\r\n\t}\r\n\r\n\topenLightbox(images = [], index = 0) {\r\n\t\tlog.log('openLightbox', images, index);\r\n\t\treturn this.dispatch(this.createAction(LightboxApi.OPEN)({images, index}));\r\n\t}\r\n\r\n\tnext() {\r\n\t\tlog.log('next');\r\n\t\tthis.dispatch(this.createAction(LightboxApi.NEXT)());\r\n\t}\r\n\r\n\tprev() {\r\n\t\tlog.log('prev');\r\n\t\tthis.dispatch(this.createAction(LightboxApi.PREV)());\r\n\t}\r\n\r\n\tnav(idx) {\r\n\t\tlog.log('nav', idx);\r\n\t\tthis.dispatch(this.createAction(LightboxApi.NAV)(idx));\r\n\t}\r\n\r\n\tcancel() {\r\n\t\tlog.log('cancel');\r\n\t\tthis.dispatch(this.createAction(LightboxApi.CANCEL)());\r\n\t}\r\n}\r\n\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/components/Mdl/api.jsx\n **/","import log from 'picolog';\r\nimport React, { Component, PropTypes } from 'react';\r\nconst { object, func } = PropTypes;\r\n\r\nexport class Publication extends Component {\r\n\tstatic propTypes = {\r\n\t\tonMayPublish: func.isRequired,\r\n\t\tonPublish: func.isRequired,\r\n\t\tonUnpublish: func.isRequired,\r\n\t};\r\n\r\n\tconstructor(...props) {\r\n\t\tsuper(...props);\r\n\t}\r\n\r\n\tmayPublish(item) {\r\n\t\treturn this.props.onMayPublish(item)\r\n\t}\r\n\r\n\tpublishClicked(item, event) {\r\n\t\tlog.log('publishClicked', item, event);\r\n\t\tevent.preventDefault();\r\n\t\treturn this.props.onPublish(item);\r\n\t}\r\n\r\n\tunpublishClicked(item, event) {\r\n\t\tlog.log('unpublishClicked', item, event);\r\n\t\tevent.preventDefault();\r\n\t\treturn this.props.onUnpublish(item);\r\n\t}\r\n}\r\nexport default Publication;\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/components/Publication/Publication.jsx\n **/","import log from 'picolog';\r\nimport { link } from 'redux-apis';\r\nimport { remote } from 'redux-fetch-api';\r\n\r\nimport { fromJSON, indexOf } from '../Entity/Entity';\r\nimport { EntityApi } from '../Entity/api';\r\nimport { authenticated } from '../Auth/api';\r\nimport Role from '../Auth/Role';\r\n\r\n@remote\r\n@authenticated\r\nexport class PublicationApi extends EntityApi {\r\n\tstatic INITIAL_STATE = {\r\n\t\t...EntityApi.INITIAL_STATE,\r\n\t}\r\n\r\n\tconstructor(state = PublicationApi.INITIAL_STATE) {\r\n\t\tsuper(state);\r\n\t\tthis.item.onMayPublish = this.mayPublish.bind(this);\r\n\t\tthis.item.onPublish = this.publish.bind(this);\r\n\t\tthis.item.onUnpublish = this.unpublish.bind(this);\r\n\t}\r\n\r\n\tmayPublish(item) {\r\n\t\tlog.trace('mayPublish', item, this, this.getSession);\r\n\t\tif (this.getSession().user) {\r\n\t\t\tfor (let i=0, role; role=this.getSession().user.roles[i]; i++) {\r\n\t\t\t\tif (role.equals(Role.BRAUTSCHLOSS_USER) ||\r\n\t\t\t\t\trole.equals(Role.BRAUTSCHLOSS_MANAGER) ||\r\n\t\t\t\t\trole.equals(Role.ADMINISTRATOR)) {\r\n\t\t\t\t\tlog.trace('mayPublish => true');\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tlog.trace('mayPublish => false');\r\n\t\treturn false;\r\n\t}\r\n\r\n\tsetPublished(item, published) {\r\n\t\tlog.debug('setPublished', item, published);\r\n\t\tconst newItem = item.clone();\r\n\t\tnewItem.published = published;\r\n\t\treturn this.save(newItem)\r\n\t\t\t.then(saved => {\r\n\t\t\t\tlog.debug('saved successfully', saved);\r\n\t\t\t\tconst newItems = [ ...this.items ];\r\n\t\t\t\tconst idx = indexOf(newItems, item);\r\n\t\t\t\tnewItems[idx] = saved;\r\n\t\t\t\tthis.setItems(newItems);\r\n\t\t\t\treturn saved;\r\n\t\t\t})\r\n\t\t\t.catch(error => {\r\n\t\t\t\tlog.error('Unable to change published status for item ' + item + '.', error);\r\n\t\t\t});\r\n\t}\r\n\r\n\tpublish(item) {\r\n\t\tlog.log('publish', item);\r\n\t\treturn this.setPublished(item, true);\r\n\t}\r\n\r\n\tunpublish(item) {\r\n\t\tlog.log('unpublish', item);\r\n\t\treturn this.setPublished(item, false);\r\n\t}\r\n}\r\nexport default PublicationApi;\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/components/Publication/api.jsx\n **/","import log from 'picolog';\r\nimport React from 'react';\r\nimport ReactDOM from 'react-dom';\r\n\r\nexport default class Scroller extends React.Component {\r\n\tstatic propTypes = {\r\n\t\t/**\r\n\t\t * The direction to scroll in, either 'vertical' or 'horizontal'.\r\n\t\t * Defaults to 'vertical'.\r\n\t\t */\r\n//\t\tdirection: React.PropTypes.oneOf(['vertical','horizontal']),\r\n\r\n\t\t/**\r\n\t\t * The items to be scrolled over.\r\n\t\t * Defaults to `{0:[]}`.\r\n\t\t *\r\n\t\t * An object mapping page indexes to arrays of items for those pages\r\n\t\t * that will be used as the initial data to load into the page buffer.\r\n\t\t * When paging is not used or only a single page is provided as initial\r\n\t\t * data, one can supply an array as shorthand for assigning an object\r\n\t\t * with only page 0 set:\r\n\t\t *\r\n\t\t * items = {[{..}, {..}, ..]}\r\n\t\t *\r\n\t\t * is equivalent to\r\n\t\t *\r\n\t\t * items = {{0: [{..}, {..}, ..]}}\r\n\t\t */\r\n\t\titems: React.PropTypes.oneOfType([\r\n\t\t\tReact.PropTypes.object,\r\n\t\t\tReact.PropTypes.array,\r\n\t\t]),\r\n\r\n\t\t/**\r\n\t\t * Default size of an item in the scroll direction, in pixels.\r\n\t\t * Defaults to 300.\r\n\t\t *\r\n\t\t * For a vertical scroller, set this to the height of each\r\n\t\t * item, for a horizontal scroller, the screen width is used.\r\n\t\t */\r\n\t\titemSize: React.PropTypes.number.isRequired,\r\n\r\n\t\t/**\r\n\t\t * Number of items to be rendered initially, before the component\r\n\t\t * is mounted.\r\n\t\t * Defaults to 12.\r\n\t\t *\r\n\t\t * This will determine how many items are rendered\r\n\t\t * during server-side rendering and hence how many items googlebot\r\n\t\t * will see when visiting the page.\r\n\t\t */\r\n\t\tinitialItemsInView: React.PropTypes.number,\r\n\r\n\t\t/**\r\n\t\t * Number of items shown per row/column.\r\n\t\t * Defaults to 1.\r\n\t\t *\r\n\t\t * For a vertical scroller, set this if there are multiple items per row,\r\n\t\t * for a horizontal scroller, if there are multiple items per column. You\r\n\t\t * must ensure that this setting corresponds with the actual situation.\r\n\t\t * If this setting differs from what is really happening, the scroll\r\n\t\t * calculations will be off and the behavior will break down.\r\n\t\t */\r\n//\t\titemsPer: React.PropTypes.number,\r\n\r\n\t\t/**\r\n\t\t * Size of buffer before the first visible item, defaults to 1.\r\n\t\t * Enables smoother scrolling by pre-rendering some items into a buffer area\r\n\t\t * just outside the visible viewport, causing images to be pre-loaded.\r\n\t\t * The number of items rendered before the first visible item will be\r\n\t\t * the value of this property, multiplied by `itemsPer`.\r\n\t\t */\r\n\t\tbufferBefore: React.PropTypes.number,\r\n\r\n\t\t/**\r\n\t\t * Size of buffer after the last visible item, defaults to 1.\r\n\t\t * Enables smoother scrolling by pre-rendering some items into a buffer area\r\n\t\t * just outside the visible viewport, causing images to be pre-loaded.\r\n\t\t * The number of items rendered after the last visible item will be\r\n\t\t * the value of this property, multiplied by `itemsPer`.\r\n\t\t */\r\n\t\tbufferAfter: React.PropTypes.number,\r\n\r\n\t\t/**\r\n\t\t * Whether to snap items to grid when scrolling comes to an end.\r\n\t\t *\r\n\t\t * NOT IMPLEMENTED YET. IMPLEMENTATION SHOULD BE BASED ON CSS Scroll Snap Points\r\n\t\t * http://www.w3.org/TR/css-snappoints-1/\r\n\t\t * Backed by a polyfill for non-compliant browsers (many still unfortunately)\r\n\t\t *\r\n\t\t * Reason: We want fluid native scrolling on iPhone.\r\n\t\t */\r\n\t\tsnap: React.PropTypes.bool,\r\n\r\n\t\t/**\r\n\t\t * Render function accepting an item and it's index and returning\r\n\t\t * the markup for that item. This function should accept empty\r\n\t\t * objects for it's item parameter and return valid markup either way.\r\n\t\t */\r\n\t\trenderItem: React.PropTypes.func.isRequired, // function(item, index)\r\n\r\n\t\t/**\r\n\t\t * Function accepting an item and it's index and returning\r\n\t\t * an identifying key for that item. The key is used for technical\r\n\t\t * purposes. This function should accept null for it's item parameter\r\n\t\t * and return a valid key either way. If this function is not provided,\r\n\t\t * the key will default to `'item' + index`.\r\n\t\t */\r\n\t\tkeyForItem: React.PropTypes.func, // function(item, index)\r\n\r\n\t\t/**\r\n\t\t * Function accepting an item and it's index and returning\r\n\t\t * an identifying slug for that item. The slug is used for\r\n\t\t * bookmarking etc, so should preferably be human-friendly.\r\n\t\t * This function should accept null for it's item parameter\r\n\t\t * and return a valid slug either way. If this function is\r\n\t\t * not provided, the slug will default to `'item' + index`.\r\n\t\t */\r\n\t\tslugForItem: React.PropTypes.func, // function(item, index)\r\n\r\n\t\t/**\r\n\t\t * Time, in ms, to capture scroll events before processing them.\r\n\t\t * Defaults to 10.\r\n\t\t */\r\n\t\tscrollDebounce: React.PropTypes.number,\r\n\r\n\r\n\t\t/* PROPERTIES RELATED TO PAGING */\r\n\r\n\t\t/**\r\n\t\t * Total number of items available in the virtual scroller.\r\n\t\t * Defaults to `items[0].length`;\r\n\t\t *\r\n\t\t * When paging is enabled, set this to the total number of\r\n\t\t * items in the resultset. E.g. for a query with 9,287 results,\r\n\t\t * set this to 9287.\r\n\t\t */\r\n\t\titemCount: React.PropTypes.number,\r\n\r\n\t\t/**\r\n\t\t * The number of items per page.\r\n\t\t * Defaults to `items[0].length` (just one page with all items).\r\n\t\t *\r\n\t\t * When paging is enabled, set this to the number of items per\r\n\t\t * page. It will be used i.c.w. `itemCount` to determine the\r\n\t\t * number of pages in the resultset. You can supply more than\r\n\t\t * one page of data initially by setting `items` to an object\r\n\t\t * with the data for multiple pages.\r\n\t\t */\r\n\t\tpageSize: React.PropTypes.number,\r\n\r\n\t\t/**\r\n\t\t * The number of pages to buffer.\r\n\t\t * Defaults to 5 when `pageSize` is set, otherwise to 1.\r\n\t\t *\r\n\t\t * When the user scrolls to pages that are not in the buffer,\r\n\t\t * `pageFetch` will be called and it's results will be added\r\n\t\t * to the buffer. When the number of pages exceeds the number\r\n\t\t * of pages specified by this setting, those pages furthest\r\n\t\t * away from the user's current scroll position will be removed\r\n\t\t * from the buffer until this number is no longer exceeded.\r\n\t\t */\r\n\t\tpageBufferSize: React.PropTypes.number,\r\n\r\n\t\t/**\r\n\t\t * Function that fetches a page of results.\r\n\t\t *\r\n\t\t * When paging is enabled, the scroller will call `pageFetch`,\r\n\t\t * passing it the index of the page to fetch, whenever it needs\r\n\t\t * the data for a certain page but does not have it. This function\r\n\t\t * should return a Promise that yields an array with the results\r\n\t\t * for the given page index.\r\n\t\t *\r\n\t\t * The scroller will call `renderLoadingItem` when it needs to\r\n\t\t * render results from a page that has not been fetched yet.\r\n\t\t */\r\n\t\tpageFetch: React.PropTypes.func, // function(pageIndex)\r\n\r\n\t\t/**\r\n\t\t * Render function accepting an item index and returning markup\r\n\t\t * indicating that the item is still loading.\r\n\t\t *\r\n\t\t * This function is called when paging is enabled and the item to\r\n\t\t * be rendered is not (yet) available. If this function is not\r\n\t\t * provided, the system will fall back to calling `renderItem`\r\n\t\t * and providing an empty object as item parameter.\r\n\t\t */\r\n\t\trenderLoadingItem: React.PropTypes.func, // function(index)\r\n\t};\r\n\r\n\tstatic defaultProps = {\r\n\t\titems: {0: []},\r\n\t\titemSize: 560,\r\n\t\tinitialItemsInView: 20,\r\n//\t\titemsPer: 1,\r\n\t\tbufferBefore: 1,\r\n\t\tbufferAfter: 1,\r\n\t\tscrollDebounce: 100,\r\n//\t\tdirection: 'vertical',\r\n\t\tsnap: false,\r\n\t};\r\n\r\n\tconstructor(...args) {\r\n\t\tlog.debug('Scroller', ...args);\r\n\t\tsuper(...args);\r\n\t\tconst { items, itemSize, initialItemsInView, bufferBefore, bufferAfter } = this.props;\r\n\t\tconst itemsInView = Math.min(initialItemsInView, items.length);\r\n\t\tconst renderedItems = items.slice(0, itemsInView);\r\n\t\tconst sizeItems = itemsInView * itemSize;\r\n\t\tthis.state = {\r\n\t\t\thorizontal: false,\r\n\t\t\trenderedItems,\r\n\t\t\tsizeBefore: 0,\r\n\t\t\tsizeItems,\r\n\t\t\tsizeAfter: (items.length - itemsInView) * itemSize,\r\n\t\t\titemSize,\r\n\t\t\tfirstRenderedItemIndex: 0,\r\n\t\t\tlastRenderedItemIndex: itemsInView - 1,\r\n\t\t\tsize: sizeItems,\r\n\t\t};\r\n\r\n\t\tthis.onScroll = this.onScroll.bind(this);\r\n\t}\r\n\r\n\tgetState(props) {\r\n\t\t// let dir = props.direction;\r\n\t\tconst win = typeof window == 'object' && window;\r\n\t\tconst w = win && window.innerWidth || 767;\r\n\t\tconst horizontal = win && w < 480;\r\n\t\tconst scroller = this.mounted ? ReactDOM.findDOMNode(this) : undefined;\r\n\t\tconst scrollPos = scroller ? getScrollPos(horizontal, scroller) : 0;\r\n\r\n\t\tconst { items, bufferBefore, bufferAfter } = props;\r\n\t\tconst itemSize = horizontal ? w : props.itemSize;\r\n\t\tconst itemsPer = !win ? 1 : (w > 1024 ? 3 : (w > 767 ? 2 : 1));\r\n\t\tconst containerCount = ~~(items.length / itemsPer) + (~~(items.length % itemsPer) ? 1 : 0);\r\n\r\n\t\tconst scrollerSize = scroller ? getSize(horizontal, scroller) : Math.min(initialItemsInView, containerCount) * itemSize;\r\n\t\tconst slider = this.refs.slider;\r\n\t\tconst sliderOffset = scroller ? posDifference(horizontal, slider, scroller) : 0;\r\n\r\n\t\tconst renderedItems = [];\r\n\r\n\t\tconst containersBefore = ~~(scrollPos / itemSize);\r\n\t\tconst bufBefore = Math.min(containersBefore, bufferBefore);\r\n\t\tconst skippedContainers = containersBefore - bufBefore;\r\n\t\tconst skippedItems = skippedContainers * itemsPer;\r\n\t\tconst firstIdx = skippedItems;\r\n\t\tconst containersInView = ~~(scrollerSize / itemSize) + (~~(scrollerSize % itemSize) ? 2 : 1)\r\n\t\tconst lastIdx = Math.min(firstIdx + containersInView * itemsPer + bufferAfter * itemsPer, items.length - 1);\r\n\t\tfor (let i=firstIdx; i<=lastIdx; i++) {\r\n\t\t\tconst item = items[i] || null;\r\n\t\t\trenderedItems.push(item);\r\n\t\t}\r\n\t\tconst renderedContainerCount = ~~(renderedItems.length / itemsPer) + (~~(renderedItems.length % itemsPer) ? 1 : 0);\r\n\t\tconst sizeBefore = ~~(firstIdx / itemsPer) * itemSize;\r\n\t\tconst sizeItems = renderedContainerCount * itemSize;\r\n\t\tconst sizeAfter = containerCount * itemSize - sizeBefore - sizeItems;\r\n\r\n\t\treturn {\r\n\t\t\thorizontal,\r\n\t\t\trenderedItems,\r\n\t\t\tsizeBefore,\r\n\t\t\tsizeItems,\r\n\t\t\tsizeAfter,\r\n\t\t\titemSize,\r\n\t\t\t// scrollPos,\r\n\t\t\tfirstRenderedItemIndex: firstIdx,\r\n\t\t\tlastRenderedItemIndex: lastIdx,\r\n\t\t\tsize: scrollerSize,\r\n\t\t};\r\n\t}\r\n\r\n\tshouldComponentUpdate(nextProps, nextState) {\r\n\t\tlog.debug('shouldComponentUpdate', nextProps, nextState);\r\n\t\tif (this.state.size !== nextState.size) return true;\r\n\t\tif (this.state.sizeBefore !== nextState.sizeBefore) return true;\r\n\t\tif (this.state.sizeAfter !== nextState.sizeAfter) return true;\r\n\t\tif (this.props.items !== nextProps.items) return true;\r\n\t\tif (this.props.state !== nextProps.state) return true;\r\n\t\tif (this.props.items.length !== nextProps.items.length) return true;\r\n\t\tif (!arraysEqual(this.state.renderedItems, nextState.renderedItems)) return true;\r\n\t\tif (!arraysEqual(this.props.items, nextProps.items)) return true;\r\n\t\treturn false;\r\n\t}\r\n\r\n\tcomponentWillReceiveProps(nextProps) {\r\n\t\tlog.debug('componentWillReceiveProps', nextProps);\r\n\t\tthis.setState(this.getState(nextProps));\r\n\t}\r\n\r\n\tcomponentDidMount() {\r\n\t\tlog.debug('componentDidMount');\r\n\t\tthis.mounted = true;\r\n\t\tthis.onScrollDebounced = window.innerWidth < 480\r\n\t\t\t? debounce(this.onScroll, this.props.scrollDebounce, false)\r\n\t\t\t: this.onScroll;\r\n\t\tthis.setState(this.getState(this.props));\r\n\t\tReactDOM.findDOMNode(this).addEventListener('scroll', this.onScrollDebounced);\r\n\t}\r\n\r\n\tcomponentWillUnmount() {\r\n\t\tlog.debug('componentWillUnmount');\r\n\t\tReactDOM.findDOMNode(this).removeEventListener('scroll', this.onScrollDebounced);\r\n\t\tthis.mounted = false;\r\n\t}\r\n\r\n\tonScroll() {\r\n\t\tlog.trace('onscroll');\r\n\t\tthis.setState(this.getState(this.props));\r\n\t}\r\n\r\n\trender() {\r\n\t\tlog.debug('render', this.props, this.state);\r\n\t\tlet slider={}, before={}, after={}, itm={};\r\n\t\tconst dim = (this.state.horizontal ? 'width' : 'height');\r\n\t\tslider[dim] = this.state.sizeBefore + this.state.sizeItems + this.state.sizeAfter;\r\n\t\tbefore[dim] = this.state.sizeBefore;\r\n\t\titm[dim] = this.state.itemSize;\r\n\t\tafter[dim] = this.state.sizeAfter;\r\n\t\treturn (\r\n\t\t\t<div className=\"Scroller\">\r\n\t\t\t\t<div className=\"ScrollSlider\" ref=\"slider\" style={slider}\r\n\t\t\t\t\t><div className=\"ScrollSpacer ScrollSpacerBefore\" ref=\"spacerBefore\" style={before}></div\r\n\t\t\t\t\t>{this.state.renderedItems.map((item, idx) => {\r\n\t\t\t\t\t\tidx = idx + this.state.firstRenderedItemIndex;\r\n\t\t\t\t\t\tconst key = this.props.keyForItem ? this.props.keyForItem(item, idx) : 'item' + idx;\r\n\t\t\t\t\t\tlet { renderItem } = this.props;\r\n\t\t\t\t\t\tif (item === null) {\r\n\t\t\t\t\t\t\tif (this.props.renderLoadingItem) {renderItem = this.props.renderLoadingItem;}\r\n\t\t\t\t\t\t\telse {item = {};}\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t// style={itm}\r\n\t\t\t\t\t\treturn(\r\n\t\t\t\t\t\t\t<div className=\"ScrollItem\" key={key} style={itm}>{\r\n\t\t\t\t\t\t\t\trenderItem(item, idx)\r\n\t\t\t\t\t\t\t}</div>\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t})}<div className=\"ScrollSpacer ScrollSpacerAfter\" ref=\"spacerAfter\" style={after}></div\r\n\t\t\t\t></div\r\n\t\t\t></div>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nfunction arraysEqual(a, b) {\r\n\tif (!a || !b) return false;\r\n\tif (a.length != b.length) return false;\r\n\tfor (var i = 0, length = a.length; i < length; i++) {\r\n\t\tif (a[i] != b[i]) return false;\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction posFromWindow(horizontal, element) {\r\n\tconst dir = horizontal ? 'Left' : 'Top';\r\n\tif (!element || element === window) return 0;\r\n\treturn element['offset' + dir] + posFromWindow(horizontal, element.offsetParent);\r\n}\r\n\r\nfunction posDifference(horizontal, element, container) {\r\n\treturn posFromWindow(horizontal, element) - posFromWindow(horizontal, container);\r\n}\r\n\r\nfunction getSize(horizontal, element) {\r\n\tconst dir = horizontal ? 'Width' : 'Height';\r\n\treturn typeof element['inner' + dir] != 'undefined' ? element['inner' + dir] : element['client' + dir];\r\n}\r\n\r\nfunction getScrollPos(horizontal, element) {\r\n\tlet res;\r\n\tconst { axis, dir } = horizontal ? {axis:'X', dir:'Left'} : {axis:'Y', dir:'Top'};\r\n\tif (element === window) {\r\n\t\tres = window['page' + axis + 'Offset'];\r\n\t\tif (res == null) res = document.documentElement['scroll' + dir];\r\n\t\tif (res == null) res = document.body['scroll' + dir];\r\n\t}\r\n\telse {\r\n\t\tres = element['scroll' + axis];\r\n\t\tif (res == null) res = element['scroll' + dir];\r\n\t}\r\n\treturn (res == null) ? 0 : res;\r\n}\r\n\r\nfunction debounce(func, wait, immediate) {\r\n\tif (!wait) return func;\r\n\tvar timeout;\r\n\treturn function() {\r\n\t\tvar context = this, args = arguments;\r\n\t\tvar later = function() {\r\n\t\t\ttimeout = null;\r\n\r\n\t\t\tif (!immediate) func.apply(context, args);\r\n\t\t};\r\n\t\tvar callNow = immediate && !timeout;\r\n\t\tclearTimeout(timeout);\r\n\t\ttimeout = setTimeout(later, wait);\r\n\t\tif (callNow) func.apply(context, args);\r\n\t};\r\n}\n\n\n/** WEBPACK FOOTER **\n ** ./src/components/Scroller/Scroller.jsx\n **/","import log from 'picolog';\r\nimport React, { Component, PropTypes } from 'react';\r\nconst { bool, number, string, object, func, array, shape, any } = PropTypes;\r\nimport { connect } from 'react-redux';\r\nimport { Link } from 'react-router';\r\nimport { Layout, Header, Navigation, Content, Button, Icon } from 'react-mdl';\r\n\r\nimport { LayoutTitle, Drawer, Sprite, Lightbox } from '../Mdl/mdl-extras';\r\nimport SessionPanel from '../Auth/SessionPanel';\r\nimport AuthDialog from '../Auth/AuthDialog';\r\nimport store from '../../store';\r\nimport AppApi from './api';\r\n\r\n@connect(bridalapp.connector)\r\nexport class App extends Component {\r\n\tstatic propTypes = {\r\n\t\tauth: shape({\r\n\t\t\tloggedIn: bool.isRequired,\r\n\t\t\tchallenged: bool.isRequired,\r\n\t\t\tonProvoke: func,\r\n\t\t\tonLogin: func,\r\n\t\t\tonLogout: func,\r\n\t\t\tonRegister: func,\r\n\t\t\tonCancel: func,\r\n\t\t\tuser: shape({\r\n\t\t\t\tid: any.isRequired,\r\n\t\t\t\tname: string.isRequired,\r\n\t\t\t}),\r\n\t\t}).isRequired,\r\n\t\tstores: shape({\r\n\t\t\tmanagedStore: shape({\r\n\t\t\t\tid: any.isRequired,\r\n\t\t\t\tname: string.isRequired,\r\n\t\t\t\tcity: string.isRequired,\r\n\t\t\t}),\r\n\t\t}).isRequired,\r\n\t\tbrands: shape({\r\n\t\t\tmanagedBrand: shape({\r\n\t\t\t\tid: any.isRequired,\r\n\t\t\t\tname: string.isRequired,\r\n\t\t\t}),\r\n\t\t}).isRequired,\r\n\t\tleftDrawer: object,\r\n\t\trightDrawer: object,\r\n\t\tlightbox: object,\r\n\t\tappbarComponent: any,\r\n\t\tmainComponent: any,\r\n\t};\r\n\r\n\tstatic childContextTypes = {\r\n\t\tlightbox: shape({\r\n\t\t\tonOpenLightbox: func.isRequired,\r\n\t\t}).isRequired,\r\n\t}\r\n\r\n\tgetChildContext() {\r\n\t\treturn { lightbox: bridalapp.lightbox };\r\n\t}\r\n\r\n\trender() {\r\n\t\tlog.debug('render', this.props);\r\n\t\tconst { auth, stores:{managedStore}, brands:{managedBrand}, leftDrawer, rightDrawer, lightbox, className, appbarComponent, mainComponent } = this.props;\r\n\t\tlog.log('render: appbarComponent=', appbarComponent);\r\n\r\n\t\tconst logo = 'https://cdn.rawgit.com/download/bridalapp-static/1.0.0/bridalapp/logo-bridalapp.png';\r\n\t\treturn (\r\n\t\t\t<div className=\"mdl-layout mdl-layout--fixed-header\">\r\n\t\t\t\t<div className=\"mdl-layout__inner-container\">\r\n\r\n\t\t\t\t\t<header className=\"AppBar mdl-layout__header is-casting-shadow\">\r\n\t\t\t\t\t\t<div tabIndex=\"0\" className=\"mdl-layout__drawer-button\" onClick={leftDrawer.onActivate}><Icon name=\"menu\" /></div>\r\n\t\t\t\t\t\t<div className=\"mdl-layout__header-row\">\r\n\t\t\t\t\t\t\t<img className=\"logo\" src=\"https://cdn.rawgit.com/download/bridalapp-static/1.0.0/bridalapp/logo-bridalapp.png\" />\r\n\t\t\t\t\t\t\t<div className=\"mdl-layout-spacer\"></div>\r\n\t\t\t\t\t\t\t<Navigation className=\"ContextActions\">{appbarComponent}</Navigation>\r\n\t\t\t\t\t\t\t<Navigation className=\"RightDrawer\"><Icon name=\"account_circle\" onClick={rightDrawer.onActivate} /></Navigation>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</header>\r\n\r\n\t\t\t\t\t<Drawer\tmodal autoClose {...leftDrawer}>\r\n\t\t\t\t\t\t<LayoutTitle><img className=\"logo\" src={logo} alt=\"BridalApp\" /></LayoutTitle>\r\n\t\t\t\t\t\t<Navigation>\r\n\t\t\t\t\t\t\t<Link to=\"/Wedding+Dresses\"><Sprite name=\"bridal-dress\" /> Wedding Dresses</Link>\r\n\t\t\t\t\t\t\t<Link to=\"/stores\"><Icon name=\"store\" /> Bridal Stores</Link>\r\n\t\t\t\t\t\t\t<Link to=\"/brands\"><Icon name=\"content_cut\" /> Bridal Brands</Link>\r\n\t\t\t\t\t\t</Navigation>\r\n\t\t\t\t\t</Drawer>\r\n\r\n\t\t\t\t\t<Drawer right modal autoClose {...rightDrawer}>\r\n\t\t\t\t\t\t<LayoutTitle><SessionPanel {...auth} /></LayoutTitle>\r\n\t\t\t\t\t\t{managedStore || managedBrand ? <Navigation>\r\n\t\t\t\t\t\t\t{managedStore ? <Link to={`/store/${managedStore.city}/${managedStore.name}`}><Icon name=\"store\" /> {managedStore.name}</Link> : <i/>}\r\n\t\t\t\t\t\t\t{managedBrand ? <Link to={`/brand/${managedBrand.name}`}><Icon name=\"content_cut\" /> {managedBrand.name}</Link> : <i/>}\r\n\t\t\t\t\t\t</Navigation> : ''}\r\n\t\t\t\t\t\t{auth.loggedIn ? <Navigation>\r\n\t\t\t\t\t\t\t<Link to=\"/loved/Wedding+Dresses\"><Icon name=\"favorite\" /> My Favorites</Link>\r\n\t\t\t\t\t\t</Navigation> : ''}\r\n\t\t\t\t\t</Drawer>\r\n\r\n\t\t\t\t\t<Content className=\"main\">{mainComponent}</Content>\r\n\r\n\t\t\t\t\t<AuthDialog {...auth} />\r\n\t\t\t\t\t<Lightbox noNextOnClick noImageCount {...lightbox} />\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t)\r\n\t}\r\n}\r\n\r\nexport default App;\n\n\n/** WEBPACK FOOTER **\n ** ./src/components/App/App.jsx\n **/","import Entity from '../Entity/Entity';\r\nimport Role from './Role';\r\nimport Group from './Group';\r\nimport PasswordCredential from './PasswordCredential';\r\n\r\nimport Suid from 'ws.suid';\r\n\r\n@Entity\r\nexport class Account {\r\n\tconstructor(id, name, credentials=[], roles=[Role.USER], groups=[]) {\r\n\t\tthis.id = id || 0;\r\n\t\tthis.version = null;\r\n\t\tthis.name = name;\r\n\t\tthis.credentials = credentials;\r\n\t\tthis.roles = roles;\r\n\t\tthis.groups = groups;\r\n\t}\r\n}\r\nexport default Account;\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/components/Auth/Account.jsx\n **/","import Entity from '../Entity/Entity';\r\n\r\n@Entity\r\nexport class Group {\r\n\tconstructor(id, name) {\r\n\t\tthis.id = id;\r\n\t\tthis.name = name;\r\n\t}\r\n}\r\nexport default Group;\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/components/Auth/Group.jsx\n **/","import Entity from '../Entity/Entity';\r\nimport Credential from './Credential';\r\n\r\n@Entity\r\nexport class PasswordCredential extends Credential {\r\n\tconstructor(id, password) {\r\n\t\tsuper(id)\r\n\t\tthis.password = password;\r\n\t}\r\n}\r\nexport default PasswordCredential;\n\n\n/** WEBPACK FOOTER **\n ** ./src/components/Auth/PasswordCredential.jsx\n **/","import Entity from '../Entity/Entity';\r\n\r\nimport Suid from 'ws.suid';\r\n\r\n@Entity\r\nexport class Brand {}\r\nexport default Brand;\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/components/Brands/Brand.jsx\n **/","import Suid from 'ws.suid';\r\nimport Entity from '../Entity/Entity';\r\n\r\n@Entity\r\nexport class Product {}\r\nexport default Product;\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/components/Products/Product.jsx\n **/","import Entity from '../Entity/Entity';\r\n\r\nimport Suid from 'ws.suid';\r\n\r\n@Entity\r\nexport class Rating {}\r\nexport default Rating;\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/components/Products/Rating.jsx\n **/","import Suid from 'ws.suid';\r\nimport Entity from '../Entity/Entity';\r\n\r\n@Entity\r\nexport class StockItem {}\r\nexport default StockItem;\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/components/Products/StockItem.jsx\n **/","import Entity from '../Entity/Entity';\r\n\r\nimport Suid from 'ws.suid';\r\n\r\n@Entity\r\nexport class Store {}\r\nexport default Store;\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/components/Stores/Store.jsx\n **/","import serialize from 'serialize-javascript';\r\n\r\nexport function markupBefore(version, apiUrl, scripts, meta='', production=process.env.NODE_ENV == 'production') {\r\n\treturn `<!DOCTYPE html>\r\n<html>\r\n\t<head>\r\n\t\t<meta charset=\"utf-8\" />\r\n\t\t<meta name=\"viewport\" content=\"width=device-width, initial-scale=1\" />\r\n\t\t${meta}\r\n\t\t<link rel=\"shortcut icon\" href=\"/favicon.ico\" />\r\n\t\t<link rel=\"stylesheet\" href=\"https://cdn.rawgit.com/tleunen/react-mdl/v1.5.3/extra/material.min.css\" />\r\n\t\t<link rel=\"stylesheet\" href=\"https://fonts.googleapis.com/icon?family=Material+Icons\" />\r\n\t\t<link rel=\"stylesheet\" href=\"/style.css?v${version}\" />\r\n\t\t<script>\r\n\t\t\twindow.__bridalapp_api_server='${apiUrl}';\r\n\t\t\twindow.mdlSuppressAutoUpgrade = true;\r\n\t\t</script>\r\n\t\t<script>(function(){\r\n\t\t\tvar loadScripts = (function() {return function(stagedScripts) {\r\n\t\t\t\tfunction loadStage(n) {\r\n\t\t\t\t\tvar scripts = Object.keys(stagedScripts[n]).map(function(key){return stagedScripts[n][key]});\r\n\t\t\t\t\tfor (var i=0,script; script=scripts[i]; i++) {loadScript(script);}\r\n\t\t\t\t\treturn function(){return stageLoaded(n);};\r\n\t\t\t\t}\r\n\t\t\t\tfunction loadScript(src) {if (src) {\r\n\t\t\t\t\tvar s = document.createElement('script');\r\n\t\t\t\t\ts.async=true;  s.src=src;  s.charSet='UTF-8';\r\n\t\t\t\t\tdocument.getElementsByTagName('head')[0].appendChild(s);\r\n\t\t\t\t}}\r\n\t\t\t\tfunction stageLoaded(n) {\r\n\t\t\t\t\tvar deps = Object.keys(stagedScripts[n]);\r\n\t\t\t\t\tfor (var i=0,dep; dep=deps[i]; i++) {if (! window[dep]) {return false;}}\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t}\r\n\t\t\t\tvar poll = (function(){var timeout; return function(check, cb, delay) {\r\n\t\t\t\t\t(function poller(){\r\n\t\t\t\t\t\tif (check()) {if (timeout) {clearTimeout(timeout); timeout=null;} cb();}\r\n\t\t\t\t\t\telse {timeout = setTimeout(poller, delay)}\r\n\t\t\t\t\t})()\r\n\t\t\t\t}})();\r\n\t\t\t\tvar loadNextStage = (function(){var stage=0; return function() {\r\n\t\t\t\t\tif (stage < stagedScripts.length) {poll(loadStage(stage++), loadNextStage, 50)}\r\n\t\t\t\t}})()\r\n\t\t\t\tloadNextStage();\r\n\t\t\t}})();\r\n\r\n\t\t\tloadScripts(${JSON.stringify(scripts)});\r\n\t\t})()</script>\r\n\t</head>\r\n\t<body>\r\n\t\t<div id=\"bridalapp\">`\r\n}\r\n\r\nexport function markupAfter(state) {\r\nreturn `</div>\r\n\t\t<script>\r\n\t\t\twindow.bridalapp_initial_state=${serialize(state)};\r\n\t\t</script>\r\n\t</body>\r\n</html>\r\n`}\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/markup.jsx\n **/","module.exports = require(\"babel-runtime/core-js/json/stringify\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"babel-runtime/core-js/json/stringify\"\n ** module id = 44\n ** module chunks = 0\n **/","module.exports = require(\"babel-runtime/helpers/defineProperty\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"babel-runtime/helpers/defineProperty\"\n ** module id = 45\n ** module chunks = 0\n **/","module.exports = require(\"babel-runtime/helpers/toConsumableArray\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"babel-runtime/helpers/toConsumableArray\"\n ** module id = 46\n ** module chunks = 0\n **/","module.exports = require(\"react-dom\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"react-dom\"\n ** module id = 47\n ** module chunks = 0\n **/","module.exports = require(\"redux-async-api\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"redux-async-api\"\n ** module id = 48\n ** module chunks = 0\n **/","var path = require('path');\r\n\r\nvar buildPath = path.resolve(__dirname);\r\nvar publicPath = path.resolve(__dirname, 'public');\r\nvar testPath = path.resolve(publicPath, 'test');\r\nvar pkg = require('./package.json');\r\n\r\nvar cfg = {\r\n\tversion: pkg.version,\r\n\tpublicPath: publicPath,\r\n\tbuildPath: buildPath,\r\n\tclient: {\r\n\t\tname: 'BridalApp UI Client',\r\n\t\tentry: './src/client',\r\n\t\toutput: {\r\n\t\t\tfilename: 'bridalapp-ui.js',\r\n\t\t\tpath: path.resolve(publicPath, 'assets'),\r\n\t\t\tpublicPath: '/assets/',\r\n\t\t},\r\n\t},\r\n\tserver: {\r\n\t\tname: 'BridalApp UI Server',\r\n\t\tprotocol: 'http://',\r\n\t\tprotocol: process.env.OPENSHIFT_NODEJS_PROTOCOL || 'http://',\r\n\t\thost: process.env.OPENSHIFT_NODEJS_IP || undefined,\r\n\t\tport: process.env.OPENSHIFT_NODEJS_PORT || process.env.PORT || 80,\r\n\t\tpath: process.env.OPENSHIFT_NODEJS_PATH || '/',\r\n\t\tentry: './src/server',\r\n\t\toutput: {\r\n\t\t\tfilename: 'server.js',\r\n\t\t\tpath: '',\r\n\t\t},\r\n\t},\r\n\tapiServer: {\r\n\t\tname: 'BridalApp API Server',\r\n\t\tprotocol: process.env.BRIDALAPP_API_SERVER_PROTOCOL || 'http://',\r\n\t\thost: process.env.BRIDALAPP_API_SERVER_HOST || 'localhost',\r\n\t\tport: process.env.BRIDALAPP_API_SERVER_PORT || 8080,\r\n\t\tpath: process.env.BRIDALAPP_API_SERVER_PATH || '/api',\r\n\t},\r\n\ttests: {\r\n\t\tname: 'BridalApp UI Tests',\r\n\t\tentry: './src/tests',\r\n\t\toutput: {\r\n\t\t\tfilename: 'bridalapp-ui-tests.js',\r\n\t\t\tpath: path.resolve(testPath, 'assets'),\r\n\t\t\tpublicPath: '/test/assets/',\r\n\t\t},\r\n\t}\r\n};\r\n\r\ncfg.server.url = url(cfg.server);\r\ncfg.apiServer.url = url(cfg.apiServer);\r\n\r\nmodule.exports = cfg;\r\n\r\nfunction url(srv) {\r\n\treturn srv.protocol + srv.host + (srv.port == '80' ? '' : ':' + srv.port) + srv.path;\r\n}\r\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./config.js\n ** module id = 49\n ** module chunks = 0\n **/","import log from 'picolog';\r\nimport React, { PropTypes, Component } from 'react';\r\nconst { string, bool, object, func, array, shape } = PropTypes;\r\nimport { Tabs, Tab, Button, DialogTitle, DialogContent, DialogActions } from 'react-mdl';\r\nlog.assert(Button && DialogTitle && DialogContent && DialogActions, 'Not all react-mdl components are defined.');\r\nimport classNames from 'classnames';\r\n\r\nimport { Dialog, Textfield } from '../Mdl/mdl-extras';\r\nlog.assert(Dialog && Textfield, 'Not all react-mdl-extras components are defined.');\r\n\r\nexport class AuthDialog extends Component {\r\n\tstatic propTypes = {\r\n\t\tdefaultClass: string.isRequired,\r\n\t\tclassName: string,\r\n\t\tchallenged: bool,\r\n\t\tloginDialog: object,\r\n\t\tregisterDialog: object,\r\n\t}\r\n\r\n\tstatic defaultProps = {\r\n\t\tdefaultClass: 'AuthDialog',\r\n\t}\r\n\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\t\tthis.state = { activeTab: 0 };\r\n\t}\r\n\r\n\trender() {\r\n\t\tlog.debug('render', this.props);\r\n\t\tconst { className, defaultClass, challenged, onCancel, onLogin, onRegister, loginDialog, registerDialog, ...props } = this.props;\r\n\t\tconst classes = classNames(className, defaultClass);\r\n\t\treturn (\r\n\t\t\t<Dialog modal className={classes} open={challenged} onCancel={onCancel} {...props}>\r\n\t\t\t\t<Tabs activeTab={this.state.activeTab}\r\n\t\t\t\t\tonChange={(activeTab) => {this.setState({...this.state, activeTab})}} ripple>\r\n\t\t\t\t\t<Tab>&nbsp; Login &nbsp;</Tab>\r\n\t\t\t\t\t<Tab>Register</Tab>\r\n\t\t\t\t</Tabs>\r\n\t\t\t\t{ !this.state.activeTab ?\r\n\t\t\t\t\t<DialogContent>\r\n\t\t\t\t\t\t<p><b>Login</b> or <a href=\"#\" onClick={() => this.setState({...this.state, activeTab:1})}>create an account</a>.</p>\r\n\t\t\t\t\t\t<form className=\"LoginForm\">\r\n\t\t\t\t\t\t\t<Textfield name=\"username\" label=\"Username\" floatingLabel {...loginDialog.username} />\r\n\t\t\t\t\t\t\t<Textfield name=\"password\" label=\"Password\" floatingLabel {...loginDialog.password} />\r\n\t\t\t\t\t\t</form>\r\n\t\t\t\t\t</DialogContent>\r\n\t\t\t\t:\r\n\t\t\t\t\t<DialogContent>\r\n\t\t\t\t\t\t<p><b>Create an account</b> or <a href=\"#\" onClick={() => this.setState({...this.state, activeTab:0})}>Login</a>.</p>\r\n\t\t\t\t\t\t<form className=\"RegistrationForm\">\r\n\t\t\t\t\t\t\t<Textfield name=\"username\" label=\"Username\" floatingLabel {...registerDialog.username} />\r\n\t\t\t\t\t\t\t<Textfield name=\"password\" label=\"Password\" floatingLabel {...registerDialog.password} />\r\n\t\t\t\t\t\t\t<Textfield name=\"passwordConfirm\" label=\"Password (confirm)\" floatingLabel {...registerDialog.confirm}/>\r\n\t\t\t\t\t\t</form>\r\n\t\t\t\t\t</DialogContent>\r\n\t\t\t\t}\r\n\t\t\t\t{ !this.state.activeTab ?\r\n\t\t\t\t\t<DialogActions>\r\n\t\t\t\t\t\t<Button raised colored onClick={onLogin}> &nbsp; Login &nbsp; </Button>\r\n\t\t\t\t\t\t<Button onClick={onCancel}>Cancel</Button>\r\n\t\t\t\t\t</DialogActions>\r\n\t\t\t\t:\r\n\t\t\t\t\t<DialogActions>\r\n\t\t\t\t\t\t<Button raised colored onClick={onRegister}>Register</Button>\r\n\t\t\t\t\t\t<Button onClick={onCancel}>Cancel</Button>\r\n\t\t\t\t\t</DialogActions>\r\n\t\t\t\t}\r\n\t\t\t</Dialog>\r\n\t\t)\r\n\t}\r\n}\r\n\r\nexport default AuthDialog;\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/components/Auth/AuthDialog.jsx\n **/","export class Credential {\r\n\tconstructor(id) {\r\n\t\tthis.id = id;\r\n\t}\r\n}\r\n\r\nexport default Credential;\n\n\n/** WEBPACK FOOTER **\n ** ./src/components/Auth/Credential.jsx\n **/","import log from 'picolog';\r\nimport React, { Component, PropTypes } from 'react';\r\nconst { bool, number, string, object, func, array, shape, any } = PropTypes;\r\nimport { Link } from 'react-router';\r\nimport { Navigation, Button, Icon } from 'react-mdl';\r\n\r\nexport class SessionPanel extends Component {\r\n\tstatic propTypes = {\r\n\t\tonProvoke: func.isRequired,\r\n\t\tonLogout: func.isRequired,\r\n\t\tsession: shape({\r\n\t\t\tuser: shape({\r\n\t\t\t\tid: any.isRequired,\r\n\t\t\t\tname: string.isRequired,\r\n\t\t\t})\r\n\t\t}).isRequired,\r\n\t}\r\n\r\n\trender() {\r\n\t\tlog.debug('render', this.props);\r\n\t\tconst { onProvoke, onLogout, session:{user}, children } = this.props;\r\n\t\tconst profile = user ? `/profile/${user.name}` : '';\r\n\t\treturn (\r\n\t\t\t<h4>\r\n\t\t\t\t{user\r\n\t\t\t\t\t? <Button className=\"Logout\" colored onClick={onLogout}>Logout</Button>\r\n\t\t\t\t\t: <Button className=\"Login\" colored raised onClick={onProvoke}>Login</Button>\r\n\t\t\t\t}\r\n\t\t\t\t<Navigation className=\"Session\">\r\n\t\t\t\t\t{user\r\n\t\t\t\t\t\t? <Link className=\"Profile\" onClick={e => e.preventDefault()} to={profile}><Icon name=\"account_circle\" /> <span title={user.name}>{user.name}</span></Link>\r\n\t\t\t\t\t\t: <b>Not logged in</b>\r\n\t\t\t\t\t}\r\n\t\t\t\t</Navigation>\r\n\t\t\t</h4>\r\n\t\t)\r\n\t}\r\n}\r\nexport default SessionPanel;\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/components/Auth/SessionPanel.jsx\n **/","import log from 'picolog';\r\nimport React, { Component, PropTypes } from 'react';\r\nconst { bool, object, array, func, shape, any } = PropTypes;\r\nimport shallowEqual from 'fbjs/lib/shallowEqual';\r\nimport { connect } from 'react-redux';\r\nimport { onload } from 'redux-load-api';\r\nimport { Icon } from 'react-mdl';\r\n\r\nimport store from '../../store';\r\nimport AppApi from '../App/api'; // explicitly import to facilitate hot-reload\r\n\r\nimport FilterPanel from '../Entity/FilterPanel';\r\nimport { Badge } from '../Mdl/mdl-extras';\r\nimport Scroller from '../Scroller/Scroller';\r\nimport BrandCard from './BrandCard'\r\n\r\nfunction load(params) {\r\n\tlog.log('load', params);\r\n\treturn bridalapp.brands.search(params)\r\n\t\t.then(results => {\r\n\t\t\tlog.log('load: search returned ' + results.length + ' brands.');\r\n\t\t\treturn results;\r\n\t\t})\r\n\t\t.catch((error) => {\r\n\t\t\tlog.error('Searching brands failed.', error);\r\n\t\t\treturn error;\r\n\t\t});\r\n}\r\n\r\n@onload(load)\r\n@connect(bridalapp.brands.connector)\r\nexport class BrandBrowser extends React.Component {\r\n\tstatic propTypes = {\r\n\t\tparams: object.isRequired,\r\n\t\tlocation: shape({\r\n\t\t\tquery: object,\r\n\t\t}).isRequired,\r\n\t\tfilter: shape({\r\n\t\t\tvalues: object.isRequired,\r\n\t\t}).isRequired,\r\n\t\titems: array.isRequired,\r\n\t\tpending: bool.isRequired,\r\n\t\terror: any,\r\n\t\tonSearch: func.isRequired,\r\n\t\tonItemsChange: func.isRequired,\r\n\t\titem: shape({\r\n\t\t\tonMayPublish: func.isRequired,\r\n\t\t\tonPublish: func.isRequired,\r\n\t\t\tonUnpublish: func.isRequired,\r\n\t\t}).isRequired,\r\n\t}\r\n\r\n\tcomponentDidMount() {\r\n\t\tlog.debug('componentDidMount()');\r\n\t\tconst { pending, error, params } = this.props;\r\n\t\tif (pending || error) {load(params);}\r\n\t}\r\n\r\n\tcomponentWillReceiveProps(nextProps) {\r\n\t\tlog.debug('componentWillReceiveProps', nextProps);\r\n\t\tconst newFilter = {...nextProps.location.query, ...nextProps.params};\r\n\t\tconst pathChanged = nextProps.location.pathname !== this.props.location.pathname;\r\n\t\tconst queryChanged = !shallowEqual(nextProps.location.query, this.props.location.query);\r\n\t\tif (pathChanged || queryChanged || (nextProps.pending && !this.props.pending)) {\r\n\t\t\tload(newFilter);\r\n\t\t}\r\n\t}\r\n\r\n\trender() {\r\n\t\tlog.debug('render', this.props);\r\n\t\tconst { params, location, filter, onSearch, pending, error, items, onItemsChange, stockedItems, item } = this.props;\r\n\t\tconst filterProps = {onSearch, location, ...filter};\r\n\r\n\t\treturn (\r\n\t\t\t<div style={{boxSizing:'border-box', height:'100%'}}>\r\n\t\t\t\t<FilterPanel {...filterProps} />\r\n\t\t\t\t<Scroller\r\n\t\t\t\t\tclassName={'BrandBrowser '}\r\n\t\t\t\t\tbufferBefore={2}\r\n\t\t\t\t\titems={items}\r\n\t\t\t\t\tbufferAfter={4}\r\n\t\t\t\t\trenderItem ={(brand, idx) => {\r\n\t\t\t\t\t\tconst props = {brand, ...item, frontLoadDelay: idx < 10 ? 0 : 500, backLoadDelay: idx < 10 ? 0 : 2500};\r\n\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t<BrandCard {...props} />\r\n\t\t\t\t\t\t)\r\n\t\t\t\t\t}}\r\n\t\t\t\t/>\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n}\r\nexport default BrandBrowser;\r\n\r\n@connect(bridalapp.brands.connector)\r\nexport class BrandBrowserAppBar extends Component {\r\n\tstatic propTypes = {\r\n\t\tfilter: shape({\r\n\t\t\topen: bool.isRequired,\r\n\t\t\tonActivate: func.isRequired,\r\n\t\t\tonCancel: func.isRequired,\r\n\t\t}).isRequired,\r\n\t\titems: array.isRequired,\r\n\t}\r\n\r\n\tconstructor(...args) {\r\n\t\tsuper(...args);\r\n\t\tthis.filterClicked = this.filterClicked.bind(this);\r\n\t}\r\n\r\n\tfilterClicked(event) {\r\n\t\tlog.log('filterClicked', event);\r\n\t\tif (event) {event.preventDefault();}\r\n\t\tconst { open, onActivate, onCancel } = this.props.filter;\r\n\t\topen ? onCancel() : onActivate();\r\n\t}\r\n\r\n\trender() {\r\n\t\treturn (\r\n\t\t\t<Badge className=\"mdl-navigation__link\" text={'' + this.props.items.length} onClick={this.filterClicked}>\r\n\t\t\t\t<Icon name=\"search\" />\r\n\t\t\t</Badge>\r\n\t\t)\r\n\t}\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/components/Brands/BrandBrowser.jsx\n **/","import log from 'picolog';\r\nimport React, { Component, PropTypes } from 'react';\r\nconst { any, bool, string, object, func, shape } = PropTypes;\r\nimport classNames from 'classnames';\r\nimport Suid from 'ws.suid';\r\nimport { CardTitle, FABButton, Icon } from 'react-mdl';\r\nimport { StatefulFlipCard, FrontFace, BackFace } from '../Mdl/mdl-extras';\r\nimport { Publication } from '../Publication/Publication';\r\n\r\nexport class BrandCard extends Publication {\r\n\tstatic propTypes = {\r\n\t\tbrand: shape({\r\n\t\t\tid: any,\r\n\t\t\tname: string,\r\n\t\t}).isRequired,\r\n\t}\r\n\r\n\tstatic contextTypes = {\r\n\t\tlightbox: shape({\r\n\t\t\tonOpenLightbox: func.isRequired,\r\n\t\t}).isRequired,\r\n\t}\r\n\r\n\tconstructor(...props) {\r\n\t\tsuper(...props);\r\n\t\tthis.state = {size: {height:'100%'}};\r\n\t}\r\n\r\n\tcomponentDidMount() {\r\n\t\tthis.setState({size: window.innerWidth < 480 ? {width:'100%'} : {height:'100%'}});\r\n\t}\r\n\r\n\tthumbnailClicked(images, index, event) {\r\n\t\tconst { lightbox: { onOpenLightbox } } = this.context;\r\n\t\tonOpenLightbox(images, index, event);\r\n\t\tif (event) {event.preventDefault(); event.stopPropagation();}\r\n\t}\r\n\r\n\trender() {\r\n\t\tconst { brand, ...others } = this.props;\r\n\t\tconst { id, name, published } = brand;\r\n\t\tconst { size } = this.state;\r\n\t\tconst bid = id.toString();\r\n\t\tconst img = 'data:image/gif;base64,R0lGODlhAgADAIAAAP///////yH5BAEKAAEALAAAAAACAAMAAAICjF8AOw==';\r\n\t\tconst prdUrl = `https://cdn.rawgit.com/Download/bridalapp-static/1.0.16/products/${bid}/Brand`;\r\n\t\tconst brandUrl = `https://cdn.rawgit.com/Download/bridalapp-static/1.0.16/brands/${bid}/logo-brand-name.png`;\r\n\t\tconst thumbs = `${prdUrl}/thumbs.jpg`;\r\n\t\tconst thumbnail = 'data:image/gif;base64,R0lGODlhAgADAIAAAP///////yH5BAEKAAEALAAAAAACAAMAAAICjF8AOw==';\r\n\t\tconst images = [\r\n\t\t\t{src: `${prdUrl}/back-large.jpg`, className:'back', alt:{src:img, style:{...size, backgroundImage:`url(${thumbs})`, backgroundSize:'300%', backgroundPosition:'100% 0'}}},\r\n\t\t\t{src: `${prdUrl}/front-large.jpg`, className:'front', alt:{src:img, style:{...size, backgroundImage:`url(${thumbs})`, backgroundSize:'150%', backgroundPosition:'0 0'}}},\r\n\t\t\t{src: `${prdUrl}/detail-1-large.jpg`, className:'detail-1', alt:{src:img, style:{...size, backgroundImage:`url(${thumbs})`, backgroundSize:'600%', backgroundPosition:'200% 200%'}}},\r\n\t\t\t{src: `${prdUrl}/detail-2-large.jpg`, className:'detail-2', alt:{src:img, style:{...size, backgroundImage:`url(${thumbs})`, backgroundSize:'600%', backgroundPosition:'100% 200%'}}},\r\n\t\t\t{src: `${prdUrl}/detail-3-large.jpg`, className:'detail-3', alt:{src:img, style:{...size, backgroundImage:`url(${thumbs})`, backgroundSize:'600%', backgroundPosition:'200% 100%'}}},\r\n\t\t];\r\n\t\tconst classes = classNames('Product', {'unpublished':!published});\r\n\r\n\t\treturn (\r\n\t\t\t<StatefulFlipCard className={classes} key={bid} {...others} >\r\n\t\t\t\t<FrontFace>\r\n\t\t\t\t\t<div className=\"content\">\r\n\t\t\t\t\t\t<img className=\"ProductImage\" src={img} style={{backgroundImage: `url(${thumbs})`, height:'100%'}} />\r\n\t\t\t\t\t\t{this.mayPublish(brand) ?\r\n\t\t\t\t\t\t\t<div className=\"ModActions\">\r\n\t\t\t\t\t\t\t{published ?\r\n\t\t\t\t\t\t\t\t<FABButton className=\"Unpublish\" onClick={this.unpublishClicked.bind(this, brand)}><Icon name=\"visibility_off\" /></FABButton>\r\n\t\t\t\t\t\t\t:\r\n\t\t\t\t\t\t\t\t<FABButton className=\"Publish\" onClick={this.publishClicked.bind(this, brand)}><Icon name=\"visibility\" /></FABButton>\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t: ''}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</FrontFace>\r\n\t\t\t\t<BackFace>\r\n\t\t\t\t\t<CardTitle>\r\n\t\t\t\t\t\t<img className=\"BrandLogo\" src={brandUrl} />\r\n\t\t\t\t\t\t<h3 className=\"ProductName\">{name}</h3>\r\n\t\t\t\t\t</CardTitle>\r\n\t\t\t\t\t<div className=\"ProductGallery\">\r\n\t\t\t\t\t\t<div className=\"thumbs\">{images.map(({src, className}, i) => (\r\n\t\t\t\t\t\t\t<img key={i} className={classNames(className, 'thumb')}\r\n\t\t\t\t\t\t\t\t\tsrc={thumbnail} onClick={this.thumbnailClicked.bind(this, images, i)}\r\n\t\t\t\t\t\t\t\t\tstyle={{backgroundImage:`url(${thumbs})`}}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t))}</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</BackFace>\r\n\t\t\t</StatefulFlipCard>\r\n\t\t);\r\n\t}\r\n}\r\nexport default BrandCard;\n\n\n/** WEBPACK FOOTER **\n ** ./src/components/Brands/BrandCard.jsx\n **/","import log from 'picolog';\r\nimport { Api, link } from 'redux-apis';\r\nimport { remote } from 'redux-fetch-api';\r\n\r\nimport PublicationApi from '../Publication/api';\r\nimport Brand from './Brand';\r\n\r\n@remote\r\nexport class BrandsApi extends PublicationApi {\r\n\tstatic INITIAL_STATE = {\r\n\t\t...PublicationApi.INITIAL_STATE,\r\n\t\tmanagedBrands: [],\r\n\t\tmanagedBrandIndex: 0,\r\n\t}\r\n\r\n\tstatic SET_MANAGED_BRANDS = 'SET_MANAGED_BRANDS';\r\n\tstatic SET_MANAGED_BRAND_INDEX = 'SET_MANAGED_BRAND_INDEX';\r\n\r\n\tconstructor(state = BrandsApi.INITIAL_STATE) {\r\n\t\tsuper(state);\r\n\r\n\t\tthis.setHandler(BrandsApi.SET_MANAGED_BRANDS, (state, {payload}) => ({...state, managedBrands:payload}));\r\n\t\tthis.setHandler(BrandsApi.SET_MANAGED_BRAND_INDEX, (state, {payload}) => ({...state, managedBrandIndex:payload}));\r\n\r\n\t\tObject.defineProperties(this, {\r\n\t\t\tmanagedBrands: {enumerable:true, get:() => this.getState().managedBrands},\r\n\t\t\tmanagedBrandIndex: {enumerable:true, get:() => this.getState().managedBrandIndex},\r\n\t\t\tmanagedBrand: {enumerable:true, get:() => this.managedBrands[this.managedBrandIndex]},\r\n\t\t});\r\n\t}\r\n\r\n\tsetManagedBrands(brands) {\r\n\t\treturn this.dispatch(this.createAction(BrandsApi.SET_MANAGED_BRANDS)(brands));\r\n\t}\r\n\r\n\tsetManagedBrandIndex(index) {\r\n\t\treturn this.dispatch(this.createAction(BrandsApi.SET_MANAGED_BRAND_INDEX)(index));\r\n\t}\r\n}\r\nexport default BrandsApi;\n\n\n/** WEBPACK FOOTER **\n ** ./src/components/Brands/api.jsx\n **/","import log from 'picolog';\r\nimport React, { Component, PropTypes } from 'react';\r\nconst { object, func, shape } = PropTypes;\r\nimport classNames from 'classnames';\r\nimport { Icon, CardText } from 'react-mdl';\r\n\r\nimport { Textfield } from '../Mdl/mdl-extras';\r\nimport { fromJSON, toJSON, indexOf } from '../Entity/Entity';\r\n\r\nexport class FilterFields extends Component {\r\n\tstatic propTypes = {\r\n\t\tfields: shape({\r\n\t\t\tq: object.isRequired,\r\n\t\t}).isRequired,\r\n\t\tonApplyFields: func.isRequired,\r\n\t\tonSearch: func.isRequired,\r\n\t}\r\n\r\n\tclearField(field, event) {\r\n\t\tlog.info('clearField', field, event);\r\n\t\tevent.preventDefault();\r\n\t\tconst { onApplyFields, onSearch } = this.props;\r\n\t\tfield.onChange('');\r\n\t}\r\n\r\n\trender() {\r\n\t\tconst { fields, className, children } = this.props;\r\n\t\tconst classes = classNames('FilterFields', className);\r\n\t\treturn (\r\n\t\t\t<CardText className={classes}>\r\n\t\t\t\t<div className=\"FilterField q\">\r\n\t\t\t\t\t<Textfield {...fields.q} placeholder=\"Type here...\" />\r\n\t\t\t\t\t<a className=\"clear-button\" href=\"#\" onClick={this.clearField.bind(this, fields.q)}><Icon name=\"clear\" /></a>\r\n\t\t\t\t</div>\r\n\t\t\t\t{children}\r\n\t\t\t</CardText>\r\n\t\t)\r\n\t}\r\n}\r\nexport default FilterFields;\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/components/Entity/FilterFields.jsx\n **/","import log from 'picolog';\r\nimport { Api, link } from 'redux-apis';\r\nimport { Async } from 'redux-async-api';\r\nimport { remote } from 'redux-fetch-api';\r\nimport shallowEqual from 'fbjs/lib/shallowEqual';\r\n\r\nimport { TextfieldApi } from '../Mdl/api';\r\n\r\nimport { fromJSON, toJSON, indexOf } from '../Entity/Entity';\r\n\r\nexport class FilterFields extends Api {\r\n\tconstructor(state) {\r\n\t\tsuper(state);\r\n\t\t// query field is standard for all entities\r\n\t\tthis.q = link(this, new TextfieldApi());\r\n\t\tthis.q.type = 'text';\r\n\t}\r\n}\r\n\r\nexport class FilterApi extends Api {\r\n\tstatic INITIAL_STATE = {\r\n\t\topen: false,\r\n\t\tvalues: {},\r\n\t}\r\n\r\n\tstatic ACTIVATE = 'ACTIVATE';\r\n\tstatic CANCEL = 'CANCEL';\r\n\tstatic SET_VALUES = 'SET_VALUES';\r\n\tstatic APPLY_FIELDS = 'APPLY_FIELDS';\r\n\r\n\tconstructor(state = FilterApi.INITIAL_STATE) {\r\n\t\tsuper(state);\r\n\r\n\t\tthis.setHandler(FilterApi.ACTIVATE, (state) => ({...state, open:true}));\r\n\t\tthis.setHandler(FilterApi.CANCEL, (state) => ({...state, open:false}));\r\n\t\tthis.setHandler(FilterApi.SET_VALUES, (state, {payload}) => ({...state, values:payload}));\r\n\t\tthis.setHandler(FilterApi.APPLY_FIELDS, (state) => {\r\n\t\t\tlet changed = false;\r\n\t\t\tconst values = { ...this.values };\r\n\t\t\tconst keys = Object.keys(this.fields);\r\n\t\t\tfor (let i=0,key; key=keys[i]; i++) {\r\n\t\t\t\tif (this.fields[key].value !== values[key]) {\r\n\t\t\t\t\tchanged = true;\r\n\t\t\t\t\tvalues[key] = this.fields[key].value;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn changed ? {...state, values} : state;\r\n\t\t});\r\n\r\n\t\tObject.defineProperties(this, {\r\n\t\t\topen: {enumerable:true, get:() => this.getState().open},\r\n\t\t\tvalues: {enumerable:true, get:() => this.getState().values},\r\n\t\t});\r\n\t\tthis.fields = this.createFields();\r\n\r\n\t\tthis.onActivate = this.activate.bind(this);\r\n\t\tthis.onCancel = this.cancel.bind(this);\r\n\t\tthis.onApplyFields = this.applyFields.bind(this);\r\n\t}\r\n\r\n\tactivate() {\r\n\t\tthis.dispatch(this.createAction(FilterApi.ACTIVATE)());\r\n\t}\r\n\r\n\tcancel() {\r\n\t\tthis.dispatch(this.createAction(FilterApi.CANCEL)());\r\n\t}\r\n\r\n\tapplyFields() {\r\n\t\tthis.dispatch(this.createAction(FilterApi.APPLY_FIELDS)());\r\n\t\treturn this.values;\r\n\t}\r\n\r\n\tsetValues(values) {\r\n\t\tthis.dispatch(this.createAction(FilterApi.SET_VALUES)(values));\r\n\t\tObject.keys(this.fields).forEach(key => this.fields[key].setValue(values[key]));\r\n\t}\r\n\r\n\tcreateFields() {\r\n\t\treturn link(this, new FilterFields());\r\n\t}\r\n}\r\n\r\n\r\n@remote\r\nexport class EntityApi extends Async {\r\n\tstatic INITIAL_STATE = {\r\n\t\t...Async.INITIAL_STATE,\r\n\t\titems: [],\r\n\t\titemStates: {},\r\n\t}\r\n\r\n\tstatic SET_FILTER = 'SET_FILTER';\r\n\tstatic SET_ITEMS = 'SET_ITEMS';\r\n\tstatic SET_ITEM_STATES = 'SET_ITEM_STATES';\r\n\r\n\tconstructor(state = EntityApi.INITIAL_STATE) {\r\n\t\tsuper(state);\r\n\r\n\t\tthis.setHandler(EntityApi.SET_FILTER, (state, action) => ({...state, filter: action.payload}));\r\n\t\tthis.setHandler(EntityApi.SET_ITEMS, (state, action) => ({...state, items: action.payload}));\r\n\t\tthis.setHandler(EntityApi.SET_PROCESSING, (state, action) => ({...state, processing: action.payload}));\r\n\r\n\t\tObject.defineProperties(this, {\r\n\t\t\titems: {enumerable:true, get:() => this.getState().items},\r\n\t\t\titemStates: {enumerable:true, get:() => this.getState().itemStates}\r\n\t\t})\r\n\r\n\t\tthis.onSearch = () => this.search();\r\n\t\tthis.onItemsChange = this.setItems.bind(this);\r\n\t\tthis.onItemStatesChange = this.setItemStates.bind(this);\r\n\r\n\t\tthis.item = {\r\n\t\t\titemState: this.itemState.bind(this),\r\n\t\t\tonItemStateChange: this.setItemState.bind(this),\r\n\t\t\tonItemSave: this.save.bind(this),\r\n\t\t}\r\n\r\n\t\tthis.filter = this.createFilter();\r\n\t}\r\n\r\n\titemState(item) {\r\n\t\treturn this.items[item.id] || Async.DONE;\r\n\t}\r\n\r\n\tsetItemState(item, newState) {\r\n\t\tconst newStates = { ...this.itemStates };\r\n\t\tif (newState != DONE) {newStates[item.id] = newState;}\r\n\t\telse {delete newStates[item.id];}\r\n\t\tthis.setItemStates(newStates);\r\n\t\treturn this;\r\n\t}\r\n\r\n\tsave(item) {\r\n\t\tlog.log('save', item);\r\n\t\tlet result = Promise.resolve(item);\r\n\t\tif (this.itemState(item) !== Async.BUSY) {\r\n\t\t\tthis.itemState(item, Async.BUSY);\r\n\t\t\tresult = this.fetch('', {\r\n\t\t\t\tmethod: 'POST',\r\n\t\t\t\theaders: {\r\n\t\t\t\t\t'Content-Type': 'application/json',\r\n\t\t\t\t},\r\n\t\t\t\tbody: toJSON(item),\r\n\t\t\t})\r\n\t\t\t.then(response => {\r\n\t\t\t\tif (response && response.status == 200) {\r\n\t\t\t\t\treturn response.text();\r\n\t\t\t\t}\r\n\t\t\t\treturn response.text().then(text => {\r\n\t\t\t\t\tconst error = Error(text);\r\n\t\t\t\t\terror.status = response.status;\r\n\t\t\t\t\terror.statusText = response.statusText;\r\n\t\t\t\t\tthrow error;\r\n\t\t\t\t});\r\n\t\t\t})\r\n\t\t\t.then(text => {\r\n\t\t\t\tthis.itemState(item, Async.DONE);\r\n\t\t\t\treturn fromJSON(text);\r\n\t\t\t})\r\n\t\t\t.catch(error => {\r\n\t\t\t\tthis.itemState(item, error);\r\n\t\t\t\tthrow error;\r\n\t\t\t});\r\n\t\t}\r\n\t\treturn result;\r\n\t}\r\n\r\n\tsetItems(items) {\r\n\t\tlog.debug('setItems', items);\r\n\t\tthis.dispatch(this.createAction(EntityApi.SET_ITEMS)(items));\r\n\t}\r\n\r\n\tsetItemStates(itemStates) {\r\n\t\tlog.debug('setItemStates', itemStates);\r\n\t\tthis.dispatch(this.createAction(EntityApi.SET_ITEM_STATES)(itemStates));\r\n\t}\r\n\r\n\r\n\tsearchUrl(filter) {\r\n\t\tconst keys = Object.keys(filter);\r\n\t\tlet result = '';\r\n\t\tfor (let i=0,key; key=keys[i]; i++) {\r\n\t\t\tresult += result ? '&' : '?';\r\n\t\t\tresult += encodeURIComponent(key) + '=' + encodeURIComponent(filter[key]);\r\n\t\t}\r\n\t\treturn result;\r\n\t}\r\n\r\n\tsearch(params) {\r\n\t\tif (params && !shallowEqual(this.filter.values, params)) {this.filter.setValues(params);}\r\n\t\tconst url = this.searchUrl(this.filter.values);\r\n\t\tlog.log('search', url);\r\n\t\tthis.setBusy();\r\n\t\treturn new Promise((resolve, reject) => {\r\n\t\t\tthis.fetch(url)\r\n\t\t\t\t.then(response => response && response.status === 200\r\n\t\t\t\t\t? response.text()\r\n\t\t\t\t\t: new Promise((ok, err) => {\r\n\t\t\t\t\t\tresponse.text().then(text => {\r\n\t\t\t\t\t\t\tconst error = Error(text);\r\n\t\t\t\t\t\t\terror.message = text;\r\n\t\t\t\t\t\t\terror.status = response.status;\r\n\t\t\t\t\t\t\terror.statusText = response.statusText;\r\n\t\t\t\t\t\t\terr(error);\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t})\r\n\t\t\t\t)\r\n\t\t\t\t.then(text => fromJSON(text))\r\n\t\t\t\t.then(json => {\r\n\t\t\t\t\tlog.debug('search: OK got ' + json.length + ' results');\r\n\t\t\t\t\tthis.setItems(json);\r\n\t\t\t\t\tthis.setDone();\r\n\t\t\t\t\treturn json;\r\n\t\t\t\t})\r\n\t\t\t\t.then(resolve)\r\n\t\t\t\t.catch(error => {\r\n\t\t\t\t\tlog.info('search: error=', error);\r\n\t\t\t\t\tthis.setError(error);\r\n\t\t\t\t\treject(error);\r\n\t\t\t\t});\r\n\t\t});\r\n\t}\r\n\r\n\tcreateFilter() {\r\n\t\treturn link(this, new FilterApi());\r\n\t}\r\n}\r\nexport default EntityApi;\r\n\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/components/Entity/api.jsx\n **/","import React, { PropTypes } from 'react';\r\n\r\nexport default class Home extends React.Component {\r\n\trender() {\r\n\t\treturn (\r\n\t\t\t<div className=\"Home\">\r\n\t\t\t\t<h1>BRIDAL APP</h1>\r\n\t\t\t\tAllrighty :) thenn\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n}\n\n\n/** WEBPACK FOOTER **\n ** ./src/components/Home/Home.jsx\n **/","import log from 'picolog';\r\nimport React, { Component, PropTypes } from 'react';\r\nconst { bool, array, object, func, shape, any } = PropTypes;\r\nimport shallowEqual from 'fbjs/lib/shallowEqual';\r\nimport { connect } from 'react-redux';\r\nimport { onload } from 'redux-load-api';\r\nimport { Icon } from 'react-mdl';\r\n\r\nimport store from '../../store';\r\nimport AppApi from '../App/api'; // explicitly import to facilitate hot-reload\r\nimport { indexOf } from '../Entity/Entity';\r\nimport FilterPanel from '../Entity/FilterPanel';\r\nimport { Badge } from '../Mdl/mdl-extras';\r\nimport Scroller from '../Scroller/Scroller';\r\nimport ProductCard from './ProductCard';\r\n\r\nconst ANIMATION_TIME = 510;\r\n\r\nfunction load(params) {\r\n\tlog.log('load', params);\r\n\treturn bridalapp.products.search(params)\r\n\t\t.then((results) => {\r\n\t\t\tlog.debug('load: search returned ' + results.length + ' products.');\r\n\t\t\treturn results;\r\n\t\t})\r\n\t\t.catch((error) => {\r\n\t\t\tlog.error('Searching products failed.', error);\r\n\t\t\treturn error;\r\n\t\t});\r\n}\r\n\r\n@onload(load)\r\n@connect(bridalapp.products.connector)\r\nexport class ProductBrowser extends React.Component {\r\n\tstatic propTypes = {\r\n\t\tparams: object.isRequired,\r\n\t\tlocation: shape({\r\n\t\t\tquery: object,\r\n\t\t}).isRequired,\r\n\t\tfilter: shape({\r\n\t\t\tvalues: object.isRequired,\r\n\t\t}).isRequired,\r\n\t\titems: array.isRequired,\r\n\t\tstockedItems: object.isRequired,\r\n\t\tpending: bool.isRequired,\r\n\t\terror: any,\r\n\t\tonSearch: func.isRequired,\r\n\t\tonItemsChange: func.isRequired,\r\n\t\titem: shape({\r\n\t\t\tonMayPublish: func.isRequired,\r\n\t\t\tonPublish: func.isRequired,\r\n\t\t\tonUnpublish: func.isRequired,\r\n\t\t\tonLove: func.isRequired,\r\n\t\t\tonDislike: func.isRequired,\r\n\t\t\tonUndoRating: func.isRequired,\r\n\t\t\tonMayToggleStock: func.isRequired,\r\n\t\t\tonIsStocked: func.isRequired,\r\n\t\t\tonToggleStock: func.isRequired,\r\n\t\t}).isRequired,\r\n\t}\r\n\r\n\tconstructor(...args) {\r\n\t\tsuper(...args);\r\n\t\tthis.state = { removing:{}, filterPanelOpen:false };\r\n\t}\r\n\r\n\tcomponentDidMount() {\r\n\t\tlog.debug('componentDidMount()');\r\n\t\tconst { params, location: { query }, pending, error } = this.props;\r\n\t\tif (pending || error) {load({...query, ...params});}\r\n\t}\r\n\r\n\tcomponentWillReceiveProps(nextProps) {\r\n\t\tlog.debug('componentWillReceiveProps', nextProps);\r\n\t\tconst newFilter = {...nextProps.location.query, ...nextProps.params};\r\n\t\tconst pathChanged = nextProps.location.pathname !== this.props.location.pathname;\r\n\t\tconst queryChanged = !shallowEqual(nextProps.location.query, this.props.location.query);\r\n\t\tif (pathChanged || queryChanged || (nextProps.pending && !this.props.pending)) {\r\n\t\t\tif (Object.keys(this.state.removing).length > 0) {this.setState({ removing:{} });}\r\n\t\t\tload(newFilter);\r\n\t\t}\r\n\t}\r\n\r\n\tdislike(product) {\r\n\t\tlog.log('dislike', product);\r\n\t\tconst pid = product.id.toString();\r\n\t\tif (bridalapp.auth.loggedIn) {\r\n\t\t\tconst removing = { ...this.state.removing };\r\n\t\t\tremoving[pid] = 'disliked';\r\n\t\t\tthis.setState({ ...this.state, removing });\r\n\t\t}\r\n\t\tconst timer = new Promise(resolve => setTimeout(()=>resolve(), ANIMATION_TIME));\r\n\t\treturn Promise.all([timer, this.props.item.onDislike(product)])\r\n\t\t\t.then(() => {\r\n\t\t\t\tconst { items, onItemsChange } = this.props, idx = indexOf(items, product);\r\n\t\t\t\tif (idx >= 0) {\r\n\t\t\t\t\tonItemsChange(items.slice(0, idx).concat(items.slice(idx + 1)));\r\n\t\t\t\t}\r\n\t\t\t\tconst removing = { ...this.state.removing };\r\n\t\t\t\tdelete removing[pid];\r\n\t\t\t\tthis.setState({...this.state, removing});\r\n\t\t\t})\r\n\t}\r\n\r\n\tlove(product) {\r\n\t\tlog.log('love', product);\r\n\t\tconst pid = product.id.toString();\r\n\t\tif (bridalapp.auth.loggedIn) {\r\n\t\t\tconst removing = { ...this.state.removing };\r\n\t\t\tremoving[pid] = 'loved';\r\n\t\t\tthis.setState({ ...this.state, removing });\r\n\t\t}\r\n\t\tconst timer = new Promise(resolve => setTimeout(()=>resolve(), ANIMATION_TIME));\r\n\t\treturn Promise.all([timer, this.props.item.onLove(product)])\r\n\t\t\t.then(() => {\r\n\t\t\t\tconst { items, onItemsChange } = this.props, idx = indexOf(items, product);\r\n\t\t\t\tif (idx >= 0) {\r\n\t\t\t\t\tonItemsChange(items.slice(0, idx).concat(items.slice(idx + 1)));\r\n\t\t\t\t}\r\n\t\t\t\tconst removing = { ...this.state.removing };\r\n\t\t\t\tdelete removing[pid];\r\n\t\t\t\tthis.setState({...this.state, removing});\r\n\t\t\t})\r\n\t}\r\n\r\n\tundoRating(product) {\r\n\t\tlog.log('undoRating', product);\r\n\t\tconst pid = product.id.toString();\r\n\t\tif (bridalapp.auth.loggedIn) {\r\n\t\t\tconst removing = { ...this.state.removing };\r\n\t\t\tremoving[pid] = 'undoRating';\r\n\t\t\tthis.setState({ ...this.state, removing });\r\n\t\t}\r\n\t\tconst timer = new Promise(resolve => setTimeout(()=>resolve(), ANIMATION_TIME));\r\n\t\treturn Promise.all([timer, this.props.item.onUndoRating(product)])\r\n\t\t\t.then(() => {\r\n\t\t\t\tconst { items, onItemsChange } = this.props, idx = indexOf(items, product);\r\n\t\t\t\tif (idx >= 0) {\r\n\t\t\t\t\tonItemsChange(items.slice(0, idx).concat(items.slice(idx + 1)));\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t}\r\n\r\n\trender() {\r\n\t\tconst { params, location, filter, onSearch, pending, error, items, onItemsChange, stockedItems } = this.props;\r\n\r\n\t\tlog.debug('render', Object.keys(stockedItems).join(' '));\r\n\t\tconst item = { ...this.props.item,\r\n\t\t\tonDislike: this.dislike.bind(this),\r\n\t\t\tonLove: this.love.bind(this),\r\n\t\t\tonUndoRating: this.undoRating.bind(this),\r\n\t\t}\r\n\t\tconst state = Object.keys(stockedItems).join(' ') + ', ' + Object.keys(this.state.removing).join(' ');\r\n\t\tconst filterProps = {onSearch, location, ...filter};\r\n\t\treturn (\r\n\t\t\t<div style={{boxSizing:'border-box', height:'100%'}}>\r\n\t\t\t\t<FilterPanel {...filterProps} />\r\n\t\t\t\t<Scroller\r\n\t\t\t\t\tclassName={'ProductBrowser ' + filter.values.category}\r\n\t\t\t\t\tbufferBefore={4}\r\n\t\t\t\t\titems={items}\r\n\t\t\t\t\titemSize={580}\r\n\t\t\t\t\tbufferAfter={16}\r\n\t\t\t\t\trenderItem ={(product, idx) => {\r\n\t\t\t\t\t\tconst pid = product.id.toString();\r\n\t\t\t\t\t\tconst props = {product, ...item, rating:filter.values.rating, stocked:!!stockedItems[pid],\r\n\t\t\t\t\t\t\tremoving:this.state.removing[pid], frontLoadDelay: idx < 10 ? 0 : 500, backLoadDelay: idx < 10 ? 0 : 2500};\r\n\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t<ProductCard {...props} />\r\n\t\t\t\t\t\t)\r\n\t\t\t\t\t}}\r\n\t\t\t\t\tstate={state}\r\n\t\t\t\t/>\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n}\r\nexport default ProductBrowser;\r\n\r\n@connect(bridalapp.products.connector)\r\nexport class ProductBrowserAppBar extends Component {\r\n\tstatic propTypes = {\r\n\t\tfilter: shape({\r\n\t\t\topen: bool.isRequired,\r\n\t\t\tonActivate: func.isRequired,\r\n\t\t\tonCancel: func.isRequired,\r\n\t\t}).isRequired,\r\n\t\titems: array.isRequired,\r\n\t}\r\n\r\n\tconstructor(...args) {\r\n\t\tsuper(...args);\r\n\t\tthis.filterClicked = this.filterClicked.bind(this);\r\n\t}\r\n\r\n\tfilterClicked(event) {\r\n\t\tlog.log('filterClicked', event);\r\n\t\tif (event) {event.preventDefault();}\r\n\t\tconst { open, onActivate, onCancel } = this.props.filter;\r\n\t\topen ? onCancel() : onActivate();\r\n\t}\r\n\r\n\trender() {\r\n\t\treturn (\r\n\t\t\t<Badge className=\"mdl-navigation__link\" text={'' + this.props.items.length} onClick={this.filterClicked}>\r\n\t\t\t\t<Icon name=\"search\" />\r\n\t\t\t</Badge>\r\n\t\t)\r\n\t}\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/components/Products/ProductBrowser.jsx\n **/","import log from 'picolog';\r\nimport React, { Component, PropTypes } from 'react';\r\nconst { any, bool, string, object, func, shape } = PropTypes;\r\nimport classNames from 'classnames';\r\nimport Suid from 'ws.suid';\r\nimport { CardTitle, CardText, Button, FABButton, Icon } from 'react-mdl';\r\nimport { StatefulFlipCard, FrontFace, BackFace, Sprite, Switch } from '../Mdl/mdl-extras';\r\nimport Publication from '../Publication/Publication';\r\n\r\nexport class ProductCard extends Publication {\r\n\tstatic propTypes = {\r\n\t\tclassName: string,\r\n\t\tproduct: shape({\r\n\t\t\tid: any,\r\n\t\t\tname: string,\r\n\t\t\tbrandId: any,\r\n\t\t\tbrandName: string,\r\n\t\t\tdescription: string,\r\n\t\t\tpublished: bool,\r\n\t\t}).isRequired,\r\n\t\trating: string,\r\n\t\tstocked: bool,\r\n\t\tonLove: func.isRequired,\r\n\t\tonDislike: func.isRequired,\r\n\t\tonUndoRating: func.isRequired,\r\n\t\tonMayToggleStock: func.isRequired,\r\n\t\tonToggleStock: func.isRequired,\r\n\t\tremoving: string\r\n\t}\r\n\r\n\tstatic defaultProps = {\r\n\t\tremoving: '',\r\n\t}\r\n\r\n\tstatic contextTypes = {\r\n\t\tlightbox: shape({\r\n\t\t\tonOpenLightbox: func.isRequired,\r\n\t\t}).isRequired,\r\n\t}\r\n\r\n\tconstructor(...props) {\r\n\t\tsuper(...props);\r\n\t\tthis.state = {size: {height:'100%'}};\r\n\t}\r\n\r\n\tcomponentDidMount() {\r\n\t\tthis.setState(...this.state, {size: window.innerWidth < 480 ? {width:'100%'} : {height:'100%'}});\r\n\t}\r\n\r\n\tcomponentWillReceiveProps(nextProps) {\r\n\t\tif (typeof window == 'object' && nextProps.removing) {\r\n\t\t\tconst node = ReactDOM.findDOMNode(this);\r\n\t\t\tconst newState = {...this.state, rect:node.getBoundingClientRect(), win:window.innerWidth};\r\n\t\t\tthis.setState(newState);\r\n\t\t\tlog.debug('componentWillReceiveProps: state=', this.state, ', newState=', newState);\r\n\t\t}\r\n\t}\r\n\r\n\tthumbnailClicked(images, index, event) {\r\n\t\tlog.log('thumbnailClicked', images, index, event);\r\n\t\tconst { lightbox: { onOpenLightbox } } = this.context;\r\n\t\tif (event) {event.preventDefault(); event.stopPropagation();}\r\n\t\tonOpenLightbox(images, index, event);\r\n\t}\r\n\r\n\tdislikeClicked(product, event) {\r\n\t\tlog.log('dislikeClicked', product, event);\r\n\t\tif (event) {event.preventDefault(); event.stopPropagation();}\r\n\t\treturn this.props.onDislike(product);\r\n\t}\r\n\r\n\tloveClicked(product, event) {\r\n\t\tlog.log('loveClicked', product, event);\r\n\t\tif (event) {event.preventDefault(); event.stopPropagation();}\r\n\t\treturn this.props.onLove(product);\r\n\t}\r\n\r\n\tundoRatingClicked(product, event) {\r\n\t\tlog.log('undoRatingClicked', product, event);\r\n\t\tif (event) {event.preventDefault(); event.stopPropagation();}\r\n\t\treturn this.props.onUndoRating(product);\r\n\t}\r\n\r\n\tmayToggleStock(product) {\r\n\t\tlog.trace('mayToggleStock', product);\r\n\t\tconst result = this.props.onMayToggleStock(product);\r\n\t\tlog.trace('mayToggleStock => ' + result);\r\n\t\treturn result;\r\n\t}\r\n\r\n\tisStocked(product) {\r\n\t\tlog.trace('isStocked', product);\r\n\t\tconst result = this.props.onIsStocked(product);\r\n\t\tlog.trace('isStocked => ' + result);\r\n\t\treturn result;\r\n\t}\r\n\r\n\ttoggleStockClicked(product, event) {\r\n\t\tlog.log('toggleStockClicked', product, event);\r\n\t\tif (event) {event.preventDefault(); event.stopPropagation();}\r\n\t\treturn this.props.onToggleStock(product);\r\n\t}\r\n\r\n\trender() {\r\n\t\tlog.debug('render', this.props);\r\n\t\tconst { className, product, rating, stocked, onLove, onDislike, onUndoRating, removing, ...others } = this.props;\r\n\t\tif (stocked) log.debug('render: stocked ', product.id.toString());\r\n\t\tconst { id, name, brandId, brandName, description, published } = product;\r\n\t\tconst { size, rect, win } = this.state;\r\n\t\tconst pid = Suid(id).toString();\r\n\t\tconst bid = Suid(brandId).toString();\r\n\t\tconst { flipCard } = this.refs;\r\n\t\tconst img = 'data:image/gif;base64,R0lGODlhAgADAIAAAP///////yH5BAEKAAEALAAAAAACAAMAAAICjF8AOw==';\r\n\t\tconst prdUrl = `https://cdn.rawgit.com/Download/bridalapp-static/1.0.16/products/${bid}/${encodeURIComponent(name)}`;\r\n\t\tconst brandUrl = `https://cdn.rawgit.com/Download/bridalapp-static/1.0.16/brands/${bid}/logo-brand-name.png`;\r\n\t\tconst thumbs = `${prdUrl}/thumbs.jpg`;\r\n\t\tconst thumbnail = 'data:image/gif;base64,R0lGODlhAgADAIAAAP///////yH5BAEKAAEALAAAAAACAAMAAAICjF8AOw==';\r\n\t\tconst images = [\r\n\t\t\t{src: `${prdUrl}/back-large.jpg`, className:'back', alt:{src:img, style:{...size, backgroundImage:`url(${thumbs})`, backgroundSize:'300%', backgroundPosition:'100% 0'}}},\r\n\t\t\t{src: `${prdUrl}/front-large.jpg`, className:'front', alt:{src:img, style:{...size, backgroundImage:`url(${thumbs})`, backgroundSize:'150%', backgroundPosition:'0 0'}}},\r\n\t\t\t{src: `${prdUrl}/detail-1-large.jpg`, className:'detail-1', alt:{src:img, style:{...size, backgroundImage:`url(${thumbs})`, backgroundSize:'600%', backgroundPosition:'200% 200%'}}},\r\n\t\t\t{src: `${prdUrl}/detail-2-large.jpg`, className:'detail-2', alt:{src:img, style:{...size, backgroundImage:`url(${thumbs})`, backgroundSize:'600%', backgroundPosition:'100% 200%'}}},\r\n\t\t\t{src: `${prdUrl}/detail-3-large.jpg`, className:'detail-3', alt:{src:img, style:{...size, backgroundImage:`url(${thumbs})`, backgroundSize:'600%', backgroundPosition:'200% 100%'}}},\r\n\t\t];\r\n\t\tconst classes = classNames('Product', className, {'unpublished':!published, 'removing':removing,\r\n\t\t\t\t'loved':removing === 'loved', 'disliked':removing === 'disliked'});\r\n\t\tconst width = rect ? rect.right - rect.left : 0;\r\n\t\tconst height = rect ? rect.bottom - rect.top : 0;\r\n\t\tconst trans = (removing === 'disliked' || removing === 'undoRating')\r\n\t\t\t? 0 - rect.left - width : (removing === 'loved' ? win - rect.left : '');\r\n\t\tconst transform = `translate3d(${trans}px, 0, 10px) scale3d(0.2, 0.2, 0.2)`\r\n\t\tconst style = removing ? {width:width, height:height, transform:transform, WebkitTransform:transform} : {};\r\n\t\treturn (\r\n\t\t\t<StatefulFlipCard className={classes} key={id} style={style} {...others}>\r\n\t\t\t\t<FrontFace>\r\n\t\t\t\t\t<div className=\"content\">\r\n\t\t\t\t\t\t<img className=\"ProductImage\" src={img} style={{backgroundImage: `url(${thumbs})`, height:'100%'}} />\r\n\r\n\t\t\t\t\t\t{!rating ?\r\n\t\t\t\t\t\t\t<div className=\"RatingActions\">\r\n\t\t\t\t\t\t\t\t<FABButton colored className=\"Rate disliked danger\" onClick={this.dislikeClicked.bind(this, product)}><Sprite name=\"broken-heart\" /></FABButton>\r\n\t\t\t\t\t\t\t\t<FABButton colored className=\"Rate loved\" onClick={this.loveClicked.bind(this, product)}><Icon name=\"favorite\" /></FABButton>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t:\r\n\t\t\t\t\t\t\t<div className=\"RatingActions\">\r\n\t\t\t\t\t\t\t\t<Button onClick={this.undoRatingClicked.bind(this, product)}>\r\n\t\t\t\t\t\t\t\t\t{rating == 'disliked' ?\r\n\t\t\t\t\t\t\t\t\t\t<Sprite name=\"broken-heart\" />\r\n\t\t\t\t\t\t\t\t\t:\r\n\t\t\t\t\t\t\t\t\t\t<Icon name=\"favorite\" />\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tundo\r\n\t\t\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t{this.mayPublish(product) ?\r\n\t\t\t\t\t\t\t<div className=\"ModActions\">\r\n\t\t\t\t\t\t\t{published ?\r\n\t\t\t\t\t\t\t\t<FABButton className=\"Unpublish\" onClick={this.unpublishClicked.bind(this, product)}><Icon name=\"visibility_off\" /></FABButton>\r\n\t\t\t\t\t\t\t:\r\n\t\t\t\t\t\t\t\t<FABButton className=\"Publish\" onClick={this.publishClicked.bind(this, product)}><Icon name=\"visibility\" /></FABButton>\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t: ''}\r\n\r\n\t\t\t\t\t\t{this.mayToggleStock(product) ?\r\n\t\t\t\t\t\t\t<div className=\"ActorActions\">\r\n\t\t\t\t\t\t\t\t<Switch on={stocked} name={'stock' + product.id} sprite=\"stock\"\r\n\t\t\t\t\t\t\t\t\tonChange={this.toggleStockClicked.bind(this, product)} />\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t: ''}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</FrontFace>\r\n\t\t\t\t<BackFace>\r\n\t\t\t\t\t<CardTitle>\r\n\t\t\t\t\t\t<img className=\"BrandLogo\" src={brandUrl} />\r\n\t\t\t\t\t\t<h3 className=\"ProductName\">{name || 'Loading...'}</h3>\r\n\t\t\t\t\t</CardTitle>\r\n\t\t\t\t\t<div className=\"ProductGallery\">\r\n\t\t\t\t\t\t<div className=\"thumbs\">{images.map(({src, className}, i) => (\r\n\t\t\t\t\t\t\t<img key={i} className={classNames(className, 'thumb')}\r\n\t\t\t\t\t\t\t\t\tsrc={thumbnail} onClick={this.thumbnailClicked.bind(this, images, i)}\r\n\t\t\t\t\t\t\t\t\tstyle={{backgroundImage:`url(${thumbs})`}}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t))}</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<CardText className=\"ProductDescription\">{description || ''}</CardText>\r\n\t\t\t\t</BackFace>\r\n\t\t\t</StatefulFlipCard>\r\n\t\t);\r\n\t}\r\n}\r\nexport default ProductCard;\r\n\r\n//\t\t\t\t\t\t\t\t<FABButton className=\"Unclaim\" onClick={this.unclaimClicked.bind(this, product)}><Sprite name=\"disable-stock\" /></FABButton>\r\n//\t\t\t\t\t\t\t\t<FABButton className=\"Claim\" onClick={this.claimClicked.bind(this, product)}><Sprite name=\"stock\" /></FABButton>\r\n\r\n\r\n\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/components/Products/ProductCard.jsx\n **/","import log from 'picolog';\r\nimport { link } from 'redux-apis';\r\nimport { remote } from 'redux-fetch-api';\r\nimport Suid from 'ws.suid';\r\n\r\nimport { fromJSON, toJSON, toError, indexOf } from '../Entity/Entity';\r\nimport { Role } from '../Auth/Role';\r\nimport { PublicationApi } from '../Publication/api';\r\nimport { Product } from './Product';\r\nimport { StockItem } from './StockItem';\r\nimport { Rating } from './Rating';\r\n\r\n@remote\r\nexport class ProductsApi extends PublicationApi {\r\n\r\n\tstatic SET_STOCK = 'SET_STOCK';\r\n\r\n\tstatic INITIAL_STATE = {\r\n\t\t...PublicationApi.INITIAL_STATE,\r\n\t\tstockedItems: {}\r\n\t}\r\n\r\n\tconstructor(state = ProductsApi.INITIAL_STATE) {\r\n\t\tsuper(state);\r\n\t\tthis.setHandler(ProductsApi.SET_STOCK, (state, { payload }) => ({...state, stockedItems:payload}));\r\n\t\tObject.defineProperties(this, {\r\n\t\t\tstockedItems: {enumerable:true, get:() => this.getState().stockedItems},\r\n\t\t})\r\n\t\tthis.item.onLove = this.love.bind(this);\r\n\t\tthis.item.onDislike = this.dislike.bind(this);\r\n\t\tthis.item.onUndoRating = this.undoRating.bind(this);\r\n\t\tthis.item.onMayToggleStock = this.mayToggleStock.bind(this);\r\n\t\tthis.item.onIsStocked = this.isStocked.bind(this);\r\n\t\tthis.item.onToggleStock = this.toggleStock.bind(this);\r\n\t}\r\n\r\n\tsearchUrl(filter) {\r\n\t\tconst result = filter.category ? `/${filter.category}` : '/Wedding+Dresses';\r\n\t\tconst clone = { ...filter };\r\n\t\tdelete clone.category;\r\n\t\treturn result + super.searchUrl(clone);\r\n\t}\r\n\r\n\tsearch(params) {\r\n\t\tlog.log('search');\r\n\t\tconst store = this.getParent().stores.managedStore;\r\n\t\tconst storeLoaded = (store\r\n\t\t\t? Promise.resolve(store)\r\n\t\t\t: (this.auth.isAny(Role.STORE_ROLES)\r\n\t\t\t\t? this.getParent().stores.loadManagedStores().then(() => this.getParent().stores.managedStore)\r\n\t\t\t\t: Promise.resolve(null)\r\n\t\t\t)\r\n\t\t)\r\n\r\n\t\tconst stockLoaded = storeLoaded.then(store => {\r\n\t\t\tlog.debug('storeLoaded: ', store);\r\n\t\t\treturn store\r\n\t\t\t? this.loadStock(store)\r\n\t\t\t: Promise.resolve({})\r\n\t\t})\r\n\r\n\t\treturn stockLoaded.then(stock => {\r\n\t\t\tlog.debug('stockLoaded: ', stock);\r\n\t\t\treturn super.search(params)\r\n\t\t})\r\n\t}\r\n\r\n\trate(product, rating) {\r\n\t\tlog.log('rate', product, rating);\r\n\t\treturn this.fetch('/ratings', {\r\n\t\t\tmethod: 'POST',\r\n\t\t\theaders: {\r\n\t\t\t\t'Content-Type': 'application/json',\r\n\t\t\t},\r\n\t\t\tbody: toJSON(rating),\r\n\t\t})\r\n\t\t.then(response => response && response.status === 200 ? response.text() : toError(response))\r\n\t\t.then(text => fromJSON(text))\r\n\t\t.catch(error => {\r\n\t\t\tlog.error('Unable to create rating for product ' + product.id.toString() + ' ' + product.name + ' by ' + product.brandName + '.', error);\r\n\t\t});\r\n\t}\r\n\r\n\tunrate(product) {\r\n\t\tlog.log('unrate', product);\r\n\t\treturn this.fetch('/ratings', {\r\n\t\t\tmethod: 'DELETE',\r\n\t\t\theaders: {\r\n\t\t\t\t'Content-Type': 'application/json',\r\n\t\t\t},\r\n\t\t\tbody: toJSON(product),\r\n\t\t})\r\n\t\t.then(response => response && response.status === 200 ? response.text() : toError(response))\r\n\t\t.then(text => fromJSON(text))\r\n\t\t.catch(error => {\r\n\t\t\tlog.error('Unable to delete rating for product ' + product.id.toString() + ' ' + product.name + ' by ' + product.brandName + '.', error);\r\n\t\t});\r\n\t}\r\n\r\n\tlove(product) {\r\n\t\tlog.log('love', product);\r\n\t\treturn this.authenticated().then(session => {\r\n\t\t\tlog.debug('authenticated', session);\r\n\t\t\tconst rating = {id: Suid.next(), productId:product.id, accountId:session.user.id, score:'loved'};\r\n\t\t\treturn this.rate(product, new Rating(rating));\r\n\t\t})\r\n\t\t.catch(error => log.log('authentication failed.', error));\r\n\t}\r\n\r\n\tdislike(product) {\r\n\t\tlog.log('dislike', product);\r\n\t\treturn this.authenticated().then(session =>\r\n\t\t\tthis.rate(product, new Rating({id: Suid.next(), productId:product.id, accountId:session.user.id, score:'disliked'}))\r\n\t\t)\r\n\t}\r\n\r\n\tundoRating(product) {\r\n\t\tlog.log('undoRating', product);\r\n\t\treturn this.unrate(product);\r\n\t}\r\n\r\n\tloadStock(store) {\r\n\t\tlog.debug('loadStock', store);\r\n\t\treturn this.fetch(`/stock?storeId=${store.id.toString()}`)\r\n\t\t\t.then(response => response && response.status === 200 ? response.text() : toError(response))\r\n\t\t\t.then(text => fromJSON(text))\r\n\t\t\t.then(json => {\r\n\t\t\t\tlog.log('loadStock: OK got ' + json.length + ' results');\r\n\t\t\t\tconst stock = {};\r\n\t\t\t\tfor (let i=0, stockItem; stockItem=json[i]; i++) {\r\n\t\t\t\t\tstock[stockItem.productId.toString()] = stockItem;\r\n\t\t\t\t}\r\n\t\t\t\tthis.setStock(stock);\r\n\t\t\t\tlog.debug('loadStock: this.stockedItems=', this.stockedItems);\r\n\t\t\t\treturn stock;\r\n\t\t\t})\r\n\t\t\t.catch(error => log.error('loadStock: error=', error));\r\n\t}\r\n\r\n\tsetStock(stock) {\r\n\t\tlog.debug('setStock', stock);\r\n\t\treturn this.dispatch(this.createAction(ProductsApi.SET_STOCK)(stock));\r\n\t}\r\n\r\n\tmayToggleStock(product) {\r\n\t\tlog.trace('mayToggleStock', product);\r\n\t\tconst result = !!(this.getSession().user && this.getParent().stores.managedStore);\r\n\t\tlog.trace('mayToggleStock => ' + result);\r\n\t\treturn result;\r\n\t}\r\n\r\n\tisStocked(product) {\r\n\t\tlog.trace('isStocked', product);\r\n\t\tconst result = !!this.stockedItems[product.id.toString()];\r\n\t\tlog.trace('isStocked => ' + result);\r\n\t\treturn result;\r\n\t}\r\n\r\n\ttoggleStock(product) {\r\n\t\tconst pid = product.id.toString();\r\n\t\tconst store = this.getParent().stores.managedStore;\r\n\t\tif (!store) {return Promise.reject(new Error('No managed store selected'));}\r\n\r\n\t\tconst isStocked = this.isStocked(product);\r\n\t\tlog.debug('toggleStock', !isStocked, pid, store);\r\n\r\n\t\t// optimistically set new stock before making the server call, giving\r\n\t\t// ultra-fast response time. Save the old state so we can rollback\r\n\t\tconst stockItem = isStocked\r\n\t\t\t? this.stockedItems[pid]\r\n\t\t\t: new StockItem({id: Suid.next(), storeId:store.id, productId:product.id});\r\n\t\tlog.debug('toggleStock: stockItem=', stockItem);\r\n\t\tconst newStock = { ...this.stockedItems};\r\n\t\tif (isStocked) {delete newStock[pid];}\r\n\t\telse {newStock[pid] = stockItem;}\r\n\t\tthis.setStock(newStock);\r\n\t\tlog.debug('toggleStock: OPTIMISTIC: newStock=', newStock);\r\n\t\t// now make the server call. If it fails, we need to rollback\r\n\t\treturn this.fetch('/stock', {\r\n\t\t\tmethod: isStocked ? 'DELETE' : 'POST',\r\n\t\t\theaders: {\r\n\t\t\t\t'Content-Type': 'application/json',\r\n\t\t\t},\r\n\t\t\tbody: toJSON(stockItem),\r\n\t\t})\r\n\t\t.then(response => response && response.status === 200 ? response.text() : toError(response))\r\n\t\t.then(text => fromJSON(text))\r\n\t\t.then(stockItem => {\r\n\t\t\tlog.debug('toggleStock: COMMIT: newStock=', newStock);\r\n\t\t\t// commit\r\n\t\t\t// in case of DELETE, nothing needs to be done\r\n\t\t\t// in case of CREATE, replace the stockItem with the saved one\r\n\t\t\tif (! isStocked) {this.setStock({ ...this.stockedItems, [pid]: stockItem });}\r\n\t\t\treturn stockItem;\r\n\t\t})\r\n\t\t.catch(error => {\r\n\t\t\tlog.error('Unable to toggle stock for product ' + product.id.toString() + ' ' + product.name + ' by ' + product.brandName + '.', error);\r\n\t\t\t// rollback\r\n\t\t\t// in case of DELETE, replace the stockItem with the original one\r\n\t\t\t// in case of CREATE, delete the stockItem again\r\n\t\t\tconst newStock = { ...this.stockedItems};\r\n\t\t\tif (isStocked) {newStock[pid] = stockItem}\r\n\t\t\telse {delete newStock[pid];}\r\n\t\t\tthis.setStock(newStock);\r\n\t\t});\r\n\t}\r\n}\r\nexport default ProductsApi;\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/components/Products/api.jsx\n **/","import log from 'picolog';\r\nimport React, { Component, PropTypes } from 'react';\r\nconst { bool, object, func, array, shape, any } = PropTypes;\r\nimport shallowEqual from 'fbjs/lib/shallowEqual';\r\nimport { connect } from 'react-redux';\r\nimport { onload } from 'redux-load-api';\r\nimport { Icon } from 'react-mdl';\r\n\r\nimport store from '../../store';\r\nimport AppApi from '../App/api'; // explicitly import to facilitate hot-reloading.\r\n\r\nimport FilterPanel from '../Entity/FilterPanel';\r\nimport { Badge } from '../Mdl/mdl-extras';\r\nimport Scroller from '../Scroller/Scroller';\r\nimport StoreCard from './StoreCard'\r\n\r\nfunction load(params) {\r\n\tlog.log('load', params);\r\n\treturn bridalapp.stores.search(params)\r\n\t\t.then(results => {\r\n\t\t\tlog.log('load: search returned ' + results.length + ' stores.');\r\n\t\t\treturn results;\r\n\t\t})\r\n\t\t.catch((error) => {\r\n\t\t\tlog.error('Searching stores failed.', error);\r\n\t\t\treturn error;\r\n\t\t});\r\n}\r\n\r\n@onload(load)\r\n@connect(bridalapp.stores.connector)\r\nexport class StoreBrowser extends React.Component {\r\n\tstatic propTypes = {\r\n\t\tparams: object.isRequired,\r\n\t\tlocation: shape({\r\n\t\t\tquery: object,\r\n\t\t}).isRequired,\r\n\t\tfilter: shape({\r\n\t\t\tvalues: object.isRequired,\r\n\t\t}).isRequired,\r\n\t\titems: array.isRequired,\r\n\t\tpending: bool.isRequired,\r\n\t\terror: any,\r\n\t\tonSearch: func.isRequired,\r\n\t\tonItemsChange: func.isRequired,\r\n\t\titem: shape({\r\n\t\t\tonMayPublish: func.isRequired,\r\n\t\t\tonPublish: func.isRequired,\r\n\t\t\tonUnpublish: func.isRequired,\r\n\t\t}).isRequired,\r\n\t}\r\n\r\n\tcomponentDidMount() {\r\n\t\tlog.debug('componentDidMount()');\r\n\t\tconst { pending, error, params } = this.props;\r\n\t\tif (pending || error) {load(params);}\r\n\t}\r\n\r\n\tcomponentWillReceiveProps(nextProps) {\r\n\t\tlog.debug('componentWillReceiveProps', nextProps);\r\n\t\tconst newFilter = {...nextProps.location.query, ...nextProps.params};\r\n\t\tconst pathChanged = nextProps.location.pathname !== this.props.location.pathname;\r\n\t\tconst queryChanged = !shallowEqual(nextProps.location.query, this.props.location.query);\r\n\t\tif (pathChanged || queryChanged || (nextProps.pending && !this.props.pending)) {\r\n\t\t\tload(newFilter);\r\n\t\t}\r\n\t}\r\n\r\n\trender() {\r\n\t\tlog.debug('render', this.props);\r\n\t\tconst { params, location, filter, onSearch, pending, error, items, onItemsChange, item } = this.props;\r\n\t\tconst filterProps = {onSearch, location, ...filter};\r\n\r\n\t\treturn (\r\n\t\t\t<div style={{boxSizing:'border-box', height:'100%'}}>\r\n\t\t\t\t<FilterPanel {...filterProps} />\r\n\t\t\t\t<Scroller\r\n\t\t\t\t\tclassName=\"StoreBrowser\"\r\n\t\t\t\t\tbufferBefore={4}\r\n\t\t\t\t\titems={items}\r\n\t\t\t\t\tbufferAfter={8}\r\n\t\t\t\t\trenderItem ={ (store, idx) => {\r\n\t\t\t\t\t\tconst props = {store, ...item, frontLoadDelay: idx < 10 ? 0 : 500, backLoadDelay: idx < 10 ? 0 : 2500};\r\n\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t<StoreCard {...props} />\r\n\t\t\t\t\t\t)\r\n\t\t\t\t\t}}\r\n\t\t\t\t/>\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n}\r\nexport default StoreBrowser;\r\n\r\n@connect(bridalapp.stores.connector)\r\nexport class StoreBrowserAppBar extends Component {\r\n\tstatic propTypes = {\r\n\t\tfilter: shape({\r\n\t\t\topen: bool.isRequired,\r\n\t\t\tonActivate: func.isRequired,\r\n\t\t\tonCancel: func.isRequired,\r\n\t\t}).isRequired,\r\n\t\titems: array.isRequired,\r\n\t}\r\n\r\n\tconstructor(...args) {\r\n\t\tsuper(...args);\r\n\t\tthis.filterClicked = this.filterClicked.bind(this);\r\n\t}\r\n\r\n\tfilterClicked(event) {\r\n\t\tlog.log('filterClicked', event);\r\n\t\tif (event) {event.preventDefault();}\r\n\t\tconst { open, onActivate, onCancel } = this.props.filter;\r\n\t\topen ? onCancel() : onActivate();\r\n\t}\r\n\r\n\trender() {\r\n\t\treturn (\r\n\t\t\t<Badge className=\"mdl-navigation__link\" text={'' + this.props.items.length} onClick={this.filterClicked}>\r\n\t\t\t\t<Icon name=\"search\" />\r\n\t\t\t</Badge>\r\n\t\t)\r\n\t}\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/components/Stores/StoreBrowser.jsx\n **/","import log from 'picolog';\r\nimport React, { Component, PropTypes } from 'react';\r\nconst { any, bool, string, object, func, shape } = PropTypes;\r\nimport classNames from 'classnames';\r\nimport { CardTitle, CardText, FABButton, Icon } from 'react-mdl';\r\nimport Suid from 'ws.suid';\r\nimport { StatefulFlipCard, FrontFace, BackFace } from '../Mdl/mdl-extras';\r\nimport Publication from '../Publication/Publication';\r\n\r\nexport class StoreCard extends Publication {\r\n\tstatic propTypes = {\r\n\t\tstore: shape({\r\n\t\t\tid: any,\r\n\t\t\tname: string,\r\n\t\t\tdescription: string,\r\n\t\t\taddress1: string,\r\n\t\t\taddress2: string,\r\n\t\t\tpostalCode: string,\r\n\t\t\tcity: string,\r\n\t\t\tstate: string,\r\n\t\t\tcountryCode: string,\r\n\t\t\ttelephone: string,\r\n\t\t\twebsite: string,\r\n\t\t\temail: string,\r\n\t\t\tpremium: bool.isRequired,\r\n\t\t}).isRequired,\r\n\t\tmayImpersonate: bool.isRequired,\r\n\t\tonImpersonate: func.isRequired,\r\n\t}\r\n\r\n\tconstructor(...props) {\r\n\t\tsuper(...props);\r\n\t\tthis.state = {logoMissing:false, thumbMissing:false};\r\n\t}\r\n\r\n\timpersonateClicked(store, event) {\r\n\t\tlog.log('impersonate', store, event);\r\n\t\tevent.preventDefault();\r\n\t\tthis.props.onImpersonate(store);\r\n\t}\r\n\r\n\trender() {\r\n\t\tlog.debug('render', this.props);\r\n\t\tconst { store, mayImpersonate } = this.props;\r\n\t\tconst { id, name, description, address1, address2, postalCode, city, state, countryCode, telephone, website, premium, published } = store;\r\n\t\tconst sid = id.toString();\r\n\t\tconst logo = `https://cdn.rawgit.com/Download/bridalapp-static/1.0.16/stores/${sid}/logo.png`;\r\n\t\tconst thumb = `https://cdn.rawgit.com/Download/bridalapp-static/1.0.16/stores/${sid}/thumb.jpg`;\r\n\t\tconst classes = classNames('Store', {'premium':premium, 'unpublished':!published});\r\n\t\tconst publishButton = this.mayPublish(store) ? (published\r\n\t\t\t? <FABButton className=\"Unpublish\" onClick={this.unpublishClicked.bind(this, store)}><Icon name=\"visibility_off\" /></FABButton>\r\n\t\t\t: <FABButton className=\"Publish\" onClick={this.publishClicked.bind(this, store)}><Icon name=\"visibility\" /></FABButton>\r\n\t\t):'';\r\n\t\tconst impersonateButton = mayImpersonate ?\r\n\t\t\t<FABButton className=\"Impersonate\" onClick={this.impersonateClicked.bind(this, store)}><Icon name=\"verified_user\" /></FABButton>\r\n\t\t:'';\r\n\t\treturn (\r\n\t\t\t<StatefulFlipCard className={classes} key={sid}>\r\n\t\t\t\t<FrontFace>\r\n\t\t\t\t\t<CardTitle>\r\n\t\t\t\t\t\t{this.state.logoMissing ?\r\n\t\t\t\t\t\t\t<h3 className=\"StoreLogoAlt\">{name}</h3>\r\n\t\t\t\t\t\t:\r\n\t\t\t\t\t\t\t<img className=\"StoreLogo\" src={logo}\r\n\t\t\t\t\t\t\t\tonError={()=>this.setState({...this.state, logoMissing:true})} />\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t</CardTitle>\r\n\t\t\t\t\t<div className=\"mdl-card__content\">\r\n\t\t\t\t\t\t{this.state.thumbMissing ?\r\n\t\t\t\t\t\t\t<div className=\"StoreThumbAlt\"></div>\r\n\t\t\t\t\t\t:\r\n\t\t\t\t\t\t\t<img className=\"StoreThumb\" src={thumb}\r\n\t\t\t\t\t\t\t\tonError={()=>this.setState({...this.state, thumbMissing:true})} />\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t<CardText className=\"StoreDescription\">\r\n\t\t\t\t\t\t\t{description}\r\n\t\t\t\t\t\t</CardText>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t{mayImpersonate || this.mayPublish(store) ?\r\n\t\t\t\t\t\t<div className=\"ModActions\">\r\n\t\t\t\t\t\t\t{publishButton}\r\n\t\t\t\t\t\t\t{impersonateButton}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t:''}\r\n\t\t\t\t</FrontFace>\r\n\t\t\t\t<BackFace>\r\n\t\t\t\t\t<CardTitle>\r\n\t\t\t\t\t\t{this.state.logoMissing ?\r\n\t\t\t\t\t\t\t<h3 className=\"StoreLogoAlt\">{name}</h3>\r\n\t\t\t\t\t\t:\r\n\t\t\t\t\t\t\t<img style={{filter:'grayscale(1)'}} className=\"StoreLogo\" src={logo} onError={()=>this.setState({...this.state, logoMissing:true})} />\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t</CardTitle>\r\n\t\t\t\t\t<p>{description}</p>\r\n\t\t\t\t\t<address>\r\n\t\t\t\t\t\t{address1}<br/>\r\n\t\t\t\t\t\t{address2}<br/>\r\n\t\t\t\t\t\t{city}\r\n\t\t\t\t\t</address>\r\n\t\t\t\t</BackFace>\r\n\t\t\t</StatefulFlipCard>\r\n\t\t);\r\n\t}\r\n}\r\nexport default StoreCard;\n\n\n/** WEBPACK FOOTER **\n ** ./src/components/Stores/StoreCard.jsx\n **/","import log from 'picolog';\r\nimport { Api, link } from 'redux-apis';\r\nimport { remote } from 'redux-fetch-api';\r\n\r\nimport { Role } from '../Auth/Role';\r\nimport { authenticated } from '../Auth/api';\r\nimport { PublicationApi } from '../Publication/api';\r\nimport { fromJSON, toError } from '../Entity/Entity';\r\nimport Store from './Store';\r\n\r\n@remote\r\n@authenticated\r\nexport class StoresApi extends PublicationApi {\r\n\tstatic INITIAL_STATE = {\r\n\t\t...PublicationApi.INITIAL_STATE,\r\n\t\tmanagedStores: [],\r\n\t\tmanagedStoreIndex: 0,\r\n\t}\r\n\r\n\tstatic SET_MANAGED_STORES = 'SET_MANAGED_STORES';\r\n\tstatic SET_MANAGED_STORE_INDEX = 'SET_MANAGED_STORE_INDEX';\r\n\r\n\tconstructor(state = StoresApi.INITIAL_STATE) {\r\n\t\tsuper(state);\r\n\r\n\t\tthis.setHandler(StoresApi.SET_MANAGED_STORES, (state, {payload}) => ({...state, managedStores:payload}));\r\n\t\tthis.setHandler(StoresApi.SET_MANAGED_STORE_INDEX, (state, {payload}) => ({...state, managedStoreIndex:payload}));\r\n\r\n\t\tObject.defineProperties(this, {\r\n\t\t\tmanagedStores: {enumerable:true, get:() => this.getState().managedStores},\r\n\t\t\tmanagedStoreIndex: {enumerable:true, get:() => this.getState().managedStoreIndex},\r\n\t\t\tmanagedStore: {enumerable:true, get:() => this.managedStores[this.managedStoreIndex]},\r\n\t\t});\r\n\r\n\t\tObject.defineProperties(this.item, {\r\n\t\t\tmayImpersonate: {enumerable:true, get:() => this.auth.is(Role.ADMINISTRATOR) || this.auth.isAny(Role.BRAUTSCHLOSS_ROLES)},\r\n\t\t\tonImpersonate: {enumerable:true, value:this.impersonate.bind(this)},\r\n\t\t});\r\n\t}\r\n\r\n\tsetManagedStores(stores) {\r\n\t\treturn this.dispatch(this.createAction(StoresApi.SET_MANAGED_STORES)(stores));\r\n\t}\r\n\r\n\tsetManagedStoreIndex(index) {\r\n\t\treturn this.dispatch(this.createAction(StoresApi.SET_MANAGED_STORE_INDEX)(index));\r\n\t}\r\n\r\n\tloadManagedStores() {\r\n\t\tlog.debug('loadManagedStores');\r\n\t\treturn this.fetch('/managed')\r\n\t\t\t.then(response => response && response.status === 200\r\n\t\t\t\t? response.text()\r\n\t\t\t\t: response.text().then(text => toError(text))\r\n\t\t\t)\r\n\t\t\t.then(text => fromJSON(text))\r\n\t\t\t.then(json => {\r\n\t\t\t\tlog.debug('loadManagedStores: OK got ' + json.length + ' results');\r\n\t\t\t\tthis.setManagedStores(json);\r\n\t\t\t\tlog.debug('loadManagedStores: this.managedStores=', this.managedStores);\r\n\t\t\t\treturn json;\r\n\t\t\t})\r\n\t\t\t.catch(error => {\r\n\t\t\t\tlog.error('loadManagedStores: error=', error);\r\n\t\t\t});\r\n\t}\r\n\r\n\timpersonate(store) {\r\n\t\tthis.setManagedStores([store]);\r\n\t\tthis.setManagedStoreIndex(0);\r\n\t\tthis.getParent().products.loadStock(this.managedStore);\r\n\t}\r\n}\r\nexport default StoresApi;\n\n\n/** WEBPACK FOOTER **\n ** ./src/components/Stores/api.jsx\n **/","import log from 'picolog';\r\nimport React from 'react';\r\nimport { Route, IndexRoute, IndexRedirect } from 'react-router';\r\n\r\nimport App from './components/App/App';\r\nimport Home from './components/Home/Home';\r\nimport ProductBrowser, { ProductBrowserAppBar } from './components/Products/ProductBrowser';\r\n// import ProductEdit from './components/Products/ProductEdit';\r\n// import ProductDetails from './components/Products/ProductDetails';\r\nimport BrandBrowser, { BrandBrowserAppBar } from './components/Brands/BrandBrowser';\r\n// import Stores from './components/Stores/Stores';\r\nimport StoreBrowser, { StoreBrowserAppBar } from './components/Stores/StoreBrowser';\r\n// import StoreDetails from './components/Stores/StoreDetails';\r\n// import { LayoutTest, ComponentA, ComponentB } from './components/Layout/Layout';\r\n\r\nexport const routes = (\r\n\t<Route path=\"/\" component={App}>\r\n\r\n\t\t// redirect to 'Wedding Dresses' for the time being\r\n\t\t// until we get a decent homepage\r\n\t\t<IndexRedirect to=\"/Wedding+Dresses\" />\r\n\r\n\t\t<Route path=\"/brands\" \t\t\t\tcomponents={{appbarComponent: BrandBrowserAppBar,\t\tmainComponent: BrandBrowser}} />\r\n\t\t<Route path=\"/stores\" \t\t\t\tcomponents={{appbarComponent: StoreBrowserAppBar,\t\tmainComponent: StoreBrowser}} />\r\n\r\n\t\t// products are mounted at the root, but you must always specify\r\n\t\t// a category, so as long as category names do not conflict with\r\n\t\t// root paths, this will work.\r\n\t\t// so don't create a category 'stores'  :)\r\n\t\t// TODO, probably if we hardcode the only two ratings,\r\n\t\t// 'loved' and 'disliked', we will open up more options\r\n\t\t// for short URLs, such as\r\n\t\t// '/:category/:country'\r\n\t\t// '/:category/:country/:city'\r\n\t\t<Route path=\"/:rating/:category\"\tcomponents={{appbarComponent: ProductBrowserAppBar,\t\tmainComponent: ProductBrowser}} />\r\n\t\t<Route path=\"/:category\"\t\t\tcomponents={{appbarComponent: ProductBrowserAppBar,\t\tmainComponent: ProductBrowser}} />\r\n\t</Route>\r\n);\r\n\r\n/*\r\n\t\t<Route path=\"/layout\" component={LayoutTest}>\r\n\t\t\t<IndexRedirect to=\"/layout/a\" />\r\n\t\t\t<Route path=\"a\" component={ComponentA} />\r\n\t\t\t<Route path=\"b\" component={ComponentB} />\r\n\t\t</Route>\r\n\r\n\t\t// we start with all routes that are not mounted at the root\r\n\t\t// so they will be matched before the products section,\r\n\t\t// which is mounted at the root.\r\n\t\t<Route path=\"/brands\" component={Brands} >\r\n\t\t\t<IndexRoute component={BrandBrowser} />\r\n\t\t</Route>\r\n\r\n\t\t<Route path=\"/stores\" component={Stores} >\r\n\t\t\t// not implemented yet\r\n\t\t\t<Route path=\":city/:name\" component={ProductDetails} />\r\n\r\n\t\t\t<IndexRoute component={StoreBrowser} />\r\n\t\t</Route>\r\n\r\n\t\t// products are mounted at the root, but you must always specify\r\n\t\t// a category, so as long as category names do not conflict with\r\n\t\t// root paths, this will work.\r\n\t\t// so don't create a category 'stores'  :)\r\n\t\t<Route component={Products} >\r\n\t\t\t// TODO, probably if we hardcode the only two ratings,\r\n\t\t\t// 'loved' and 'disliked', we will open up more options\r\n\t\t\t// for short URLs, such as\r\n\t\t\t// '/:category/:country'\r\n\t\t\t// '/:category/:country/:city'\r\n\t\t\t<Route path=\"/:rating/:category\" component={ProductBrowser} />\r\n\t\t\t<Route path=\"/:category\" component={ProductBrowser} />\r\n\t\t</Route>\r\n*/\r\n\r\nexport default routes;\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/routes.jsx\n **/","// client scripts, will be loaded async from the head of the document\r\n// each stage will only start loading once the previous stage has completed\r\nexport function scripts(version) {return process.env.NODE_ENV == 'production'\r\n\t? [ \t// PRODUCTION\r\n\t\t{\t// stage 0, no dependencies\r\n\t\t\tReact: 'https://cdnjs.cloudflare.com/ajax/libs/react/15.0.1/react.min.js',\r\n\t\t\tfetch: 'https://cdnjs.cloudflare.com/ajax/libs/fetch/0.11.0/fetch.min.js',\r\n\t\t\tcomponentHandler: 'https://cdn.rawgit.com/tleunen/react-mdl/v1.5.2/extra/material.min.js',\r\n\t\t},\r\n\t\t{\t// stage 1, depends on stage 0\r\n\t\t\tReactDOM: 'https://cdnjs.cloudflare.com/ajax/libs/react/15.0.1/react-dom.min.js',\r\n\t\t},\r\n\t\t{\t// stage 2, depends on stage 1\r\n\t\t\tReactRouter: 'https://cdnjs.cloudflare.com/ajax/libs/react-router/2.3.0/ReactRouter.min.js',\r\n\t\t\tReactMDL: 'https://unpkg.com/react-mdl@1.5.2/out/ReactMDL.min.js',\r\n\t\t\tbridalapp_initial_state: '', // make sure store state is loaded\r\n\t\t},\r\n\t\t{\t// stage 3, depends on stage 2\r\n\t\t\tbridalapp: '/assets/bridalapp-ui.js?v' + version\r\n\t\t}\r\n\t]\r\n\t: [ \t// DEVELOPMENT\r\n\t\t{\t// stage 0, no dependencies\r\n\t\t\tReact: 'https://cdnjs.cloudflare.com/ajax/libs/react/15.0.1/react.js',\r\n\t\t\tfetch: 'https://cdnjs.cloudflare.com/ajax/libs/fetch/0.11.0/fetch.js',\r\n\t\t\tcomponentHandler: '/material.js',\r\n\t\t},\r\n\t\t{\t// stage 1, depends on stage 0\r\n\t\t\tReactDOM: 'https://cdnjs.cloudflare.com/ajax/libs/react/15.0.1/react-dom.js',\r\n\t\t},\r\n\t\t{\t// stage 2, depends on stage 1\r\n\t\t\tReactRouter: 'https://cdnjs.cloudflare.com/ajax/libs/react-router/2.3.0/ReactRouter.js',\r\n\t\t\tReactMDL: 'https://unpkg.com/react-mdl@1.5.2/out/ReactMDL.min.js',\r\n\t\t\tbridalapp_initial_state: '', // make sure store state is loaded\r\n\t\t},\r\n\t\t{\t// stage 3, depends on stage 2\r\n\t\t\tbridalapp: '/assets/bridalapp-ui.js?v' + version\r\n\t\t}\r\n\t]\r\n}\r\nexport default scripts;\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/scripts.jsx\n **/","require('babel-polyfill');\r\nglobal.fetch = require('node-fetch');\r\nimport chalk from 'chalk';\r\nimport Express from 'express';\r\nimport compress from 'compression';\r\nimport cookieParser from 'cookie-parser';\r\nimport http from 'http';\r\nimport httpProxy from 'http-proxy';\r\nimport log from 'picolog';\r\nimport React from 'react';\r\nimport ReactDOM from 'react-dom/server';\r\nimport { match } from 'react-router';\r\nimport { RouterContext } from 'react-router';\r\nimport { Provider } from 'react-redux';\r\nimport { load } from 'redux-load-api';\r\n\r\nimport cfg from '../config';\r\nimport store from './store';\r\nconst express = new Express();\r\nconst httpServer = new http.Server(express);\r\n\r\nconst g=chalk.green, gb=chalk.green.bold,  y=chalk.yellow, yb=chalk.yellow.bold,\r\n\tw=chalk.white, wb=chalk.white.bold, gr=chalk.grey,  grb=chalk.grey.bold,\r\n\tr=chalk.red, rb=chalk.red.bold;\r\n\r\n// Enable gzip compresion\r\n// express.use(compress());\r\n\r\n// parses request cookies\r\nexpress.use(cookieParser());\r\n\r\n\r\n// if the server is started in hot mode, we include webpack-dev-middleware\r\n// and webpack-hot-middleware to serve a hot bundle to the client. In\r\n// production mode, we serve up a static pre-compiled client bundle\r\nif (module.hot) {\r\n\t// use require because it will be optimized out if !module.hot\r\n\tconst webpack = require('webpack');\r\n\tconst devMiddleware = require('webpack-dev-middleware');\r\n\tconst hotMiddleware = require('webpack-hot-middleware');\r\n\tconst stats = {colors:true, chunks:false, hash:false, version:false};\r\n\tconst clientCfg = require('../webpack/development.client.config');\r\n\tconst clientCompiler = webpack(clientCfg);\r\n\texpress.use(devMiddleware(clientCompiler, {stats, publicPath:clientCfg.output.publicPath}));\r\n\texpress.use(hotMiddleware(clientCompiler));\r\n}\r\n\r\n// We point to our static assets\r\nexpress.use(Express.static(cfg.publicPath));\r\n\r\n// polled by OpenShift haproxy load balancer to test server availability\r\nexpress.get('/status', (req, res) => {\r\n\tres.writeHead(200, {'Content-Type': 'text/html; charset=UTF-8'});\r\n\tres.end(`<!DOCTYPE html>\r\n<html>\r\n<head>\r\n\t<title>Status</title>\r\n</head>\r\n<body>\r\n\t<h1 style=\"color:green\">ONLINE</h1>\r\n\t<p>${cfg.server.name} is ONLINE</p>\r\n</body>\r\n</html>`);\r\n});\r\n\r\nexpress.get(/\\/.*/, (req, res, next) => {\r\n\t// Reset the store prior to each request\r\n\tstore.dispatch({type:'@@bridalapp/RESET'});\r\n\t// require again on each request, to enable hot-reload in development mode.\r\n\t// In production, this will just grab the module from require.cache.\r\n\tconst scripts = require('./scripts').scripts;\r\n\tconst routes = require('./routes').routes;\r\n\tconst markupBefore = require('./markup').markupBefore;\r\n\tconst markupAfter = require('./markup').markupAfter;\r\n\tconst AppApi = require('./components/App/api').AppApi;\r\n\tconst App = require('./components/App/App').App;\r\n\r\n\r\n\t// match the current URL against defined routes\r\n\tmatch({routes:routes, location:req.originalUrl}, (error, redirectLocation, renderProps) => {\r\n\t\tif (redirectLocation) {\r\n\t\t\tres.redirect(redirectLocation.pathname + redirectLocation.search);\r\n\t\t\tres.end();\r\n\t\t}\r\n\t\telse if (error) {\r\n\t\t\tlog.warn(rb('ROUTER ERROR:'), pretty.render(error));\r\n\t\t\tres.status(500);\r\n\t\t\tres.send('Server error.');\r\n\t\t\tres.end();\r\n\t\t}\r\n\t\telse if (!renderProps) {\r\n\t\t\tres.status(404);\r\n\t\t\tres.send('Not Found.');\r\n\t\t\tres.end();\r\n\t\t}\r\n\t\telse {\r\n\t\t\tlog.debug(chalk.styles.gray.open, 'Rendering using props: ', renderProps, chalk.styles.gray.close);\r\n\r\n\t\t\t// RENDER MARKUP BEFORE\r\n\t\t\t// eagerly send 200 status and the head of the document to improve first render speed\r\n\t\t\t// this will start off script loading on the client asap.\r\n\t\t\tres.status(200);\r\n\t\t\tres.write(markupBefore(cfg.version, cfg.apiServer.url, scripts(cfg.version)));\r\n\r\n\t\t\t// LOAD SESSION\r\n\t\t\t// Store session cookie so we can attach it to fetch calls\r\n\t\t\tglobal.session = req.cookies && req.cookies.BASESSION;\r\n\t\t\tglobal.session && log.log('stored session cookie: ' + global.session);\r\n\t\t\tPromise.resolve(global.session ? store.app.auth.loadSession() : {sessionId:null, user:null}).then(session => {\r\n\t\t\t\tlog.debug('loaded session: ', session);\r\n\r\n\t\t\t\t// LOAD DATA\r\n\t\t\t\t// pre-load onload actions\r\n\t\t\t\tconst { routes, params, location: { query } } = renderProps;\r\n\t\t\t\tconst loadParams = {...query, ...params};\r\n\t\t\t\tconst components = routes\r\n\t\t\t\t\t.reduce((r,x) => {r.push.apply(r, x.component && [x.component] || Object.values(x.components)); return r;}, [])\r\n\t\t\t\t\t.filter(component => component && (typeof component.onload == 'function'));\r\n\t\t\t\tlog.log('pre-loading data for ', components);\r\n\t\t\t\treturn load(components, loadParams);\r\n\t\t\t})\r\n\t\t\t.then(() => {\r\n\t\t\t\t// do awesome stuff knowing all promises (if any) are resolved\r\n\t\t\t\tlog.debug('pre-load complete, rendering markup');\r\n\r\n\t\t\t\t// RENDER REACT APP\r\n\t\t\t\t// Render the fully hydrated React app and send it to the client\r\n\t\t\t\tres.write(ReactDOM.renderToString(\r\n\t\t\t\t\t<Provider store={store}>\r\n\t\t\t\t\t\t<RouterContext {...renderProps} />\r\n\t\t\t\t\t</Provider>\r\n\t\t\t\t));\r\n\r\n\t\t\t\t// RENDER MARKUP AFTER\r\n\t\t\t\t// Send the current store state along with the ending markup\r\n\t\t\t\tres.write(markupAfter(store.getState()));\r\n\r\n\t\t\t\t// FINISH RENDERING\r\n\t\t\t\tres.end();\r\n\t\t\t\tlog.debug('rendering complete');\r\n\t\t\t\treturn true;\r\n\t\t\t})\r\n\t\t\t.catch((error) => {\r\n\t\t\t\tlog.error('Error rendering ' + req.originalUrl + ': ', error, error.stack);\r\n\t\t\t\tres.status(500);\r\n\t\t\t\tres.send('Server error.');\r\n\t\t\t\tres.end();\r\n\t\t\t});\r\n\t\t}\r\n\t});\r\n});\r\n\r\n\r\nvar server = cfg.server.host\r\n\t? httpServer.listen(cfg.server.port, cfg.server.host, serverStartup)\r\n\t: httpServer.listen(cfg.server.port, serverStartup);\r\n\r\nfunction serverStartup(error) {\r\n\tif (error) {throw error;}\r\n\tvar addr = httpServer.address();\r\n\tlog.warn();\r\n\tif (module.hot) {\r\n\t\tlog.warn(yb(' !  ') + g('Running in ') + gb('development') + g(' mode. ') + (module.hot ? yb('Hot Module Replacement') + g(' is enabled.') : ''));\r\n\t} else {\r\n\t\tlog.warn(gb(' √  ') + g('Running in ') + gb('production') + g(' mode. ') + gb('gzip compression') + g(' is enabled.'));\r\n\t}\r\n\tlog.warn(gb(' √  ') + g('Talking to ') + gb(cfg.apiServer.name) + g(' at ') + gb(cfg.apiServer.url));\r\n\tlog.warn(gb(' √  ') + g('Listening for connections at ') + gb(cfg.server.protocol + addr.address + (addr.port == 80 ? '' : ':' + addr.port)));\r\n\tlog.warn(gb(' √  %s started succesfully ') + g('on %s.'), cfg.server.name, Date(Date.now()));\r\n\tlog.warn('');\r\n}\r\n\r\nvar msg;\r\nvar SIGNALS = ['SIGHUP', 'SIGINT', 'SIGQUIT', 'SIGILL', 'SIGTRAP', 'SIGABRT', 'SIGBUS', 'SIGFPE', 'SIGUSR1', 'SIGSEGV', 'SIGUSR2', 'SIGTERM'];\r\nSIGNALS.forEach(function(signal) {process.on(signal, function(){\r\n\tlog.warn(msg = (rb(' ×  ') + g('Stopping ') + gb(cfg.server.name) + g(' after receiving ') + yb(signal) + g('.')));\r\n\tserver.close();\r\n    process.exit();\r\n})});\r\nprocess.on('uncaughtException', function(error){\r\n\tlog.warn(msg = (rb(' ×  ') + g('Uncaught exception ') + yb(error) + g('.')));\r\n});\r\nprocess.on('exit', function() {log.warn(msg = (gb(' √  ') + g('Stopped ') + gb(cfg.server.name) + g(' on ' + Date(Date.now()) + '.\\r\\n')));});\r\n\r\nif (module.hot) {\r\n\tmodule.hot.accept('./scripts', function(){\r\n        log.warn(yb('Hot reloading ') + g('\\'./scripts\\'...'));\r\n\r\n\t});\r\n\tmodule.hot.accept('./store', function(){\r\n        log.warn(yb('Hot reloading ') + g('\\'./store\\'...'));\r\n\t});\r\n\tmodule.hot.accept('./routes', function(){\r\n        log.warn(yb('Hot reloading ') + g('\\'./routes\\'...'));\r\n\t});\r\n\tmodule.hot.accept('./markup', function(){\r\n        log.warn(yb('Hot reloading ') + g('\\'./markup\\'...'));\r\n\t});\r\n\tmodule.hot.accept('./components/App/api', function(){\r\n        log.warn(yb('Hot reloading ') + g('\\'./components/App/api\\'...'));\r\n\t});\r\n\tmodule.hot.accept('./components/App/App', function(){\r\n        log.warn(yb('Hot reloading ') + g('\\'./components/App/App\\'...'));\r\n\t});\r\n\r\n/*  SHOULD BE POSSIBLE BUT CAN'T GET IT TO WORK RELIABLY\r\n\t// self-accept. This allows hot-reload of this very file. We cleanup in the\r\n\t// dispose handler and then the server will be restarted.\r\n\tmodule.hot.accept();\r\n\t// dispose handler\r\n    module.hot.dispose(function() {\r\n\t\tserver.close(function(){\r\n\t\t\tlog.warn(g('Closed HTTP server listening on port ') + g(cfg.server.port));\r\n\t\t});\r\n    });\r\n*/\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/server.jsx\n **/","module.exports = {\n\t\"name\": \"bridalapp-ui\",\n\t\"version\": \"1.0.10\",\n\t\"description\": \"User Interface for BridalApp\",\n\t\"keywords\": [\n\t\t\"OpenShift\",\n\t\t\"Node.js\",\n\t\t\"BridalApp\"\n\t],\n\t\"main\": \"server.js\",\n\t\"babel\": {\n\t\t\"presets\": [\n\t\t\t\"es2015\",\n\t\t\t\"stage-0\",\n\t\t\t\"react\"\n\t\t],\n\t\t\"plugins\": [\n\t\t\t\"transform-decorators-legacy\",\n\t\t\t\"transform-class-properties\"\n\t\t]\n\t},\n\t\"homepage\": \"http://www.bridalapp.net/\",\n\t\"repository\": {\n\t\t\"type\": \"git\",\n\t\t\"url\": \"https://github.com/download/bridalapp-ui\"\n\t},\n\t\"scripts\": {\n\t\t\"clean-server\": \"rimraf hmr && rimraf server.js\",\n\t\t\"clean-client\": \"rimraf public/assets/bridalapp-ui.js\",\n\t\t\"clean\": \"npm run clean-server && npm run clean-client\",\n\t\t\"start\": \"node server.js\",\n\t\t\"start-dev\": \"just-wait -p \\\"server.js\\\" && npm run start\",\n\t\t\"build-server\": \"webpack --config webpack/server.config.js\",\n\t\t\"build-client\": \"webpack --config webpack/client.config.js\",\n\t\t\"build\": \"npm run build-server && npm run build-client\",\n\t\t\"release-server\": \"npm run clean-server && npm run build-server\",\n\t\t\"release-client\": \"npm run clean-client && npm run build-client\",\n\t\t\"release\": \"npm run clean && npm run build\",\n\t\t\"watch\": \"webpack --inline --watch --hide-modules --config webpack/development.server.config.js\",\n\t\t\"run-dev\": \"npm run -s clean && parallelshell \\\"npm run -s watch\\\" \\\"npm run -s start-dev\\\"\",\n\t\t\"dev\": \"cross-env PICOLOG_LEVEL=info npm run -s run-dev\",\n\t\t\"debug\": \"cross-env PICOLOG_LEVEL=log npm run -s run-dev\",\n\t\t\"test\": \"mocha --require babel-register \\\"src/bridalapp-ui.spec.jsx\\\"\",\n\t\t\"--test-dev\": \"webpack-dev-server --inline --hot --config webpack/test.config.js --port 8081\",\n\t\t\"test-dev\": \"webpack-dev-server --output-path test --output-filename bridalapp-ui.spec.js \\\"mocha!./bridalapp-ui.spec.jsx\\\" --content-base test --port 8888 --config webpack/test.config.js\"\n\t},\n\t\"engines\": {\n\t\t\"node\": \">= 0.6.0\",\n\t\t\"npm\": \">= 1.0.0\"\n\t},\n\t\"dependencies\": {\n\t\t\"babel-polyfill\": \"^6.7.4\",\n\t\t\"babel-preset-es2015\": \"^6.5.0\",\n\t\t\"babel-preset-react\": \"^6.5.0\",\n\t\t\"babel-preset-stage-0\": \"^6.5.0\",\n\t\t\"babel-runtime\": \"^6.3.19\",\n\t\t\"babylon\": \"^6.5.2\",\n\t\t\"chalk\": \"^1.1.3\",\n\t\t\"classnames\": \"^2.2.3\",\n\t\t\"compression\": \"^1.6.1\",\n\t\t\"cookie-parser\": \"^1.4.1\",\n\t\t\"express\": \"^4.13.4\",\n\t\t\"http-proxy\": \"^1.12.0\",\n\t\t\"node-fetch\": \"^1.5.1\",\n\t\t\"picolog\": \"^1.0.4\",\n\t\t\"react\": \"^15.0.1\",\n\t\t\"react-dom\": \"^15.0.1\",\n\t\t\"react-mdl\": \"^1.5.3\",\n\t\t\"react-redux\": \"^4.4.5\",\n\t\t\"react-router\": \"^2.3.0\",\n\t\t\"redux\": \"^3.4.0\",\n\t\t\"redux-apis\": \">=2.0.0-alpha.1\",\n\t\t\"redux-async-api\": \"^2.0.1\",\n\t\t\"redux-fetch-api\": \"^1.0.1\",\n\t\t\"redux-load-api\": \"^2.0.1\",\n\t\t\"redux-logger\": \"^2.5.2\",\n\t\t\"redux-thunk\": \"^2.0.1\",\n\t\t\"serialize-javascript\": \"^1.1.2\",\n\t\t\"ws.suid\": \"^0.10.1\"\n\t},\n\t\"devDependencies\": {\n\t\t\"babel-core\": \"^6.7.6\",\n\t\t\"babel-loader\": \"^6.2.4\",\n\t\t\"babel-plugin-react-transform\": \"^2.0.2\",\n\t\t\"babel-plugin-transform-class-properties\": \"^6.4.0\",\n\t\t\"babel-plugin-transform-decorators-legacy\": \"^1.3.4\",\n\t\t\"babel-plugin-transform-runtime\": \"^6.7.5\",\n\t\t\"babel-preset-es2015\": \"^6.5.0\",\n\t\t\"babel-preset-react\": \"^6.3.13\",\n\t\t\"babel-preset-stage-0\": \"^6.3.13\",\n\t\t\"babel-register\": \"^6.6.5\",\n\t\t\"chai\": \"^3.5.0\",\n\t\t\"cross-env\": \"^1.0.7\",\n\t\t\"eventsource-polyfill\": \"^0.9.6\",\n\t\t\"json-loader\": \"^0.5.4\",\n\t\t\"just-wait\": \"^1.0.5\",\n\t\t\"mocha\": \"^2.4.5\",\n\t\t\"mocha-loader\": \"^0.7.1\",\n\t\t\"parallelshell\": \"^2.0.0\",\n\t\t\"react-addons-test-utils\": \"^15.0.1\",\n\t\t\"react-mdl\": \"^1.0.4\",\n\t\t\"react-transform-hmr\": \"^1.0.4\",\n\t\t\"rimraf\": \"^2.5.2\",\n\t\t\"webpack\": \"^1.13.0\",\n\t\t\"webpack-dev-middleware\": \"^1.6.1\",\n\t\t\"webpack-dev-server\": \"^1.14.1\",\n\t\t\"webpack-hot-middleware\": \"^2.9.1\"\n\t},\n\t\"author\": {\n\t\t\"name\": \"Stijn de Witt\",\n\t\t\"email\": \"StijnDeWitt@hotmail.com\",\n\t\t\"url\": \"http://www.StijnDeWitt.com/\"\n\t},\n\t\"copyright\": \"2016 by Stijn de Witt, some rights reserved.\",\n\t\"license\": \"CC-BY-4.0\",\n\t\"licenseUrl\": \"https://creativecommons.org/licenses/by/4.0/\"\n};\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./package.json\n ** module id = 68\n ** module chunks = 0\n **/","module.exports = require(\"babel-polyfill\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"babel-polyfill\"\n ** module id = 69\n ** module chunks = 0\n **/","module.exports = require(\"babel-runtime/core-js/object/create\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"babel-runtime/core-js/object/create\"\n ** module id = 70\n ** module chunks = 0\n **/","module.exports = require(\"babel-runtime/core-js/object/values\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"babel-runtime/core-js/object/values\"\n ** module id = 71\n ** module chunks = 0\n **/","module.exports = require(\"babel-runtime/helpers/get\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"babel-runtime/helpers/get\"\n ** module id = 72\n ** module chunks = 0\n **/","module.exports = require(\"chalk\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"chalk\"\n ** module id = 73\n ** module chunks = 0\n **/","module.exports = require(\"compression\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"compression\"\n ** module id = 74\n ** module chunks = 0\n **/","module.exports = require(\"cookie-parser\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"cookie-parser\"\n ** module id = 75\n ** module chunks = 0\n **/","module.exports = require(\"express\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"express\"\n ** module id = 76\n ** module chunks = 0\n **/","module.exports = require(\"http\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"http\"\n ** module id = 77\n ** module chunks = 0\n **/","module.exports = require(\"http-proxy\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"http-proxy\"\n ** module id = 78\n ** module chunks = 0\n **/","module.exports = require(\"node-fetch\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"node-fetch\"\n ** module id = 79\n ** module chunks = 0\n **/","module.exports = require(\"path\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"path\"\n ** module id = 80\n ** module chunks = 0\n **/","module.exports = require(\"react-dom/server\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"react-dom/server\"\n ** module id = 81\n ** module chunks = 0\n **/","module.exports = require(\"redux\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"redux\"\n ** module id = 82\n ** module chunks = 0\n **/","module.exports = require(\"redux-logger\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"redux-logger\"\n ** module id = 83\n ** module chunks = 0\n **/","module.exports = require(\"redux-thunk\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"redux-thunk\"\n ** module id = 84\n ** module chunks = 0\n **/","module.exports = require(\"serialize-javascript\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"serialize-javascript\"\n ** module id = 85\n ** module chunks = 0\n **/"],"sourceRoot":""}